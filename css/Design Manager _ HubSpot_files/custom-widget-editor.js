(window.webpackJsonp=window.webpackJsonp||[]).push([["custom-widget-editor"],{1501:function(e,t,s){"use strict";s.r(t);var i=s(59),n=s(404),a=s(2584),o=s(45);const r={fetchCustomWidgetBuffer:n.o};function d(e){return Object(o.jsx)(a.a,Object.assign({},e))}t.default=Object(i.connect)(null,r)(d)},1502:function(e,t,s){"use strict";var i=s(41),n=s.n(i);const a=n.a.oneOfType([n.a.number,n.a.string]);t.a={customWidgetId:a}},1503:function(e,t,s){"use strict";s.r(t);s.d(t,"default",(function(){return j}));var i=s(40),n=s(41),a=s.n(n),o=s(279),r=s(2766),d=s(717),l=s(723),c=s(724),p=s(751),u=s(490),h=s(443),g=s(2662),b=s(607),m=s(45);class j extends i.Component{renderLanguageSelect(){const{masterLanguage:e,onMasterLanguageChange:t}=this.props;return Object(m.jsx)(g.a,{defaultValue:e,onChange:t})}render(){const{i18nKey:e,onChangeMasterLanguageCancel:t,onMasterLanguageChangeConfirm:s}=this.props;return Object(m.jsxs)(r.a,{children:[Object(m.jsxs)(l.a,{children:[Object(m.jsx)(d.a,{onClick:t}),Object(m.jsx)(b.a,{children:Object(m.jsx)(o.a,{message:e("masterLanguageModal.header")})})]}),Object(m.jsxs)(c.a,{children:[Object(m.jsx)(o.a,{message:e("masterLanguageModal.body")}),Object(m.jsxs)("div",{className:"p-top-2",children:[Object(m.jsx)(u.a,{children:Object(m.jsx)(o.a,{message:e("masterLanguageModal.select.label")})}),this.renderLanguageSelect()]})]}),Object(m.jsx)(p.a,{children:Object(m.jsx)(h.a,{use:"primary",onClick:s,children:Object(m.jsx)(o.a,{message:e("masterLanguageModal.confirmButton")})})})]})}}j.propTypes={i18nKey:a.a.func.isRequired,masterLanguage:a.a.string,onChangeMasterLanguageCancel:a.a.func.isRequired,onMasterLanguageChange:a.a.func.isRequired,onMasterLanguageChangeConfirm:a.a.func.isRequired}},1504:function(e,t,s){"use strict";s.r(t);s.d(t,"default",(function(){return j}));var i=s(40),n=s(41),a=s.n(n),o=s(279),r=s(282),d=s(443),l=s(2766),c=s(717),p=s(724),u=s(751),h=s(738),g=s(607),b=s(723),m=s(45);class j extends i.Component{render(){const{i18nKey:e,languageToDelete:t,onDeleteLanguage:s,onDeleteLanguageCancel:i,disabled:n}=this.props;return Object(m.jsxs)(l.a,{use:"danger",children:[Object(m.jsxs)(b.a,{children:[Object(m.jsx)(c.a,{onClick:i}),Object(m.jsx)(g.a,{children:Object(m.jsx)(r.a,{message:e("deleteLanguageModal.header"),options:{language:Object(m.jsx)(o.a,{message:Object(h.a)(t)})}})})]}),Object(m.jsx)(p.a,{children:Object(m.jsx)("span",{children:Object(m.jsx)(o.a,{message:e("deleteLanguageModal.body")})})}),Object(m.jsxs)(u.a,{children:[Object(m.jsx)(d.a,{use:"danger",onClick:s,disabled:n,children:Object(m.jsx)(o.a,{message:e("deleteLanguageModal.buttons.delete")})}),Object(m.jsx)(d.a,{use:"tertiary-light",onClick:i,disabled:n,children:Object(m.jsx)(o.a,{message:e("deleteLanguageModal.buttons.cancel")})})]})]})}}j.propTypes={languageToDelete:a.a.string,i18nKey:a.a.func.isRequired,onDeleteLanguage:a.a.func.isRequired,onDeleteLanguageCancel:a.a.func.isRequired,disabled:a.a.bool}},1505:function(e,t,s){"use strict";s.r(t);var i=s(59),n=s(404),a=s(2584),o=s(45);const r={fetchCustomWidgetBuffer:n.p};function d(e){return Object(o.jsx)(a.a,Object.assign({},e))}t.default=Object(i.connect)(null,r)(d)},2584:function(e,t,s){"use strict";var i=s(40),n=s(1148),a=s.n(n),o=s(59),r=s(2594),d=s(41),l=s.n(d),c=s(1502),p=s(73),u=s(279),h=s(99),g=s(604),b=s(2734),m=s(2735),j=s(2603),O=s(610),f=s(92),C=s(437),y=s(83),x=s(691),T=s(88),E=s(276),R=s(84),I=s(2749),v=s(603),W=s(404),F=s(2724),S=s(1006),L=s(374),q=s(2723),D=s(434),P=s(58),A=s(282),N=s(696),k=s(443),w=s(2712),G=s(496),M=s(221),_=s(243),U=s(198),B=s(78),H=s(2714),V=s(1495),z=s(1012),K=s(1011),J=s(2755),X=s(1010),$=s(345),Y=s(2728),Q=s(199),Z=s(1303),ee=s(711),te=s(45);const se=Object(ee.a)(()=>Promise.all([s.e("convert-modals~modals~upgrade-modals"),s.e("upgrade-modals")]).then(s.bind(null,1587))),ie=Object(ee.a)(()=>Promise.all([s.e("convert-modals~modals~upgrade-modals"),s.e("upgrade-modals")]).then(s.bind(null,1588)));function ne(e){class t extends i.Component{constructor(e){super(e);this.handleUpgradeModalOpen=(e,t=!1)=>{this.props.getSessionStorageItem(e)&&!t||this.setState({isUpgradeModalOpen:!0})};this.handleUpgradeModalClose=()=>{this.props.setSessionStorageItem(this.props.customWidgetId,!0);this.setState({isUpgradeModalOpen:!1})};this.handleUpgradeModalCallback=e=>{this.handleUpgradeModalClose();if(e){this.upgradeData=e;this.isUpgrading=!0;this.props.upgradeCustomWidget(this.props.customWidgetId,e)}};this.handleForceUpgradeModalOpen=()=>{this.setState({isForceUpgradeModalOpen:!0})};this.handleForceUpgradeModalClose=()=>{this.setState({isForceUpgradeModalOpen:!1})};this.handleForceUpgradeModalCallback=e=>{this.handleForceUpgradeModalClose();e&&this.props.forceUpgradeCustomWidget(this.props.customWidgetId,this.upgradeData||{})};this.state={isUpgradeModalOpen:!1,isForceUpgradeModalOpen:!1}}componentDidUpdate(){const{upgradeError:e}=this.props;if(this.isUpgrading&&e&&Object(Q.b)(e)){this.isUpgrading=!1;this.handleForceUpgradeModalOpen()}}renderUpgradeModal(){return this.state.isUpgradeModalOpen?Object(te.jsx)(ie,{contentTypes:this.props.contentTypes,hostTemplateTypes:this.props.hostTemplateTypes,customWidgetId:this.props.customWidgetId,customWidgetName:this.props.customWidgetName,callback:this.handleUpgradeModalCallback,dependentsByCategory:this.props.dependentsByCategory,dependentsCount:this.props.dependentsCount}):null}renderForceUpgradeModal(){return this.state.isForceUpgradeModalOpen?Object(te.jsx)(se,{customWidgetId:this.props.customWidgetId,callback:this.handleForceUpgradeModalCallback,upgradeError:this.props.upgradeError}):null}render(){return Object(te.jsx)(e,Object.assign({},this.props,{onUpgradeClick:(...e)=>this.handleUpgradeModalOpen(this.props.customWidgetId,!0,...e),UpgradeModal:this.renderUpgradeModal(),ForceUpgradeModal:this.renderForceUpgradeModal()}))}}t.propTypes={customWidgetId:c.a.customWidgetId.isRequired,customWidgetName:l.a.string.isRequired,upgradeError:l.a.object,upgradeCustomWidget:l.a.func.isRequired,forceUpgradeCustomWidget:l.a.func.isRequired,dependentsByCategory:O.dependentsByCategory.isRequired,contentTypes:l.a.array.isRequired,hostTemplateTypes:l.a.array.isRequired,dependentsCount:l.a.number,setSessionStorageItem:l.a.func.isRequired,getSessionStorageItem:l.a.func.isRequired};function s(){const e=L.makeGetRequestStatus(),t=L.makeGetCustomWidgetBuffer(),s=Y.makeGetParentConnectionsByCategory(),i=Y.makeGetParentConnectionsCount();return(n,a)=>{const{upgradeError:o}=e(n,a),{name:r="",hostTemplateTypes:d=[],contentTypes:l=[]}=t(n,a)||{};return{hostTemplateTypes:d,contentTypes:l,customWidgetName:r,upgradeError:o,dependentsCount:i(n,{assetId:a.customWidgetId}),dependentsByCategory:s(n,{assetId:a.customWidgetId})}}}const n={upgradeCustomWidget:W.J,forceUpgradeCustomWidget:W.r};return Object(P.compose)(Object(o.connect)(s,n),Object(Z.a)(Object($.a)(ne)))(t)}var ae=s(1496);const oe=e=>"DesignEditorsUI.customWidgetEditor.codePanesAlert."+e;function re(){const e=L.makeGetCustomWidgetBuffer(),t=L.makeGetUpgradeNotPublished(),s=L.makeGetIsEmailType(),i=L.makeGetIsReadOnly();return(n,a)=>{const{name:o="",default:r,moduleId:d,containsOverridableHublTags:l=!1,folderId:c}=e(n,a)||{},p=_.e(n),u=M.z(n),h=!(s(n,a)&&!u),g=p.blog_content&&p.blog_content.moduleId,b=Object(H.K)(n),m=Object(_.n)();return{customWidgetName:o,isUpgradeable:L.getisUpgradeable(n,a),isDefault:r,isBlogContent:d===g,hasAccess:h,containsOverridableHublTags:l,upgradeNotPublished:t(n,a),isReadOnly:i(n,a),userHasReadAccessOnly:Object(M.w)(n),isLocked:b(c),customWidgetParentThemeFolderId:m(n,a)}}}class de extends i.PureComponent{renderUpgradeAlert(){const e=Object(te.jsx)(u.a,{message:oe("titleText.v1Editable")}),t=Object(te.jsx)(w.a,{target:"_blank",href:"http://designers.hubspot.com/docs/modules/reference",children:Object(te.jsx)(u.a,{message:oe("moduleDocumentationLink")})}),s=Object(te.jsx)(k.a,{onClick:this.props.onUpgradeClick,size:"extra-small",use:"tertiary",children:Object(te.jsx)(u.a,{message:oe("upgradeButtonText")})});return Object(te.jsx)(V.a,{children:Object(te.jsx)(N.a,{titleText:e,type:"info",children:Object(te.jsxs)(G.a,{align:"center",itemRight:s,children:[Object(te.jsx)(A.a,{message:oe("message.v1Editable"),options:{moduleDocumentationLink:t}}),this.props.UpgradeModal,this.props.ForceUpgradeModal]})})})}renderUpgradeNotPublishedAlert(){const e=Object(te.jsx)(u.a,{message:oe("titleText.upgradeNotPublished")});return Object(te.jsx)(V.a,{children:Object(te.jsx)(N.a,{titleText:e,type:"info",children:Object(te.jsx)(u.a,{message:oe("message.upgradeNotPublished")})})})}renderLockedAlert(){return Object(te.jsx)(V.a,{children:Object(te.jsx)(z.a,{assetType:B.CUSTOM_WIDGET})})}renderReadOnlyAlert(){let e=Object(te.jsx)(u.a,{message:oe("message.generic")}),t={};this.props.isDefault&&(e=Object(te.jsx)(u.a,{message:oe("message.default")}));this.props.isBlogContent&&(e=Object(te.jsx)(u.a,{message:oe("message.blogContent")}));if(this.props.containsOverridableHublTags&&!this.props.isDefault){const s=Object(te.jsx)(w.a,{target:"_blank",href:"https://knowledge.hubspot.com/articles/kcs_article/cos-general/how-to-identify-and-upgrade-nested-modules-from-v1-to-v2-in-the-new-design-manager",children:Object(te.jsx)(u.a,{message:oe("nestedModulesLink")})});e=Object(te.jsx)(A.a,{message:oe("message.containsOverridableHublTags"),options:{nestedModulesLink:s}});t={type:"warning"}}const s=Object(te.jsx)(u.a,{message:oe("titleText.readOnly")}),i=Object(te.jsx)(u.a,{message:oe("buttonText")}),n=Object(te.jsx)(u.a,{message:oe("cloneModal.header")}),a=Object(te.jsx)(u.a,{message:oe("cloneModal.message")});return Object(te.jsx)(V.a,{children:Object(te.jsx)(J.a,Object.assign({titleText:s,message:e,buttonText:i,showCloneButton:!this.props.isBlogContent,modalHeader:n,modalMessage:a,fileId:this.props.customWidgetId,fileName:this.props.customWidgetName,fileType:U.CUSTOM_WIDGET},t))})}renderReadOnlyThemeAlert(){return Object(te.jsx)(V.a,{children:Object(te.jsx)(ae.a,{assetId:this.props.customWidgetId})})}render(){const{revisionId:e,upgradeNotPublished:t,userHasReadAccessOnly:s,isUpgradeable:i,isReadOnly:n,isLocked:a,customWidgetParentThemeFolderId:o,hasAccess:r}=this.props;return e?null:s?Object(te.jsx)(V.a,{children:Object(te.jsx)(X.a,{isReadOnly:n})}):a?this.renderLockedAlert():t?this.renderUpgradeNotPublishedAlert():r?i?this.renderUpgradeAlert():n&&o&&!a?this.renderReadOnlyThemeAlert():n?this.renderReadOnlyAlert():null:Object(te.jsx)(V.a,{children:Object(te.jsx)(K.a,{isModule:!0})})}}de.propTypes={customWidgetId:c.a.customWidgetId.isRequired,revisionId:l.a.number,customWidgetName:l.a.string.isRequired,isUpgradeable:l.a.bool.isRequired,isDefault:l.a.bool.isRequired,isBlogContent:l.a.bool,hasAccess:l.a.bool,containsOverridableHublTags:l.a.bool.isRequired,upgradeNotPublished:l.a.bool.isRequired,isReadOnly:l.a.bool.isRequired,userHasReadAccessOnly:l.a.bool.isRequired,isLocked:l.a.bool.isRequired,customWidgetParentThemeFolderId:l.a.number,onUpgradeClick:l.a.func.isRequired,UpgradeModal:l.a.node,ForceUpgradeModal:l.a.node};var le=Object(P.compose)(Object(o.connect)(re,{}),ne)(de),ce=s(98),pe=s(55),ue=s(4),he=s(288),ge=s.n(he),be=s(203),me=s(471),je=s(431),Oe=s(2583),fe=s(427),Ce=s(430),ye=s(531),xe=s(1494),Te=s(375),Ee=s(1493),Re=s(204),Ie=s(370);const ve={"Cmd-Y":pe.a,"Cmd-S":pe.a,"Ctrl-Y":pe.a,"Ctrl-S":pe.a},We=(e,t)=>{const s=Object(Te.a)(t.location),{theme:i}=Object(je.c)(e);return{highlightedLines:s,codemirrorTheme:i}},Fe={pushRoute:Ie.a};class Se extends i.PureComponent{constructor(...e){super(...e);this.refCodemirror=e=>{this.codemirror=e&&e.codemirror};this.onOpenChange=e=>{this.props.onOpenChange(e.target.value)};this.onCodeChange=({value:e})=>{this.props.onCodeChange(e)};this.handleGutterClick=({lineNumber:e,gutterId:t,event:s})=>{const i=this.getPaneId();if("CodeMirror-linenumbers"!==t)return;const{location:n,highlightedLines:a,pushRoute:o}=this.props;let r=Object(xe.a)(e,a,s);""!==r&&i&&(r=`${r}-${i}`);o(Object.assign({},n,{hash:r}))}}componentDidUpdate(e){this.props.refresh&&!e.refresh&&this.props.open&&this.codemirror.refresh()}get codemirrorThemeClassName(){const{codemirrorTheme:e}=this.props;return Object(ye.b)(e)}getAnnotations(){const{errors:e}=this.props;return e.map(({line:e,message:t,type:s,evidence:i})=>new Ce.a({message:t,lineNumber:e?e-1:0,type:s===be.WARNING?fe.a.WARNING:fe.a.ERROR,evidence:i}))}getPaneId(){const{paneProps:e}=this.props;if(e)return e.paneId}get range(){const{editorSide:e,to:t,from:s,paneId:i}=this.props.highlightedLines,n=this.getPaneId();return"L"!==e||i&&n!==i?[]:Object(xe.b)(this.__range,{from:s,to:t})}render(){const{open:e,mode:t,isReadOnly:s,asAccordion:i,value:n,sessionId:a,autofocus:o,customWidgetContext:r}=this.props,d="code-pane-editor m-all-0 p-all-0",l=Object(te.jsx)(Oe.a,{annotations:this.getAnnotations(),className:"code-pane-editor",sessionId:a,readOnly:s,mode:t,onChange:this.onCodeChange,value:n,enableHublValidation:this.props.enableHublValidation,onHublValidation:this.props.onHublValidation,onHublValidationFail:this.props.onHublValidationFail,onGutterClick:this.handleGutterClick,highlightLines:this.range,extraKeys:ve,height:"100%",width:"100%",autofocus:o,refCodemirror:this.refCodemirror,codemirrorType:t,hublValidationOptions:r});if(i){const s=ge()("code-pane-accordion",this.codemirrorThemeClassName),i=Object(te.jsx)("span",{className:"code-pane-accordion-title",children:this.props.label});return Object(te.jsx)(me.a,{animate:!1,className:s,contentClassName:d,onOpenChange:this.onOpenChange,open:e,title:i,"data-test-id":"code-pane-"+t,children:l})}return l}}Se.propTypes={asAccordion:l.a.bool,isReadOnly:l.a.bool.isRequired,mode:l.a.string.isRequired,onCodeChange:l.a.func.isRequired,onOpenChange:l.a.func.isRequired,open:l.a.bool,errors:l.a.arrayOf(l.a.instanceOf(Re.a)),value:l.a.string,enableHublValidation:l.a.bool,onHublValidation:l.a.func,onHublValidationFail:l.a.func,sessionId:l.a.oneOfType([l.a.string,l.a.number]),label:l.a.string,autofocus:l.a.bool,refresh:l.a.bool,codemirrorTheme:l.a.string.isRequired,customWidgetContext:l.a.object,paneProps:l.a.object,location:l.a.object.isRequired,highlightedLines:l.a.object.isRequired,pushRoute:l.a.func.isRequired};Se.defaultProps={asAccordion:!0,errors:[],open:!0,label:"",autofocus:!1,enableHublValidation:!1,onHublValidation:pe.a,onHublValidationFail:pe.a};var Le=Object(P.compose)(Object(Ee.a)(!0),Object(o.connect)(We,Fe))(Se),qe=s(602),De=s(85),Pe=s(429);const Ae=De.a,Ne=()=>{const e=Pe.o(),t=L.makeGetFieldsContext(),s=L.makeGetIsReadOnly();return(i,n)=>({source:L.getCustomWidgetBufferSource(i,n),isReadOnly:Object(M.w)(i)||s(i,n),sourceErrors:e(i,n),customWidgetContext:n.enableHublValidation?t(i,n):Ae,paneDirection:n.direction,paneSize:n.size,paneKey:n.key})};class ke extends i.Component{componentDidMount(){this.props.onCodePanesRender()}componentDidUpdate(e){this.props.customWidgetId!==e.customWidgetId&&this.props.onCodePanesRender()}get labels(){this.__labels||(this.__labels={[E.c]:`module.html (${ue.a.text("DesignEditorsUI.codeFileTypes.hubl-html")})`,[E.b]:"module.css",[E.d]:"module.js"});return this.__labels}render(){const{paneOptions:e,paneId:t,customWidgetId:s,revisionId:i,sessionId:n,mode:a,source:o,enableHublValidation:r,autofocus:d,refresh:l,customWidgetContext:c,isReadOnly:p,onCodeChange:u,onOpenChange:h,sourceErrors:g,onHublValidation:b,onHublValidationFail:m,paneDirection:j,paneSize:O,paneKey:f}=this.props,{size:C,open:x}=e[t]||{},E=!1===x?new y.a({value:T.e,units:R.PIXELS}):C;return Object(te.jsx)(v.a,{className:"code-pane",defaultSize:E,forceChildRerender:!0,paneId:t,direction:j,size:O,children:Object(te.jsx)(Le,{sessionId:n,label:this.labels[t],isReadOnly:p,mode:a,onCodeChange:u,onOpenChange:h,open:x,errors:g,value:o,enableHublValidation:r,onHublValidation:b,onHublValidationFail:m,autofocus:d,refresh:l,customWidgetContext:c},`${s}:${i}:${t}`)},f)}}ke.propTypes={paneId:l.a.oneOf([E.c,E.b,E.d]).isRequired,mode:l.a.string.isRequired,enableHublValidation:l.a.bool.isRequired,autofocus:l.a.bool.isRequired,sessionId:l.a.string.isRequired,paneOptions:l.a.object.isRequired,refresh:l.a.bool.isRequired,onCodeChange:l.a.func.isRequired,onOpenChange:l.a.func.isRequired,onHublValidation:l.a.func.isRequired,onHublValidationFail:l.a.func.isRequired,customWidgetId:c.a.customWidgetId.isRequired,revisionId:l.a.number,onCodePanesRender:l.a.func.isRequired,isReadOnly:l.a.bool.isRequired,sourceErrors:l.a.arrayOf(l.a.instanceOf(Re.a)).isRequired,source:l.a.string.isRequired,customWidgetContext:l.a.object.isRequired,paneDirection:l.a.oneOf([qe.a,qe.b]),paneSize:l.a.instanceOf(y.a),paneKey:l.a.string};ke.defaultProps={enableHublValidation:!1,autofocus:!1,paneOptions:{},onCodeChange:pe.a};var we=Object(o.connect)(Ne,null,null,{forwardRef:!0})(ke);const Ge=()=>{const e=Pe.o(),t=L.makeGetFieldsContext(),s=L.makeGetIsReadOnly();return(i,n)=>({source:L.getCustomWidgetBufferSource(i,n),isReadOnly:Object(M.w)(i)||s(i,n),sourceErrors:e(i,n),customWidgetContext:t(i,n)})};class Me extends i.Component{componentDidMount(){this.props.onCodePanesRender()}render(){const{sessionId:e,customWidgetId:t,revisionId:s,isReadOnly:i,sourceErrors:n,customWidgetContext:a,onCodeChange:o,onHublValidation:r,onHublValidationFail:d,source:l}=this.props;return Object(te.jsx)(Le,{sessionId:e,asAccordion:!1,isReadOnly:i,mode:"hubl-html",onCodeChange:o,onOpenChange:pe.a,open:!0,errors:n,enableHublValidation:!0,onHublValidation:r,onHublValidationFail:d,customWidgetContext:a,value:l},`${t}:${s}`)}}Me.propTypes={sessionId:l.a.string.isRequired,onCodeChange:l.a.func.isRequired,onHublValidation:l.a.func.isRequired,onHublValidationFail:l.a.func.isRequired,customWidgetId:c.a.customWidgetId.isRequired,revisionId:l.a.number,onCodePanesRender:l.a.func.isRequired,isReadOnly:l.a.bool.isRequired,sourceErrors:l.a.arrayOf(l.a.instanceOf(Re.a)).isRequired,source:l.a.string.isRequired,customWidgetContext:l.a.object.isRequired};var _e=Object(o.connect)(Ge)(Me);class Ue extends i.PureComponent{constructor(...e){super(...e);this.state={refresh:!1};this.triggerRefresh=()=>{this.setState({refresh:!0});setTimeout(()=>{this.setState({refresh:!1})},0)};this.onCodePaneResize=e=>{const{customWidgetId:t,updatePaneOptions:s,paneOptions:i}=this.props,n={};Object.keys(e).forEach(t=>{const{open:s,size:a}=i[t]||{},o=e[t],r={size:o};!1!==s||a===o||o.isMinSize?s&&o.isMinSize&&(r.open=!1):r.open=!0;n[t]=r});s(t,n);this.triggerRefresh()};this.getOnCodePaneOpenChange=e=>{this.__onCodePaneOpenChange=this.__onCodePaneOpenChange||{};this.__onCodePaneOpenChange[e]||(this.__onCodePaneOpenChange[e]=t=>{const{customWidgetId:s,updatePaneOptions:i}=this.props;i(s,{[e]:{open:t}});this.triggerRefresh()});return this.__onCodePaneOpenChange[e]};this.getOnCodeChange=e=>{this.__onCodeChange=this.__onCodeChange||{};this.__onCodeChange[e]||(this.__onCodeChange[e]=t=>{this.props.updateSource({[e]:t})});return this.__onCodeChange[e]};this.getOnHublValidationForSessionId=e=>{this.__onHublValidation=this.__onHublValidation||{};this.__onHublValidation[e]||(this.__onHublValidation[e]=this.props.onHublValidation.bind(null,e));return this.__onHublValidation[e]};this.getOnHublValidationFailForSessionId=e=>{this.__onHublValidationFail=this.__onHublValidationFail||{};this.__onHublValidationFail[e]||(this.__onHublValidationFail[e]=this.props.onHublValidationFail.bind(null,e));return this.__onHublValidationFail[e]}}renderCodePane({paneId:e,mode:t,sourceKey:s,enableHublValidation:i=!1,autofocus:n=!1,sessionId:a}){const{customWidgetId:o,revisionId:r,paneOptions:d,onCodePanesRender:l}=this.props,{refresh:c}=this.state;return Object(te.jsx)(we,{paneId:e,mode:t,sourceKey:s,enableHublValidation:i,autofocus:n,sessionId:a,paneOptions:d,revisionId:r,customWidgetId:o,refresh:c,onCodeChange:this.getOnCodeChange(s),onOpenChange:this.getOnCodePaneOpenChange(e),onCodePanesRender:l,onHublValidation:this.getOnHublValidationForSessionId(a),onHublValidationFail:this.getOnHublValidationFailForSessionId(a)})}renderHtmlEditor(){const{customWidgetId:e,revisionId:t,onCodePanesRender:s}=this.props,i=Object(ce.d)(e,E.c);return Object(te.jsx)(_e,{sourceKey:"source",customWidgetId:e,revisionId:t,sessionId:i,onCodeChange:this.getOnCodeChange("source"),onCodePanesRender:s,onHublValidation:this.getOnHublValidationForSessionId(i),onHublValidationFail:this.getOnHublValidationFailForSessionId(i)})}render(){const{customWidgetId:e,revisionId:t,isEmailOrAnyType:s}=this.props,i=s?Object(te.jsx)("div",{className:"code-panes-accordion-items",children:this.renderHtmlEditor()}):Object(te.jsxs)(I.a,{className:"code-panes-accordion-items",onPaneResize:this.onCodePaneResize,paneMinSize:T.e,children:[this.renderCodePane({paneId:E.c,mode:"hubl-html",sourceKey:"source",enableHublValidation:!0,autofocus:!0,sessionId:Object(ce.d)(e,E.c)}),this.renderCodePane({paneId:E.b,mode:"hubl-css",sourceKey:"css",sessionId:Object(ce.d)(e,E.b)}),this.renderCodePane({paneId:E.d,mode:"hubl-javascript",sourceKey:"js",sessionId:Object(ce.d)(e,E.d)})]});return Object(te.jsxs)(D.a,{className:"code-panes",direction:"column",children:[Object(te.jsx)(le,{customWidgetId:e,revisionId:t}),Object(te.jsx)(m.a,{className:"code-panes-container",grow:1,children:i})]})}}Ue.propTypes={customWidgetId:c.a.customWidgetId.isRequired,revisionId:l.a.number,paneOptions:l.a.object,updatePaneOptions:l.a.func.isRequired,updateSource:l.a.func.isRequired,onHublValidation:l.a.func.isRequired,onHublValidationFail:l.a.func.isRequired,isEmailOrAnyType:l.a.bool.isRequired,onCodePanesRender:l.a.func.isRequired};Ue.defaultProps={paneOptions:{}};function Be(){const e=L.makeGetIsEmailOrAnyType(),t=L.makeGetUpgradeNotPublished();return(s,i)=>{const n=Object.assign({},i,{assetId:i.customWidgetId});return{customWidgetId:n.customWidgetId,paneOptions:q.j(s,n),upgradeNotPublished:t(s,n),isEmailOrAnyType:e(s,n)}}}const He={updatePaneOptions:F.m,updateCustomWidget:W.E,validateTemplate:S.b};class Ve extends i.PureComponent{constructor(...e){super(...e);this.updateSource=e=>{const{updateCustomWidget:t,customWidgetId:s}=this.props;t(s,e)};this.onHublValidation=(e,t,s)=>{this.props.validateTemplate(this.props.customWidgetId,e,s,null)};this.onHublValidationFail=(e,t)=>{this.props.validateTemplate(this.props.customWidgetId,e,null,t)}}render(){const{customWidgetId:e,revisionId:t,paneOptions:s,updatePaneOptions:i,isEmailOrAnyType:n,onCodePanesRender:a}=this.props;return Object(te.jsx)(Ue,{customWidgetId:e,revisionId:t,paneOptions:s,updateSource:this.updateSource,updatePaneOptions:i,onHublValidation:this.onHublValidation,onHublValidationFail:this.onHublValidationFail,isEmailOrAnyType:n,onCodePanesRender:a})}}Ve.propTypes={customWidgetId:c.a.customWidgetId.isRequired,revisionId:l.a.number,paneOptions:l.a.object.isRequired,updateCustomWidget:l.a.func.isRequired,updatePaneOptions:l.a.func.isRequired,validateTemplate:l.a.func.isRequired,isEmailOrAnyType:l.a.bool.isRequired,onCodePanesRender:l.a.func.isRequired};var ze=Object(o.connect)(Be,He)(Ve),Ke=s(2763),Je=s(281),Xe=s(2733),$e=s(1014),Ye=s(1013),Qe=s(1015);const Ze={savePreviewerWindow:s(1017).a};class et extends i.PureComponent{constructor(...e){super(...e);this.openPreviewer=()=>{const{url:e,savePreviewerWindow:t}=this.props;t(window.open(e))}}render(){return Object(te.jsx)(k.a,{onClick:this.openPreviewer,rel:"noopener noreferrer",use:"secondary",size:"extra-small",children:Object(te.jsx)(u.a,{message:"DesignEditorsUI.previews.livePreviewLink.label"})})}}et.propTypes={url:l.a.string.isRequired,savePreviewerWindow:l.a.func};var tt=Object(o.connect)(null,Ze)(et),st=s(1018),it=s(202);const nt=e=>"DesignEditorsUI.shared.toolbars."+e,at=e=>"DesignEditorsUI.customWidgetEditor.toolbar."+e,ot=e=>"DesignEditorsUI.customWidgetEditor.errors.savedWithErrors."+e;class rt extends i.PureComponent{constructor(...e){super(...e);this.onIsAvailableForNewContentToggleChange=e=>{const{checked:t}=e.target;this.props.onUpdateCustomWidget({isAvailableForNewContent:t})};this.onIsEnabledForEmailV3RenderingToggleChange=e=>{this.props.onUpdateCustomWidget({isEnabledForEmailV3Rendering:e})};this.isPublishDisabled=()=>{const{isReadOnly:e,requestStatus:t,editorErrors:s,hasBufferedChanges:i,isBufferLoaded:n}=this.props;return!(!(!n||e||t.isPublishing||t.isSaving||t.isValidating||t.saveError||s&&s.length)&&i)};this.renderDisabledPublishTooltip=(e,t)=>{const{requestStatus:s,openDrawer:i,editorErrors:n,hasBufferedChanges:a}=this.props;return Object(te.jsx)(Qe.a,{placement:t,requestStatus:s,openDrawer:i,errors:n,hasBufferedChanges:a,children:e})};this.renderLeftContent=()=>{const{requestStatus:e,onRedoCustomWidgetEdit:t,onUndoCustomWidgetEdit:s,futureEditHistoryCount:i,pastEditHistoryCount:n,editorErrors:a,openDrawer:o}=this.props,r=Object(te.jsx)(k.a,{onClick:o,use:"link",children:Object(te.jsx)(u.a,{message:ot("errorsLinkLabel"),options:{count:a.length}})}),d=Object(te.jsx)(A.a,{message:ot("message"),options:{errorsLink:r}});return Object(te.jsxs)(D.a,{align:"center",children:[Object(te.jsx)("div",{className:"m-right-2",children:Object(te.jsx)(Ye.a,{futureEditCount:i,pastEditCount:n,redo:t,undo:s})}),Object(te.jsx)($e.a,{requestStatus:e,successWithErrorsMessage:d})]})};this.renderIsAvailableForNewContentToggle=()=>1===this.props.schemaVersion?null:Object(te.jsx)(st.a,{disabled:!this.props.isBufferLoaded||this.props.isReadOnly,checked:!!this.props.isAvailableForNewContent,onChange:this.onIsAvailableForNewContentToggleChange,toggleLabel:Object(te.jsx)(u.a,{message:at("isAvailableForNewContentToggle.label")}),tooltipTitle:Object(te.jsx)(u.a,{message:at("isAvailableForNewContentToggle.tooltipTitle")})});this.renderPublishButton=()=>{const{onPublish:e,isReadOnly:t}=this.props,s=this.isPublishDisabled(),i=Object(te.jsx)(k.a,{disabled:s,onClick:e,size:"extra-small",use:"primary","data-test-id":"publish-changes-button",children:Object(te.jsx)(u.a,{message:nt("buttons.publish")})});return!s||t?i:this.renderDisabledPublishTooltip(i)};this.renderStageChangesButton=()=>{const e=this.isPublishDisabled();return Object(te.jsx)(k.a,{"data-test-id":"stage-changes-button",disabled:e,onClick:this.props.onStageChanges,size:"extra-small",use:"primary",children:Object(te.jsx)(Je.a,{message:nt("buttons.stageChanges")})})};this.renderRightContent=()=>{const{previewUrl:e}=this.props;return Object(te.jsxs)(D.a,{align:"center",justify:"end",children:[Object(te.jsx)("div",{className:"m-right-3",children:this.renderIsAvailableForNewContentToggle()}),Object(te.jsx)(tt,{url:e}),this.renderPublishButton()]})}}render(){return Object(te.jsx)(Xe.a,{disabled:!this.props.isBufferLoaded,leftContent:this.renderLeftContent(),rightContent:this.renderRightContent(),previewUrl:this.props.previewUrl})}}rt.propTypes={isBufferLoaded:l.a.bool.isRequired,isAvailableForNewContent:l.a.bool.isRequired,schemaVersion:l.a.number,futureEditHistoryCount:l.a.number.isRequired,isReadOnly:l.a.bool.isRequired,onPublish:l.a.func.isRequired,onStageChanges:l.a.func.isRequired,onRedoCustomWidgetEdit:l.a.func.isRequired,onUndoCustomWidgetEdit:l.a.func.isRequired,pastEditHistoryCount:l.a.number.isRequired,previewUrl:l.a.string,requestStatus:l.a.object.isRequired,openDrawer:l.a.func.isRequired,editorErrors:l.a.arrayOf(l.a.instanceOf(it.a)),hasBufferedChanges:l.a.bool,onUpdateCustomWidget:l.a.func.isRequired};var dt=rt,lt=s(367);function ct(){const e=L.makeGetPastEditHistoryCount(),t=L.makeGetFutureEditHistoryCount(),s=L.makeGetRequestStatus(),i=L.makeGetCustomWidgetBuffer(),n=Pe.g(),a=L.makeGetIsReadOnly();return(o,r)=>{const{portal_id:d}=o.auth.portal,{customWidgetId:l,revisionId:c}=r,p=i(o,r);return{customWidgetId:l,previewUrl:p?Object(Ke.b)(p,d,c):"",hasBufferedChanges:p&&p.isBuffered,isBufferLoaded:!!p,schemaVersion:p&&p.schemaVersion,isAvailableForNewContent:!(!p||!p.isAvailableForNewContent),isEnabledForEmailV3Rendering:!(!p||!p.isEnabledForEmailV3Rendering),futureEditHistoryCount:t(o,r),isReadOnly:Object(M.w)(o)||a(o,r),pastEditHistoryCount:e(o,r),requestStatus:s(o,r),editorErrors:n(o,{assetId:r.customWidgetId})}}}const pt={publishCustomWidget:W.v,redoCustomWidgetEdit:W.w,undoCustomWidgetEdit:W.D,updateCustomWidget:W.E,openDrawer:lt.e};class ut extends i.Component{constructor(e){super(e);this.onPublish=this.onPublish.bind(this);this.onRedoCustomWidgetEdit=this.onRedoCustomWidgetEdit.bind(this);this.onUndoCustomWidgetEdit=this.onUndoCustomWidgetEdit.bind(this);this.onUpdateCustomWidget=this.onUpdateCustomWidget.bind(this)}onPublish(){const{customWidgetId:e,publishCustomWidget:t}=this.props;t(e)}onRedoCustomWidgetEdit(){const{customWidgetId:e,redoCustomWidgetEdit:t}=this.props;t(e)}onUndoCustomWidgetEdit(){const{customWidgetId:e,undoCustomWidgetEdit:t}=this.props;t(e)}onUpdateCustomWidget(e){this.props.updateCustomWidget(this.props.customWidgetId,e)}render(){const{customWidgetId:e,isReadOnly:t,previewUrl:s,requestStatus:i,futureEditHistoryCount:n,pastEditHistoryCount:a,openDrawer:o,editorErrors:r,hasBufferedChanges:d}=this.props;return Object(te.jsx)(dt,{isBufferLoaded:this.props.isBufferLoaded,isAvailableForNewContent:this.props.isAvailableForNewContent,isEnabledForEmailV3Rendering:this.props.isEnabledForEmailV3Rendering,schemaVersion:this.props.schemaVersion,customWidgetId:e,futureEditHistoryCount:n,isReadOnly:t,onPublish:this.onPublish,onRedoCustomWidgetEdit:this.onRedoCustomWidgetEdit,onUndoCustomWidgetEdit:this.onUndoCustomWidgetEdit,pastEditHistoryCount:a,previewUrl:s,requestStatus:i,openDrawer:o,editorErrors:r,hasBufferedChanges:d,onUpdateCustomWidget:this.onUpdateCustomWidget})}}ut.propTypes={isBufferLoaded:l.a.bool.isRequired,isAvailableForNewContent:l.a.bool.isRequired,isEnabledForEmailV3Rendering:l.a.bool.isRequired,schemaVersion:l.a.number,customWidgetId:c.a.customWidgetId.isRequired,futureEditHistoryCount:l.a.number.isRequired,isReadOnly:l.a.bool.isRequired,pastEditHistoryCount:l.a.number.isRequired,previewUrl:l.a.string,publishCustomWidget:l.a.func.isRequired,redoCustomWidgetEdit:l.a.func.isRequired,requestStatus:l.a.object.isRequired,undoCustomWidgetEdit:l.a.func.isRequired,openDrawer:l.a.func.isRequired,editorErrors:l.a.arrayOf(l.a.instanceOf(it.a)),hasBufferedChanges:l.a.bool,updateCustomWidget:l.a.func.isRequired};var ht=Object(o.connect)(ct,pt)(ut),gt=s(2686),bt=s(63),mt=s(30),jt=s.n(mt);function Ot(){return jt.a.get("sfdc/v1/connection-status")}var ft=s(376);function Ct(){const{request:e,receive:t,error:s}=Ct;return(i,n)=>{if(null===Object(ft.b)(n())){i(e());Ot().then(e=>{i(t(e))}).catch(e=>{i(s(e))})}}}Ct.request=()=>({type:bt.SFDC_GET_INTEGRATION_STATUS});Ct.receive=e=>({type:bt.SFDC_GET_INTEGRATION_STATUS,status:e});Ct.error=e=>({type:bt.SFDC_GET_INTEGRATION_STATUS,error:e});var yt=s(228),xt=s(283),Tt=s(2719),Et=s(2),Rt=s(2682),It=s(298),vt=s(2636);const Wt=["children","className","disabled","href","onClick","open"];class Ft extends i.Component{constructor(...e){super(...e);this.handleLinkClick=e=>{const{disabled:t,onClick:s,onOpenChange:i,open:n}=this.props;if(!t){s&&s(e);!e.defaultPrevented&&i&&i(Object(It.a)(!n))}}}render(){const e=this.props,{children:t,className:s,disabled:i,href:n,open:a}=e,o=Object(Et.a)(e,Wt);return Object(te.jsx)(vt.a,Object.assign({},o,{open:!i&&a,use:"longform",children:Object(te.jsx)(w.a,{className:s,href:n,onClick:this.handleLinkClick,disabled:i,children:t})}))}}Ft.propTypes={children:w.a.propTypes.children,content:vt.a.propTypes.content,disabled:l.a.bool,href:w.a.propTypes.href,onOpenChange:vt.a.propTypes.onOpenChange,open:vt.a.propTypes.open,placement:vt.a.propTypes.placement,showCloseButton:vt.a.propTypes.showCloseButton};Ft.defaultProps={disabled:!1,open:!1,placement:"top",showCloseButton:!1};Ft.displayName="UIHelpLink";var St=Object(Rt.a)(Ft,["open"]),Lt=s(357),qt=s(2739),Dt=s(456),Pt=s(485),At=s(1020),Nt=s(1027),kt=s(1021),wt=s(1029),Gt=s(1026),Mt=s(508),_t=s(476),Ut=s(179);const Bt=["className","inputComponent","wrap"];class Ht extends i.Component{render(){const e=this.props,{className:t,inputComponent:s,wrap:i}=e,n=Object(Et.a)(e,Bt),a=ge()("sidebar-input",t);return i?Object(te.jsx)("span",{className:a,children:Object(te.jsx)(s,Object.assign({},n))}):Object(te.jsx)(s,Object.assign({},n,{className:a}))}}Ht.propTypes={className:l.a.string,inputComponent:l.a.elementType,wrap:l.a.bool};Ht.defaultProps={className:null,inputComponent:Mt.a,wrap:!1};var Vt=s(1092),zt=s(1093),Kt=s(79),Jt=s(1039);const Xt=e=>"DesignEditorsUI.customWidgetEditor.sidebar.fieldEdit."+e;function $t(e,t){const{isNew:s}=Object(q.k)(e,t);return{isNew:s}}class Yt extends i.Component{constructor(e){super(e);this.onLabelChange=this.onLabelChange.bind(this)}onLabelChange(e){const{isNew:t,editField:s}=this.props,i={label:e};t&&e&&(i.name=Object(Kt.g)(e));s(i)}renderTypeLabel(){return Object(te.jsx)(Pt.a,{use:"help",children:this.props.field.getDefaultLabel()})}render(){const{field:e,isNew:t,isReadOnly:s}=this.props;return Object(te.jsx)(Jt.a,{allowBlank:!1,focus:t,onChange:this.onLabelChange,placeholder:ue.a.text(Xt("labelPlaceholder")),readOnly:s,typeLabel:this.renderTypeLabel(),value:e.label})}}Yt.propTypes={editField:l.a.func.isRequired,field:l.a.instanceOf(gt.a).isRequired,isReadOnly:l.a.bool,isNew:l.a.bool};Yt.defaultProps={isNew:!1,isReadOnly:!1};var Qt=Object(o.connect)($t,{})(Yt),Zt=s(2741),es=s(1030);const ts=["children","className","errors","warnings"];class ss extends i.Component{render(){const e=this.props,{children:t,className:s,errors:i,warnings:n}=e,a=Object(Et.a)(e,ts),o=i.length?Object(te.jsx)(Dt.a,{children:i}):null,r=n.length?Object(te.jsx)(Dt.a,{children:n}):null,d=ge()("sidebar-form-control",s);return Object(te.jsx)(es.a,Object.assign({className:d,error:!!o||!!r,validationMessage:o||r},a,{children:t}))}}ss.propTypes={children:l.a.node,className:l.a.string,errors:l.a.arrayOf(l.a.node),warnings:l.a.arrayOf(l.a.node)};ss.defaultProps={className:null,errors:[],warnings:[]};const is=["errors","warnings","isModuleError"],ns=e=>"DesignEditorsUI.customWidgetEditor.errors.field."+e,as=e=>"DesignEditorsUI.customWidgetEditor.errors.module."+e;class os extends i.Component{render(){const e=this.props,{errors:t,warnings:s,isModuleError:i}=e,n=Object(Et.a)(e,is),a=Object(p.uniq)(t,({type:e})=>e).map(({type:e,data:t})=>Object(te.jsx)(Je.a,{message:i?as(e):ns(e),options:t},e)),o=Object(p.uniq)(s,({type:e})=>e).map(({type:e,data:t})=>Object(te.jsx)(Je.a,{message:ns(e),options:t},e));return Object(te.jsx)(ss,Object.assign({errors:a,warnings:o},n))}}os.propTypes={characterCount:Zt.a.propTypes.characterCount,children:l.a.node,className:l.a.string,errors:l.a.arrayOf(l.a.object),warnings:l.a.arrayOf(l.a.object),isModuleError:l.a.bool};os.defaultProps={className:null,errors:[],warnings:[],isModuleError:!1};const rs=e=>"DesignEditorsUI.customWidgetEditor.sidebar.fieldEdit."+e;class ds extends i.PureComponent{constructor(e){super(e);this.editField=e=>{const{customWidgetId:t}=this.props,{field:s}=this.state,i=s.merge(e);this.setState({field:i});this.debouncedEditField(t,i)};this.debouncedEditField=Object(p.debounce)((function(e,t){this.props.editField(e,t)}),1e3);this.onDeleteClick=()=>{this.props.deleteField(this.props.customWidgetId,this.props.field.id)};this.onNameChange=e=>{const t=e.target.value;this.editField({name:t})};this.state={field:e.field}}componentDidUpdate(e){const{field:t}=this.props;Object(p.isEqual)(e.field,t)||this.setState({field:t})}get contentOptionsErrors(){const{fieldErrors:e}=this.props;return Object(p.pick)(e,[Ut.r,Ut.d,Ut.f,Ut.U,Ut.t,Ut.P,Ut.R])}get fieldName(){return this.props.fieldBreadcrumbs.map(e=>e.name).join(".")||this.state.field.name}renderNameInput(){const{fieldErrors:e,readOnly:t}=this.props,{field:s}=this.state;return Object(te.jsx)(_t.a,{children:Object(te.jsx)(os,{className:"field-name-input m-y-4",errors:e.name,label:Object(h.a)(rs("nameLabel")),children:Object(te.jsx)(Ht,{className:"is--code",inputComponent:Mt.a,onChange:this.onNameChange,value:s.name,disabled:t})})})}render(){const{customWidgetId:e,readOnly:t}=this.props,{field:s}=this.state;return s?Object(te.jsxs)(te.Fragment,{children:[Object(te.jsxs)(D.a,{align:"start",justify:"between",direction:"row",wrap:"nowrap","data-test-id":"style-tab-controls",children:[Object(te.jsx)(Qt,{customWidgetId:e,editField:this.editField,field:s,isReadOnly:t}),Object(te.jsx)(Vt.a,{children:Object(te.jsx)(zt.a,{title:Object(h.a)(rs("deleteGroup")),iconName:"delete",onClick:this.onDeleteClick,isReadOnly:t})})]}),this.renderNameInput()]}):null}}ds.propTypes={customWidgetId:c.a.customWidgetId.isRequired,deleteField:l.a.func.isRequired,editField:l.a.func.isRequired,field:l.a.instanceOf(gt.a),fieldBreadcrumbs:l.a.array,fieldErrors:l.a.object,readOnly:l.a.bool};ds.defaultProps={customWidgetIcon:null,field:null,fieldErrors:{},fieldBreadcrumbs:[]};var ls=ds,cs=s(161);function ps(){const e=L.makeGetCustomWidgetBuffer(),t=L.makeGetCustomWidgetBufferFields(),s=L.makeGetIsEmailOrAnyType(),i=L.makeGetIsReadOnly();return(n,a)=>{const o=e(n,a),{isActive:r}=q.d(n,a),d=q.k(n,a),l=q.f(n,a);return Object.assign({customWidgetId:a.customWidgetId,isReadOnly:Object(M.w)(n)||i(n,a)||l,fieldErrors:q.c(n,a),fieldBreadcrumbs:q.l(n,a),fields:t(n,a),isFieldGroupingActive:!!r,isFullScreenEditorOpen:q.g(n,a),customWidgetIcon:o?o.icon:null,isGlobal:!!o&&o.global,isV1:!!o&&1===o.schemaVersion,isStyleTab:d.field&&d.field.tab===cs.d,accordionStates:q.a(n,a),isEmailOrAnyType:s(n,a),customWidgetPath:o?o.path:"",hasGlobalContentEditorAccess:Object(M.h)(n,a)},d)}}const us={cloneField:W.e,deleteField:W.i,editField:W.k,setSelectedField:F.j,saveAccordionState:F.d,fetchSfdcIntegrationStatus:Ct,setFullScreenEditorOpen:F.f};class hs extends i.Component{constructor(...e){super(...e);this.saveAccordionState=(e,t=!1)=>{this.props.saveAccordionState(this.props.customWidgetId,e,t,this.props.field.id)}}componentDidMount(){this.props.fetchSfdcIntegrationStatus()}render(){const{customWidgetIcon:e,customWidgetId:t,customWidgetPath:s,editField:i,field:n,fieldErrors:a,deleteField:o,isStyleTab:r,isReadOnly:d}=this.props;return Object(te.jsx)(ls,{customWidgetIcon:e,customWidgetId:t,customWidgetPath:s,deleteField:o,editField:i,field:n,isStyleTab:r,fieldErrors:a,readOnly:d})}}hs.propTypes={customWidgetIcon:l.a.string,customWidgetId:c.a.customWidgetId.isRequired,customWidgetPath:l.a.string.isRequired,deleteField:l.a.func.isRequired,editField:l.a.func.isRequired,field:l.a.instanceOf(gt.a),fieldErrors:l.a.object.isRequired,isStyleTab:l.a.bool,isReadOnly:l.a.bool.isRequired,saveAccordionState:l.a.func.isRequired,fetchSfdcIntegrationStatus:l.a.func.isRequired};hs.defaultProps={customWidgetIcon:null,field:null,accordionStates:{}};var gs=Object(o.connect)(ps,us)(hs),bs=s(1090),ms=s(405),js=s(2778),Os=s(2655);function fs(){return jt.a.get("content/categories/v1/categories/meta")}class Cs extends i.Component{constructor(...e){super(...e);this.onChange=e=>{this.props.onChange(e.target.value)}}loadOptions(e,t){fs().then(e=>{const{results:s}=e;t(null,{options:s.map(e=>({text:e.displayName,value:e.name}))})}).catch(e=>{console.error(e)})}render(){const{isReadOnly:e,selectedCategories:t}=this.props;return Object(te.jsx)(Os.a,{anchorType:"button",disabled:e,loadOptions:this.loadOptions,multi:!0,onChange:this.onChange,value:t})}}Cs.propTypes={isReadOnly:l.a.bool,onChange:l.a.func.isRequired,selectedCategories:l.a.arrayOf(l.a.string)};Cs.defaultProps={selectedCategories:[]};const ys=e=>"DesignEditorsUI.customWidgetEditor.sidebar.main.filterTags."+e;class xs extends i.Component{constructor(...e){super(...e);this.handleCustomTagsChange=e=>{const t=e.map(e=>({name:e,source:"USER"}));this.props.onTagsChange([...this.nonCustomTags,...t],e.map(e=>ms.a[e]))}}get nonCustomTags(){const{customWidgetTags:e}=this.props;return e.filter(({source:e})=>"USER"!==e)}get customTags(){const{customWidgetTags:e}=this.props;return e.filter(({source:e})=>"USER"===e)}render(){return Object(te.jsxs)(i.Fragment,{children:[this.props.isModuleCategoriesUngated&&Object(te.jsx)(es.a,{label:Object(te.jsx)(u.a,{message:ys("categories.label")}),tooltip:Object(te.jsx)(u.a,{message:ys("categories.tooltip")}),children:Object(te.jsx)(Cs,{isReadOnly:this.props.isReadOnly,selectedCategories:this.props.customWidgetCategories,onChange:this.props.onCategoriesChange})}),Object(te.jsx)(es.a,{label:Object(te.jsx)(u.a,{message:ys("tags.label")}),tooltip:Object(te.jsx)(u.a,{message:ys("tags.tooltip")}),children:Object(te.jsx)(js.a,{isReadOnly:this.props.isReadOnly,selectedTags:this.customTags.map(({name:e})=>e),onChange:this.handleCustomTagsChange,showCategories:!1})})]})}}var Ts=xs,Es=s(219),Rs=s(226),Is=s(227);const vs=e=>e.graphqlFiles.byPath,Ws=e=>Object.values(e.graphqlFiles.byId).map(e=>({text:e.label,value:e.path,help:e.description}));var Fs=s(1035),Ss=s(1),Ls=s.n(Ss);const qs="collector/v3/data-query/definitions";function Ds(){return jt.a.get(qs+"/",{query:{portalId:Ls.a.get()}})}function Ps(){const{request:e,receive:t,error:s}=Ps;return i=>{i(e());return Ds().then(e=>{i(t(e))}).catch(e=>{i(s(e))})}}Ps.request=function(){return{type:bt.GRAPHQL_FILES_FETCH}};Ps.receive=function(e){return{type:bt.GRAPHQL_FILES_FETCH,payload:e}};Ps.error=function(e){return{type:bt.GRAPHQL_FILES_FETCH,error:e}};var As=s(1036),Ns=s(383),ks=s(369),ws=s(2737),Gs=s(234),Ms=Object.freeze({JS_ASSETS:"jsAssets",CSS_ASSETS:"cssAssets",GRAPHQL_ASSETS:"graphqlAssets",OTHER_ASSETS:"otherAssets"}),_s=s(365),Us=s(284),Bs=s(2654),Hs=s(734),Vs=s(1031),zs=s(2799),Ks=s(1034);const Js=e=>"DesignEditorsUI.customWidgetEditor.sidebar.main.linkedFiles.otherAssets."+e;class Xs extends i.Component{render(){return Object(te.jsxs)("div",{children:[Object(te.jsx)(k.a,{"data-selenium":"add-asset-link",onClick:this.props.onFileManagerOpen,use:"link",children:Object(te.jsx)(Pt.a,{children:Object(te.jsx)(u.a,{message:Js("addFile")})})}),this.props.FileManager]})}}Xs.propTypes={onFileManagerOpen:l.a.func.isRequired,FileManager:l.a.node};var $s=Object(Ks.a)(Xs),Ys=s(1032),Qs=s(2679);function Zs(){const e=L.makeGetAssets(),t=L.makeGetModulePath(),s=L.makeGetAvailableStylesheets(),i=L.makeGetAvailableJavascripts(),n=L.makeGetIsEmailOrAnyType(),a=L.makeGetAbsoluteDataQueryPath();return function(o,r){return{assets:e(o,r),availableJavascripts:i(o,r),availableStylesheets:s(o,r),availableGraphqlFiles:Ws(o,r),absoluteDataQueryPath:a(o,r),graphqlFilesByPath:vs(o),hasDataCollectorAccess:Object(M.e)(o,r),modulePath:t(o,r),isEmailOrAnyType:n(o,r),javascripts:Object(Is.a)(o,r),stylesheets:Object(Rs.a)(o,r)}}}const ei={fetchStylesheets:Fs.a,fetchJavascripts:As.a,fetchGraphqlFiles:Ps,addAsset:W.a,showAppNotification:ks.b,openFinderRecentlyDeleted:ws.f},ti=e=>"DesignEditorsUI.customWidgetEditor.sidebar.main.linkedFiles."+e,si=e=>Object(ks.a)("linkedFiles.danger."+e);function ii({url:e}){const t=e.split("/");return{name:t[t.length-1],url:e}}function ni({extension:e=""}){return e.toLowerCase()}class ai extends i.Component{constructor(...e){super(...e);this.onAssetsChange=(e,t)=>{t=t.map(e=>Object(p.omit)(e,["id","label","tooltip"]));this.props.updateCustomWidget({[e]:t})};this.onUpdateLinkedDataQuery=({target:{value:e}})=>{const{modulePath:t}=this.props;if(e){const s=Object(Ns.d)(t,e);this.props.updateCustomWidget({dataQueryAbsolutePath:e,dataQueryPath:s})}else this.props.updateCustomWidget({dataQueryAbsolutePath:null,dataQueryPath:null})};this.onAddAsset=(e,t)=>{const{assets:s,customWidgetId:i,addAsset:n}=this.props;Object.keys(s).some(e=>!!s[e].find(e=>e.name===t.name))?this.showErrorNotification("conflict",{fileName:t.name}):n(i,e,t)};this.onOtherFileSelect=e=>{const t=ii(e),s=ni(e);"css"===s||"js"===s?this.showErrorNotification("cssJsInOtherAssets"):this.onAddAsset("otherAssets",t)};this.onCssSelect=e=>{const t={name:this.props.stylesheets.byId[e].label,resource_id:e,autoload:!0};this.onAddAsset("cssAssets",t)};this.onCssFileSelect=e=>{const t=Object.assign({},ii(e),{autoload:!0});"css"!==ni(e)?this.showErrorNotification("notCssInCssAssets"):this.onAddAsset("cssAssets",t)};this.onJsSelect=e=>{const t={name:this.props.javascripts.byId[e].label,resource_id:e,autoload:!0};this.onAddAsset("jsAssets",t)};this.onJsFileSelect=e=>{const t=Object.assign({},ii(e),{autoload:!0});"js"!==ni(e)?this.showErrorNotification("notJsInJsAssets"):this.onAddAsset("jsAssets",t)};this.showErrorNotification=(e,t={})=>{this.props.showAppNotification({notificationKey:"linkedFiles",type:"danger",titleText:Object(te.jsx)(u.a,{message:si(e+".titleText")}),message:Object(te.jsx)(u.a,{message:si(e+".message"),options:t})})};this.renderItemCopyAction=({item:e})=>{const t=`{{ module_asset_url("${e.name}") }}`;return Object(te.jsx)(Hs.a,{className:"asset-item-action",hint:Object(h.a)(ti("otherAssets.copyFileLinkHint")),use:"link",value:t,children:Object(te.jsx)(Pt.a,{children:Object(te.jsx)(u.a,{message:ti("otherAssets.copyFileLink")})})})};this.renderItemEditAction=({item:e})=>{const t=this.getAssetPath(e),s=Object(te.jsx)(Us.a,{className:"asset-item-action",disabled:!t,to:t,children:Object(te.jsx)(Pt.a,{children:Object(te.jsx)(u.a,{message:ti("editAssetLink.label")})})});return t?s:Object(te.jsx)(Bs.a,{placement:"top left",title:Object(te.jsx)(Je.a,{message:ti("editAssetLink.disabledTooltip")}),children:s})};this.renderItemRestoreAction=()=>Object(te.jsx)(Bs.a,{placement:"top left",title:Object(te.jsx)(xt.a,{message:ti("restoreAssetLink.tooltip_jsx"),options:{onClick:this.props.openFinderRecentlyDeleted},elements:{Link:w.a}}),children:Object(te.jsx)(Pt.a,{children:Object(te.jsx)(Qs.a,{name:"warning",size:18})})});this.renderItemAction=({item:e})=>{const{deleted:t}=e;return t?this.renderItemRestoreAction({item:e}):this.renderItemEditAction({item:e})};this.renderAssetsTypeLabel=(e,t)=>Object(te.jsxs)(D.a,{align:"baseline",justify:"between",children:[Object(te.jsx)(Vs.a,{children:Object(te.jsx)(u.a,{message:ti(e+".label")})}),t]})}componentDidMount(){const{hasDataCollectorAccess:e}=this.props;this.props.fetchStylesheets();this.props.fetchJavascripts();e&&this.props.fetchGraphqlFiles()}getSortableListItemsForAssets(e,t){return e.map(e=>{const{name:s,url:i,resource_id:n,path:a}=e,o=n&&Object.keys(t.byId).length&&!t.byId[n];return Object.assign({id:i||n||a,deleted:o,label:s,tooltip:s,itemClassName:o?"danger":""},e)})}getAssetPath(e){const{resource_id:t,path:s}=e;if(t)return Object(_s.e)(B.TEMPLATE,t);if(s){const{modulePath:e}=this.props;return Object(_s.e)(B.TEMPLATE,Object(Ns.c)(s,e),{assetSource:Gs.HOLLOW})}return""}renderAddAssetLink(){return this.props.isReadOnly?null:Object(te.jsx)($s,{onFileSelect:this.onOtherFileSelect})}renderAddStylesheetDropdown(){return this.props.isReadOnly?null:Object(te.jsx)(Ys.a,{templates:this.props.availableStylesheets,onTemplateSelect:this.onCssSelect,onFileSelect:this.onCssFileSelect,templateType:Es.b.css,enableFileManager:!0})}renderAddJavascriptDropdown(){return this.props.isReadOnly?null:Object(te.jsx)(Ys.a,{templates:this.props.availableJavascripts,onTemplateSelect:this.onJsSelect,onFileSelect:this.onJsFileSelect,templateType:Es.b.js,enableFileManager:!0})}renderLinkedStylesheets(){const{isEmailOrAnyType:e,isReadOnly:t}=this.props;return e?null:Object(te.jsxs)("div",{className:"m-bottom-4",children:[this.renderAssetsTypeLabel(Ms.CSS_ASSETS,this.renderAddStylesheetDropdown()),Object(te.jsx)(zs.a,{actionsComponent:this.renderItemAction,emptyText:Object(te.jsx)(u.a,{message:ti("cssAssets.emptyText")}),isReadOnly:t,itemClassName:"asset-item",items:this.getSortableListItemsForAssets(this.props.assets.cssAssets,this.props.stylesheets),onChange:(...e)=>this.onAssetsChange(Ms.CSS_ASSETS,...e)})]})}renderLinkedJavascripts(){const{isEmailOrAnyType:e,isReadOnly:t}=this.props;return e?null:Object(te.jsxs)("div",{className:"m-bottom-4",children:[this.renderAssetsTypeLabel(Ms.JS_ASSETS,this.renderAddJavascriptDropdown()),Object(te.jsx)(zs.a,{actionsComponent:this.renderItemAction,emptyText:Object(te.jsx)(u.a,{message:ti("jsAssets.emptyText")}),isReadOnly:t,itemClassName:"asset-item",items:this.getSortableListItemsForAssets(this.props.assets.jsAssets,this.props.javascripts),onChange:(...e)=>this.onAssetsChange(Ms.JS_ASSETS,...e)})]})}renderGraphQlClear(){return Object(te.jsx)(k.a,{onClick:()=>this.onUpdateLinkedDataQuery({target:{value:null}}),use:"link-danger",children:Object(te.jsx)(Pt.a,{children:Object(te.jsx)(u.a,{message:ti("graphqlAssets.remove")})})})}renderLinkedGraphql(){const{absoluteDataQueryPath:e,isReadOnly:t,hasDataCollectorAccess:s}=this.props,i=!s&&e&&this.renderGraphQlClear();return Object(te.jsxs)("div",{children:[this.renderAssetsTypeLabel("graphqlAssets",i&&this.renderGraphQlClear()),Object(te.jsx)(Bs.a,{placement:"top",title:Object(h.a)(ti("graphqlAssets.disabled")),disabled:s,children:Object(te.jsx)(Os.a,{placeholder:Object(h.a)(ti("graphqlAssets.emptyText")),value:e,clearable:!0,disabled:t||!s,onChange:this.onUpdateLinkedDataQuery,options:this.props.availableGraphqlFiles})})]})}renderOtherAssets(){const{isEmailOrAnyType:e,isReadOnly:t}=this.props;return Object(te.jsxs)("div",{className:"m-bottom-4",children:[this.renderAssetsTypeLabel(e?"assets":Ms.OTHER_ASSETS,this.renderAddAssetLink()),Object(te.jsx)(zs.a,{actionsComponent:this.renderItemCopyAction,emptyText:Object(te.jsx)(u.a,{message:ti("otherAssets.emptyText")}),isReadOnly:t,itemClassName:"asset-item",items:this.getSortableListItemsForAssets(this.props.assets.otherAssets),onChange:(...e)=>this.onAssetsChange(Ms.OTHER_ASSETS,...e)})]})}render(){return Object(te.jsxs)("div",{className:"custom-widget-linked-files",children:[this.renderLinkedStylesheets(),this.renderLinkedJavascripts(),this.renderOtherAssets(),this.renderLinkedGraphql()]})}}ai.propTypes={customWidgetId:c.a.customWidgetId.isRequired,absoluteDataQueryPath:l.a.string,assets:l.a.shape({otherAssets:l.a.arrayOf(l.a.object).isRequired,cssAssets:l.a.arrayOf(l.a.object).isRequired,jsAssets:l.a.arrayOf(l.a.object).isRequired}).isRequired,availableGraphqlFiles:l.a.arrayOf(l.a.object),hasDataCollectorAccess:l.a.bool.isRequired,isEmailOrAnyType:l.a.bool.isRequired,isReadOnly:l.a.bool.isRequired,modulePath:l.a.string.isRequired,updateCustomWidget:l.a.func.isRequired,addAsset:l.a.func.isRequired,showAppNotification:l.a.func.isRequired,openFinderRecentlyDeleted:l.a.func.isRequired,fetchGraphqlFiles:l.a.func.isRequired,graphqlFiles:l.a.shape({byId:l.a.object.isRequired}),availableStylesheets:l.a.array.isRequired,stylesheets:l.a.shape({byId:l.a.object.isRequired}).isRequired,fetchStylesheets:l.a.func.isRequired,availableJavascripts:l.a.array.isRequired,javascripts:l.a.shape({byId:l.a.object.isRequired}).isRequired,fetchJavascripts:l.a.func.isRequired};var oi=Object(o.connect)(Zs,ei)(ai),ri=s(2779);s(10);const di={max:250},li=({count:e})=>e,ci={down:(e,t,{max:s,maxLength:i})=>{const n="number"==typeof i?Math.min(s,i):s;return t?n-t.length:n},up:(e,t)=>t?t.length:0};var pi=s(1037);const ui={text:e=>Object(te.jsx)(Mt.a,Object.assign({},e)),textarea:e=>Object(te.jsx)(pi.a,Object.assign({},e))},hi=["className","counter","errorCondition","labelClassName","max","renderInput","value"],gi=e=>!!Object(i.isValidElement)(e)&&(!!e.type.propTypes&&!!e.type.propTypes.characterCount),bi=e=>"string"==typeof e?ci[e]:e;class mi extends i.PureComponent{constructor(e){super(e);this.state={count:null,label:null,prevValue:void 0};const{counter:t,label:s}=this.props;0}static getDerivedStateFromProps(e,t){const{counter:s,label:i,max:n,maxLength:a,value:o}=e,r=bi(s)(t.prevVal,o,{max:n,maxLength:a});return{count:r,label:"function"==typeof i?i({count:r},s):i,prevValue:e.value}}render(){const e=this.props,{className:t,errorCondition:s,labelClassName:i,renderInput:n,value:a}=e,o=Object(Et.a)(e,hi),{count:r,label:d}=this.state,l="string"==typeof n?ui[n](Object.assign({},o,{error:s(r,a),label:d,value:a})):n(Object.assign({},o,{count:r,label:d,value:a})),c=gi(l)?null:Object(te.jsx)("label",{className:ge()("private-char-count__label",i),"aria-live":"polite",children:d});return Object(te.jsxs)("div",{className:ge()("private-char-count",t,r<0&&"private-char-count--negative"),children:[l,c]})}}mi.propTypes={counter:l.a.oneOfType([l.a.oneOf(Object.keys(ci)),l.a.func]).isRequired,defaultValue:l.a.string,errorCondition:l.a.func,label:l.a.oneOfType([l.a.node,l.a.func]).isRequired,labelClassName:l.a.string,max:l.a.number,maxLength:l.a.number,onBlur:l.a.func,onChange:l.a.func,renderInput:l.a.oneOfType([l.a.oneOf(Object.keys(ui)),l.a.func]).isRequired,value:l.a.string};mi.defaultProps=Object.assign({},di,{counter:"up",errorCondition:e=>e<0,label:li,renderInput:"textarea",value:""});mi.displayName="UICharacterCounter";var ji=Object(Rt.a)(mi),Oi=s(598);const fi=Object(Oi.a)(ji),Ci=e=>"DesignEditorsUI.customWidgetEditor.sidebar.main.editorOptions."+e;class yi extends i.Component{constructor(...e){super(...e);this.onInlineHelpTextChange=e=>{this.props.updateCustomWidget({inlineHelpText:e.target.value})};this.renderInlineHelpText=()=>{const{inlineHelpText:e,isReadOnly:t,moduleErrors:s}=this.props;return Object(te.jsx)(fi,{counter:"down",max:400,onChange:this.onInlineHelpTextChange,value:e,renderInput:({count:e,onChange:i,value:n})=>Object(te.jsx)(os,{characterCount:e,errors:s.inline_help_text,isModuleError:!0,label:Object(te.jsx)(u.a,{message:Ci("inlineHelpTextLabel")}),tooltip:Object(te.jsx)(u.a,{message:Ci("inlineHelpTextTooltip")}),children:Object(te.jsx)(Ht,{disabled:t,inputComponent:ri.a,minHeight:70,onChange:i,value:n})})})}}render(){return Object(te.jsx)("div",{className:"custom-widget-editor-options",children:this.renderInlineHelpText()})}}yi.propTypes={inlineHelpText:l.a.string,isReadOnly:l.a.bool.isRequired,moduleErrors:l.a.object.isRequired,updateCustomWidget:l.a.func.isRequired};var xi=s(490),Ti=s(2662),Ei=s(1503),Ri=s(1040),Ii=s(1504),vi=s(1041);const Wi=e=>"DesignEditorsUI.customWidgetEditor.sidebar.main.translations."+e;function Fi(){const e=L.makeGetMessages(),t=L.makeGetMasterLanguage();return(s,i)=>{const n=e(s,i);return{messages:n,selectedLanguageEditor:q.m(s,i),masterLanguage:t(s,i),languages:Object.keys(n),portalLanguage:Object(vi.a)(s)}}}const Si={setLanguageEditor:F.i,addLanguage:W.b,deleteLanguage:W.j,changeMasterLanguage:W.d,optInTranslations:W.u,regenerateTranslations:W.x};class Li extends i.Component{constructor(...e){super(...e);this.state={selectedMasterLanguage:null,languageToDelete:null};this.validateSourceTranslations=()=>{const{customWidgetId:e,customWidgetLabel:t,masterLanguage:s,messages:i,regenerateTranslations:n}=this.props;s&&!i[s]&&n(e,t,s)};this.onDeleteLanguageClick=e=>{this.setState({languageToDelete:e})};this.onChangeMasterLanguageClick=()=>{this.setState({selectedMasterLanguage:this.props.masterLanguage})};this.onChangeMasterLanguageCancel=()=>{this.setState({selectedMasterLanguage:null})};this.onMasterLanguageChange=({target:{value:e}})=>{this.setState({selectedMasterLanguage:e})};this.onMasterLanguageChangeConfirm=()=>{const{changeMasterLanguage:e,customWidgetId:t,customWidgetLabel:s}=this.props,{selectedMasterLanguage:i}=this.state;e(t,s,i);this.onChangeMasterLanguageCancel()};this.setOpenEditor=e=>{this.props.setLanguageEditor(this.props.customWidgetId,e)};this.enableTranslations=()=>{const{customWidgetId:e,customWidgetLabel:t,optInTranslations:s,portalLanguage:i}=this.props;s(e,t,i)};this.onAddLanguage=e=>{const{addLanguage:t,customWidgetId:s,customWidgetLabel:i}=this.props;t(s,i,e.target.value)};this.onDeleteLanguageCancel=()=>{this.setState({languageToDelete:null})};this.onDeleteLanguage=()=>{this.props.deleteLanguage(this.props.customWidgetId,this.state.languageToDelete);this.onDeleteLanguageCancel()}}componentDidMount(){this.validateSourceTranslations()}get disabled(){return this.props.isReadOnly||!!this.props.revisionId}renderDeleteModal(){const{languageToDelete:e}=this.state;return e?Object(te.jsx)(Ii.default,{languageToDelete:e,i18nKey:Wi,onDeleteLanguage:this.onDeleteLanguage,onDeleteLanguageCancel:this.onDeleteLanguageCancel,disabled:this.disabled}):null}renderChangeMasterLanguageModal(){return this.state.selectedMasterLanguage?Object(te.jsx)(Ei.default,{i18nKey:Wi,masterLanguage:this.props.masterLanguage,onChangeMasterLanguageCancel:this.onChangeMasterLanguageCancel,onMasterLanguageChange:this.onMasterLanguageChange,onMasterLanguageChangeConfirm:this.onMasterLanguageChangeConfirm}):null}renderLanguages(){const{masterLanguage:e,languages:t,selectedLanguageEditor:s}=this.props;return t.map(t=>Object(te.jsx)(Ri.a,{language:t,selectedLanguage:s,onClick:this.setOpenEditor,masterLanguage:e,onChangeMasterLanguageClick:this.onChangeMasterLanguageClick,onDeleteLanguageClick:this.onDeleteLanguageClick,disableActionButtons:this.disabled},t))}renderOptIn(){return Object(te.jsxs)("div",{className:"opt-in",children:[Object(te.jsx)("div",{children:Object(te.jsx)(u.a,{message:Wi("optIn.label")})}),Object(te.jsx)("div",{children:Object(te.jsx)(u.a,{message:Wi("optIn.help")})}),Object(te.jsx)(k.a,{className:"p-top-3",use:"primary",onClick:this.enableTranslations,disabled:this.disabled,children:Object(te.jsx)(u.a,{message:Wi("optIn.button")})})]})}renderLabel(){const e=[this.props.masterLanguage,...this.props.languages];return Object(te.jsx)(xi.a,{className:"translations-label",children:Object(te.jsxs)(D.a,{justify:"between",children:[Object(te.jsx)(m.a,{children:Object(te.jsx)(u.a,{message:Wi("header.label"),options:{count:this.props.languages.length}})}),Object(te.jsx)(m.a,{children:Object(te.jsx)(Ti.a,{anchorType:"button",buttonUse:"link",closeOnTargetLeave:!0,disabled:this.disabled,value:ue.a.text(Wi("header.select")),omittedLanguages:e,onChange:this.onAddLanguage,placement:"bottom left"})})]})})}render(){return this.props.portalLanguage?this.props.masterLanguage?Object(te.jsxs)("div",{children:[this.renderLabel(),this.renderLanguages(),this.renderChangeMasterLanguageModal(),this.renderDeleteModal()]}):this.renderOptIn():null}}Li.propTypes={customWidgetId:c.a.customWidgetId.isRequired,customWidgetLabel:l.a.string.isRequired,messages:l.a.object.isRequired,masterLanguage:l.a.string,languages:l.a.arrayOf(l.a.string),setLanguageEditor:l.a.func.isRequired,selectedLanguageEditor:l.a.string,portalLanguage:l.a.string,addLanguage:l.a.func.isRequired,deleteLanguage:l.a.func.isRequired,changeMasterLanguage:l.a.func.isRequired,optInTranslations:l.a.func.isRequired,regenerateTranslations:l.a.func.isRequired,revisionId:l.a.number,isReadOnly:l.a.bool};Li.defaultProps={languages:[]};var qi=Object(o.connect)(Fi,Si)(Li),Di=s(324),Pi=s(725),Ai=s(479),Ni=s(2745),ki=s(377),wi=s(466),Gi=s(160);const Mi=Object.freeze([Gi.GRADIENT,Gi.SPACING,Gi.BACKGROUND_IMAGE,Gi.BORDER,Gi.ALIGNMENT,Gi.TEXT_ALIGNMENT]),_i=Object.freeze([Gi.BOOLEAN,Gi.CHOICE,Gi.NUMBER,Gi.COLOR,Gi.ICON,Gi.IMAGE,Gi.FONT]),Ui=Object.freeze([...Mi,..._i,Gi.GROUP]),Bi=Object.freeze([...Mi,..._i]);var Hi=s(61),Vi=Object.freeze(Object(Hi.a)({CONTENT:null,LOGIC:null,SELECTORS:null})),zi=s(2700);const Ki=e=>"DesignEditorsUI.customWidgetEditor.sidebar.main.fields.fieldsDropdown."+e,Ji={[Vi.CONTENT]:[Gi.DATE,Gi.DATE_TIME,Gi.EMBED,Gi.LINK,Gi.NUMBER,Gi.RICH_TEXT,Gi.TEXT,Gi.HTML,Gi.HUBL,Gi.SIMPLE_MENU,Gi.URL],[Vi.LOGIC]:[Gi.BOOLEAN,Gi.CHOICE],[Vi.SELECTORS]:[Gi.AUDIO,Gi.BLOG,Gi.COLOR,Gi.CRM_OBJECT,Gi.CRM_OBJECT_PROPERTY,Gi.CTA,Gi.EMAIL,Gi.FILE,Gi.FOLLOW_UP_EMAIL,Gi.FONT,Gi.FORM,Gi.HUBDB_ROW,Gi.HUBDB_TABLE,Gi.ICON,Gi.IMAGE,Gi.LOGO,Gi.MEETING,Gi.MENU,Gi.PAGE,Gi.PAYMENT,Gi.PODCAST,Gi.PRODUCT,Gi.SFDC_CAMPAIGN,Gi.SURVEY,Gi.TAG,Gi.VIDEO,Gi.WORKFLOW]},Xi=[Gi.TEXT,Gi.RICH_TEXT,Gi.IMAGE,Gi.CHOICE,Gi.BOOLEAN];function $i(){const e=Object(q.o)(),t=Object(L.makeGetCustomWidgetBuffer)();return function(s,i){const{schemaVersion:n}=t(s,i)||{};return{isV1:1===n,fieldTypePermissions:e(s,i)}}}class Yi extends i.Component{constructor(...e){super(...e);this.onFieldCreate=e=>{this.props.onFieldCreate(e.target.value)}}getFieldTypeOptions(e){const t=Ji[e].reduce((e,t)=>{if(this.props.fieldTypePermissions[t][ki.a]){const s=gt.a.getFieldTypeLabel(t);e.push({text:s,value:t})}return e},[]);t.sort((e,t)=>e.text.localeCompare(t.text));return t}render(){if(this.props.isV1){const e=Xi.map(e=>({text:gt.a.getFieldTypeLabel(e),value:e}));return Object(te.jsx)(zi.a,{autoFocus:!0,onChange:this.onFieldCreate,options:e})}if(this.props.isStyleTab){const e=Bi.map(e=>({text:gt.a.getFieldTypeLabel(e),value:e}));return Object(te.jsx)(zi.a,{autoFocus:!0,onChange:this.onFieldCreate,options:e})}const e=Object.keys(Ji).map(e=>({text:Object(h.a)(Ki("fieldCategoryLabels."+e)),value:e,options:this.getFieldTypeOptions(e)}));return Object(te.jsx)(zi.a,{autoFocus:!0,onChange:this.onFieldCreate,options:e})}}Yi.propTypes={customWidgetId:c.a.customWidgetId.isRequired,onFieldCreate:l.a.func,fieldTypePermissions:l.a.object.isRequired,isV1:l.a.bool.isRequired,isStyleTab:l.a.bool};Yi.defaultProps={onFieldCreate:pe.a};var Qi=Object(o.connect)($i)(Yi),Zi=s(190),en=s(615),tn=s(0),sn=s.n(tn),nn=s(659),an=s(189);const on=e=>{let t=[];e.children&&e.children.forEach(e=>{t.push(e.type);e.children&&(t=t.concat(on(e)))});return t},rn=(e,t)=>{const s=t.getItem();return s.field.type===Gi.GROUP&&s.groupFieldChildrenList?e.isStyleTab?s.groupFieldChildrenList.every(e=>Ui.includes(e)):!s.groupFieldChildrenList.some(e=>Mi.includes(e)):e.isStyleTab?Ui.includes(s.field.type):!Mi.includes(s.field.type)},dn=Object(en.DragSource)(nn.CUSTOM_WIDGET_FIELD_TABLE_ROW,{beginDrag(e){const t=Object(p.pick)(e,["field","moveField","customWidgetId"]);e.field.type===Gi.GROUP&&e.field.children&&(t.groupFieldChildrenList=on(e.field));return t},isDragging(e,t){const s=t.getItem()?t.getItem().field:{};return e.field.id===s.id}},(e,t)=>({connectDragSource:e.dragSource(),connectDragPreview:e.dragPreview(),isDragging:t.isDragging()})),ln=Object(en.DropTarget)(nn.CUSTOM_WIDGET_FIELD_TABLE_ROW,{hover(e,t,s){const i=t.isOver({shallow:!0}),n=t.getItem().field.id;if(!i||e.field.id===n)return;const{isOverBottom:a,isOverTop:o}=s.state,r=Object(tn.findDOMNode)(s).getBoundingClientRect(),d=(t.getClientOffset().y-r.top)/r.height,l=d>.5,c=d<.5;a===l&&o===c||s.setState({isOverBottom:l,isOverTop:c})},canDrop:(e,t)=>rn(e,t),drop(e,t,s){const{isOverBottom:i,isOverTop:n}=s.state,{field:a,moveField:o,customWidgetId:r}=e,d=t.isOver({shallow:!0}),l=t.getItem().field.id;if(!d||a.id===l)return;let c=null;i?c=an.a:n&&(c=an.c);o(r,l,a.id,c)}},(e,t)=>({connectDropTarget:e.dropTarget(),isOver:t.isOver({shallow:!0}),canDrop:t.canDrop()})),cn=Object(en.DropTarget)(nn.CUSTOM_WIDGET_FIELD_TABLE_ROW,{canDrop:(e,t)=>rn(e,t),drop(e,t){const{parentField:s,moveField:i,customWidgetId:n}=e,a=t.isOver({shallow:!0}),o=t.getItem().field.id;a&&i(n,o,s.id,an.b)}},(e,t)=>({connectDropTarget:e.dropTarget(),isOver:t.isOver({shallow:!0})})),pn=e=>"DesignEditorsUI.customWidgetEditor.sidebar.main.fields.fieldGroupDropZone."+e;class un extends i.Component{render(){const{connectDropTarget:e,isOver:t,canDrop:s}=this.props,i=ge()("field-group-drop-zone p-all-4 text-center",t&&"is--over"+(s?"":" is--cannot-drop"));return e(Object(te.jsx)("div",{className:i,children:Object(te.jsx)(Pt.a,{use:"help",children:Object(te.jsx)(u.a,{message:pn("message")})})}))}}un.propTypes={connectDropTarget:l.a.func.isRequired,isOver:l.a.bool.isRequired,canDrop:l.a.bool.isRequired};var hn=cn(un),gn=s(707);class bn extends i.Component{render(){const{className:e,fieldErrors:t,i18nKey:s,placement:i}=this.props,n=Object.keys(t).reduce((e,s)=>t[s].length+e,0);return n?Object(te.jsx)(Bs.a,{placement:i,title:Object(h.a)(s,{count:n}),children:Object(te.jsx)(gn.a,{backgroundColor:Di.CANDY_APPLE,borderWidth:0,className:e,color:Di.OLAF,name:"warning",padding:.2,size:10})}):null}}bn.propTypes={className:l.a.string,fieldErrors:l.a.object,i18nKey:l.a.string,placement:l.a.string};bn.defaultProps={className:null,fieldErrors:{},i18nKey:"DesignEditorsUI.customWidgetEditor.errors.tooltips.fieldError",placement:"top"};class mn extends i.Component{render(){const{className:e,fieldWarnings:t,i18nKey:s,placement:i}=this.props,n=Object.keys(t).reduce((e,s)=>t[s].length+e,0);return n?Object(te.jsx)(Bs.a,{placement:i,title:Object(h.a)(s,{count:n}),children:Object(te.jsx)(gn.a,{backgroundColor:Di.MARIGOLD_DARK,borderWidth:0,className:e,color:Di.OLAF,name:"warning",padding:.2,size:10})}):null}}mn.propTypes={className:l.a.string,fieldWarnings:l.a.object,i18nKey:l.a.string,placement:l.a.string};mn.defaultProps={className:null,fieldWarnings:{},i18nKey:"DesignEditorsUI.customWidgetEditor.errors.tooltips.fieldWarning",placement:"top"};var jn=s(2790),On=s(1333);const fn=e=>"DesignEditorsUI.customWidgetEditor.sidebar.copySnippetButton."+e;function Cn(){const e=Object(L.makeGetIsFieldCopyable)();return(t,s)=>{const i=s.field&&s.field.id;return{isFieldCopyable:e(t,{fieldId:i,customWidgetId:s.customWidgetId}),hasFetchedMediaBridgeProviders:On.a(t),hasInstalledMediaBridgeProviders:On.e(t).length>0}}}const yn={fetchMediaBridgeProviders:jn.b};class xn extends i.Component{componentDidMount(){this.props.field.type===Gi.EMBED&&this.props.useFullSnippet&&!this.props.hasFetchedMediaBridgeProviders&&this.props.fetchMediaBridgeProviders()}get copyValue(){const{contentTypes:e,fieldName:t,hostTemplateTypes:s,hasInstalledMediaBridgeProviders:i}=this.props;return this.props.useFullSnippet?this.props.field.getModuleSnippet(t,{contentTypes:e,hostTemplateTypes:s,hasInstalledMediaBridgeProviders:i}):`{{ module.${t} }}`}render(){const{useFullSnippet:e,className:t,children:s,use:i,tooltipPlacement:n,disabled:a,isFieldCopyable:o}=this.props;let r=e?Object(te.jsx)(u.a,{message:fn("label")}):Object(te.jsx)(u.a,{message:fn("valueLabel")});s&&(r=s);return Object(te.jsx)(Hs.a,{className:t,disabled:a||!o,tooltipPlacement:n,use:i,value:this.copyValue,children:r})}}xn.propTypes={children:l.a.node,className:l.a.string,contentTypes:l.a.array,field:l.a.instanceOf(gt.a).isRequired,hostTemplateTypes:l.a.array,isFieldCopyable:l.a.bool.isRequired,tooltipPlacement:l.a.string,use:l.a.string,fieldName:l.a.string.isRequired,disabled:l.a.bool,useFullSnippet:l.a.bool,hasFetchedMediaBridgeProviders:l.a.bool,hasInstalledMediaBridgeProviders:l.a.bool,fetchMediaBridgeProviders:l.a.func.isRequired};xn.defaultProps={className:null,children:null,tooltipPlacement:"left",use:"link",fieldName:"",disabled:!1,useFullSnippet:!0};var Tn=Object(o.connect)(Cn,yn)(xn);const En=e=>"DesignEditorsUI.customWidgetEditor.sidebar.main.fields.fieldRow."+e,Rn=()=>{const e=L.makeGetCustomWidgetBuffer();return(t,s)=>{const i=e(t,s);return{contentTypes:i.contentTypes||[],hostTemplateTypes:i.hostTemplateTypes||[],fieldCreateOptions:Object(q.b)(t,s),fieldErrors:L.getFieldErrors(t,s),fieldWarnings:L.getFieldWarnings(t,s)}}},In={createField:W.f,cloneField:W.e,deleteField:W.i,moveField:W.t,setSelectedField:F.j,toggleFieldGroupingSelection:F.l};class vn extends i.Component{constructor(e){super(e);this.onAddFieldClick=()=>{this.setState({openFieldsList:!0})};this.onFieldCreate=e=>{const{createField:t,customWidgetId:s,field:i,fieldCreateOptions:n}=this.props;t(s,new gt.a({type:e,isNew:!0,fieldCreateOptions:n}),i.id)};this.handleClose=()=>{this.setState({openActionsDropDown:!1,openFieldsList:!1})};this.handleOpenChange=e=>{const{value:t}=e.target;t!==this.state.openActionsDropDown&&this.setState({openActionsDropDown:t,openFieldsList:!!t&&this.state.openFieldsList})};this.onPopoverOpen=()=>{this.setState({showActionButtons:!0})};this.onPopoverClose=()=>{this.setState({showActionButtons:!1})};this.onCloneClick=this.onCloneClick.bind(this);this.onDeleteClick=this.onDeleteClick.bind(this);this.onEditClick=this.onEditClick.bind(this);this.onRowClick=this.onRowClick.bind(this);this.state={isOverBottom:!1,isOverTop:!1,openActionsDropDown:!1,openFieldsList:!1,showActionButtons:!1}}onCloneClick(){this.props.cloneField(this.props.customWidgetId,this.props.field.id);this.handleClose()}onDeleteClick(){const{customWidgetId:e,deleteField:t,field:s}=this.props;t(e,s.id);this.handleClose()}onEditClick(){const{customWidgetId:e,setSelectedField:t,field:s}=this.props;t(e,{id:s.id});this.handleClose()}onRowClick(){const{toggleFieldGroupingSelection:e,customWidgetId:t,fieldGrouping:s,field:i}=this.props;s.isActive&&e(t,i)}renderDragHandle(){const{connectDragSource:e,depth:t,fieldErrors:s,fieldWarnings:i,field:n,fieldGrouping:a,isDraggable:o,isReadOnly:r}=this.props,d="m-right-2"+(t===Zi.a-1?" max-depth-error-icon":""),l=Object(te.jsxs)(D.a,{align:"center",className:"p-left-7",children:[Object(te.jsx)(bn,{className:d,fieldErrors:s}),Object(te.jsx)(mn,{className:d,fieldWarnings:i}),Object(te.jsxs)(D.a,{direction:"column",children:[Object(te.jsx)(Pt.a,{className:"field-label",use:n.label?null:"help",children:Object(te.jsxs)(Lt.a,{children:[n.label||Object(h.a)(En("missingLabel")),Object(te.jsxs)("span",{className:"m-left-1",children:["(",n.getFieldTypeLabel(),")"]})]})}),Object(te.jsx)(Pt.a,{className:"m-top-1 field-name is--code is--text--help",use:"help",children:Object(te.jsx)(Lt.a,{children:n.name})})]})]});return r||!o||a.isActive?Object(te.jsx)("div",{className:"p-left-2",children:l}):e(Object(te.jsx)("div",{className:"p-left-2",children:Object(te.jsx)(wi.a,{children:l})}))}renderActionContents(){const{field:e,customWidgetId:t,canCreateFieldType:s,canEditFieldType:i,isStyleTab:n}=this.props;if(this.state.openFieldsList)return Object(te.jsx)(Qi,{customWidgetId:t,onFieldCreate:this.onFieldCreate,isStyleTab:n});const a=e.type===Gi.GROUP?"actions.cloneGroup":"actions.cloneField",o=e.type===Gi.GROUP?"actions.deleteGroup":"actions.deleteField";let r=Object(te.jsx)(k.a,{disabled:!s,onClick:this.onCloneClick,use:"link",children:Object(te.jsx)(u.a,{message:En(a)})});if(!s){const e=i?"missingCreatePermission":"missingEditAndCreatePermission";r=Object(te.jsx)(Bs.a,{title:Object(h.a)(En(e)),children:r})}const d=this.props.fieldName||e.name;return Object(te.jsxs)(Dt.a,{children:[Object(te.jsx)(Tn,{customWidgetId:this.props.customWidgetId,hostTemplateTypes:this.props.hostTemplateTypes,contentTypes:this.props.contentTypes,field:e,fieldName:d}),Object(te.jsx)(Tn,{customWidgetId:this.props.customWidgetId,hostTemplateTypes:this.props.hostTemplateTypes,contentTypes:this.props.contentTypes,field:e,fieldName:d,useFullSnippet:!1}),r,Object(te.jsx)(k.a,{onClick:this.onDeleteClick,use:"link",children:Object(te.jsx)(u.a,{message:En(o)})}),e.type===Gi.GROUP&&Object(te.jsx)(k.a,{onClick:this.onAddFieldClick,use:"link",children:Object(te.jsx)(u.a,{message:En("actions.addField")})})]})}renderActionsList(){const{isReadOnly:e}=this.props,{openActionsDropDown:t,openFieldsList:s}=this.state,i=Object(te.jsx)(Pt.a,{children:Object(te.jsx)(u.a,{message:En("actions.label")})});return Object(te.jsx)(qt.a,{buttonSize:"extra-small",buttonText:i,buttonUse:"link",closeOnMenuClick:!1,disabled:e,onOpenChange:this.handleOpenChange,open:t,placement:"bottom left",popoverProps:{onOpenComplete:this.onPopoverOpen,onCloseComplete:this.onPopoverClose},use:s?"unstyled":"list",children:this.renderActionContents()})}renderActions(){const{canEditFieldType:e,canCreateFieldType:t,isReadOnly:s,fieldGrouping:i}=this.props;if(i.isActive)return null;const n=s?Object(te.jsx)(u.a,{message:En("actions.viewField")}):Object(te.jsx)(u.a,{message:En("actions.editField")});let a=Object(te.jsx)(k.a,{disabled:!e,onClick:this.onEditClick,use:"link",children:Object(te.jsx)(Pt.a,{children:n})});if(!e){const e=t?"missingEditPermission":"missingEditAndCreatePermission";a=Object(te.jsx)(Bs.a,{title:Object(h.a)(En(e)),children:a})}const o="field-row-actions-dropdown"+(this.state.showActionButtons?" actions-dropdown-selected":"");return Object(te.jsxs)("span",{className:o,children:[a,this.renderActionsList()]})}renderChildren(){const{customWidgetId:e,field:t,fieldName:s,moveField:n,depth:a,isStyleTab:o}=this.props;return t.type!==Gi.GROUP?null:t.children&&t.children.length?Object(te.jsx)("div",{className:"field-children p-top-0 p-x-4 p-bottom-4",children:t.children.map(e=>{const n=`${s||t.name}.${e.name}`;return Object(i.createElement)(Wn,Object.assign({},this.props,{depth:a+1,field:e,fieldName:n,isChild:!0,key:"fields-table-row-"+e.id}))})}):a<Zi.a-1?Object(te.jsx)("div",{className:"field-children p-top-0 p-x-4 p-bottom-4",children:Object(te.jsx)(hn,{customWidgetId:e,moveField:n,parentField:t,isStyleTab:o})}):null}renderRow(){return Object(te.jsx)("div",{className:"field-row",onClick:this.onRowClick,children:Object(te.jsxs)(D.a,{align:"center",className:"p-y-3 p-right-4",justify:"between",children:[this.renderDragHandle(),this.renderActions()]})})}render(){const{connectDragPreview:e,connectDropTarget:t,isDragging:s,isChild:i,isOver:n,fieldGrouping:a,field:o,canDrop:r}=this.props,{selectedFields:d={},isActive:l,fieldsAreNotSiblings:c,isTooDeep:p}=a,u=c||p,h=d[o.id],g=ge()("field-row-and-children-container",n&&[this.state.isOverBottom&&"is--over-bottom",this.state.isOverTop&&"is--over-top",!r&&"is--cannot-drop"],h&&(u?"is--invalid-selected":"is--selected"),i&&"is--child-field",s&&"is--dragging",l&&"is--in-group-mode");return t(e(Object(te.jsxs)("div",{className:g,children:[this.renderRow(),this.renderChildren()]})))}}vn.propTypes={canEditFieldType:l.a.bool,canDrop:l.a.bool,canCreateFieldType:l.a.bool,connectDragPreview:l.a.func.isRequired,connectDragSource:l.a.func.isRequired,connectDropTarget:l.a.func.isRequired,contentTypes:l.a.array,customWidgetId:c.a.customWidgetId.isRequired,hostTemplateTypes:l.a.array,cloneField:l.a.func.isRequired,deleteField:l.a.func.isRequired,depth:l.a.number.isRequired,field:l.a.instanceOf(gt.a).isRequired,fieldCreateOptions:l.a.object.isRequired,fieldGrouping:l.a.object.isRequired,fieldName:l.a.string,fieldErrors:l.a.object,fieldWarnings:l.a.object,isChild:l.a.bool,isDragging:l.a.bool.isRequired,isOver:l.a.bool.isRequired,isReadOnly:l.a.bool.isRequired,isDraggable:l.a.bool,isStyleTab:l.a.bool.isRequired,moveField:l.a.func.isRequired,setSelectedField:l.a.func.isRequired,toggleFieldGroupingSelection:l.a.func.isRequired,createField:l.a.func.isRequired};vn.defaultProps={canEditFieldType:!0,canCreateFieldType:!0,depth:0,fieldName:"",isChild:!1,isDraggable:!0};const Wn=Object(P.compose)(Object(o.connect)(Rn,In),dn,ln)(vn);var Fn=Wn;const Sn=e=>"DesignEditorsUI.customWidgetEditor.sidebar.main.fields."+e;function Ln(){const e=q.o();return(t,s)=>({fieldGrouping:q.d(t,s),fieldTypePermissions:e(t,s)})}const qn={};class Dn extends i.PureComponent{constructor(e){super(e);this.onSearchInputChange=e=>{this.setState({searchTerm:e.target.value})};this.onSearchInputClear=()=>{this.setState({searchTerm:""})};this.renderField=e=>{const{customWidgetId:t,fieldGrouping:s,fieldName:n,fieldTypePermissions:a,isReadOnly:o,isStyleTab:r,depth:d}=this.props,l=n?{fieldName:`${n}.${e.name}`}:{},c=a[e.type]||{},p=!!c[ki.b],u=!!c[ki.a];return Object(te.jsx)("tr",{className:"custom-widget-fields-table-row",children:Object(te.jsx)("td",{className:"p-all-0",children:Object(i.createElement)(Fn,Object.assign({},l,{canEditFieldType:p,canCreateFieldType:u,customWidgetId:t,field:e,fieldGrouping:s,isReadOnly:o,isStyleTab:r,isDraggable:!this.state.searchTerm,key:"fields-table-row-"+e.id,depth:d}))})},e.id)};this.state={searchTerm:""}}getMatchingFields(){const{searchTerm:e}=this.state,{fields:t,fieldGrouping:{isActive:s}}=this.props;return!s&&e?Object(ce.k)(t,e):t}renderFields(){return this.getMatchingFields().map(this.renderField)}renderSearch(){const{searchTerm:e}=this.state,{fieldGrouping:{isActive:t},depth:s}=this.props;if(t||s>0)return null;let i=null;if(e){const t=this.getMatchingFields(),s=t.length?"results":"noResults";i=Object(te.jsxs)(D.a,{align:"center",className:"fields-table__search__results",justify:"between",children:[Object(te.jsx)(Pt.a,{className:"fields-results-text",children:Object(te.jsx)(u.a,{message:Sn("search."+s),options:{searchTerm:e,count:t.length}})}),Object(te.jsx)(k.a,{onClick:this.onSearchInputClear,use:"unstyled",children:Object(te.jsx)(Qs.a,{color:Di.EERIE,name:"remove"})})]})}return Object(te.jsxs)("div",{className:"fields-table__search",children:[Object(te.jsx)(Ni.a,{onChange:this.onSearchInputChange,placeholder:Object(h.a)(Sn("search.placeholder")),value:e}),i]})}renderStyleTabOptIn(){const{createStyleFieldGroup:e,isReadOnly:t}=this.props;return Object(te.jsxs)("div",{className:"opt-in",children:[Object(te.jsx)(Ai.a,{title:Object(te.jsx)(xt.a,{message:Sn("styleTabOptIn.help_jsx"),options:{external:!0,href:"https://developers.hubspot.com/docs/cms/building-blocks/module-theme-fields-overview#style-fields"},elements:{Link:w.a}}),children:Object(te.jsx)(u.a,{message:Sn("styleTabOptIn.label")})}),Object(te.jsx)(k.a,{className:"p-top-3",use:"primary",onClick:e,disabled:t,"data-test-id":"style-tab-opt-in",children:Object(te.jsx)(u.a,{message:Sn("styleTabOptIn.button")})})]})}render(){const{isStyleTab:e,styleFields:t}=this.props;return e&&!t?Object(te.jsx)("div",{children:this.renderStyleTabOptIn()}):this.props.fields.length?Object(te.jsxs)("div",{children:[this.renderSearch(),Object(te.jsx)(Pi.a,{className:"custom-widget-fields-table",flush:!0,hover:!1,children:Object(te.jsx)("tbody",{children:this.renderFields()})})]}):Object(te.jsx)(Pt.a,{use:"help",children:Object(te.jsx)(u.a,{message:Sn("noFields")})})}}Dn.propTypes={customWidgetId:c.a.customWidgetId.isRequired,fields:l.a.arrayOf(l.a.instanceOf(gt.a)).isRequired,styleFields:l.a.instanceOf(gt.a),isStyleTab:l.a.bool,styleTab:l.a.instanceOf(gt.a),fieldName:l.a.string,depth:l.a.number,isReadOnly:l.a.bool,createStyleFieldGroup:l.a.func,fieldGrouping:l.a.object.isRequired,fieldTypePermissions:l.a.object.isRequired};Dn.defaultProps={depth:0,isReadOnly:!1,isStyleTab:!1};var Pn=Object(P.compose)(Object(o.connect)(Ln,qn))(Dn);const An=e=>"DesignEditorsUI.customWidgetEditor.sidebar.main.fields.fieldsDropdown."+e;class Nn extends i.Component{constructor(...e){super(...e);this.onFieldCreate=e=>{this.props.onFieldCreate(e)}}render(){const e=this.props.buttonText||Object(te.jsx)(u.a,{message:An("addField")});return Object(te.jsx)(qt.a,{buttonClassName:this.props.isStyleTab?"add-style-field-dropdown":"add-field-dropdown",buttonSize:"extra-small",buttonText:Object(te.jsx)(Pt.a,{children:e}),buttonUse:"link",className:"fields-dropdown",closeOnTargetLeave:!0,menuWidth:315,disabled:this.props.disabled,placement:"bottom left",children:Object(te.jsx)(Qi,{customWidgetId:this.props.customWidgetId,onFieldCreate:this.onFieldCreate,isStyleTab:this.props.isStyleTab})})}}Nn.propTypes={customWidgetId:c.a.customWidgetId.isRequired,buttonText:l.a.string,onFieldCreate:l.a.func,disabled:l.a.bool,isStyleTab:l.a.bool};Nn.defaultProps={buttonText:null,onFieldCreate:pe.a};const kn=e=>"DesignEditorsUI.customWidgetEditor.sidebar.main.fieldGrouping."+e;function wn(){return(e,t)=>({fieldGrouping:Object(q.d)(e,t)})}const Gn={createFieldGroup:W.g,toggleFieldGrouping:F.k};class Mn extends i.PureComponent{constructor(...e){super(...e);this.onCancelClick=()=>{const{customWidgetId:e,toggleFieldGrouping:t}=this.props;t(e)};this.onCreateGroupClick=()=>{const{createFieldGroup:e,customWidgetId:t,fieldGrouping:s}=this.props,{selectedFields:i}=s;if(!Object.keys(i).length)return;e(t,new gt.a({type:Gi.GROUP,isNew:!0}),i)}}render(){const{selectedFields:e,fieldsAreNotSiblings:t,isTooDeep:s}=this.props.fieldGrouping,i=!Object.keys(e).length||t||s,n=t&&Object(te.jsx)("div",{children:Object(te.jsx)(Pt.a,{use:"error",children:Object(te.jsx)(u.a,{message:kn("fieldsAreNotSiblingsMessage")})})}),a=s&&Object(te.jsx)("div",{children:Object(te.jsx)(Pt.a,{use:"error",children:Object(te.jsx)(u.a,{message:kn("isTooDeepMessage"),options:{maxNestingDepth:Zi.a}})})});return Object(te.jsxs)("div",{className:"sidebar-group-controls",children:[Object(te.jsx)(Pt.a,{children:Object(te.jsx)(u.a,{message:kn("message")})}),n,a,Object(te.jsxs)("div",{className:"p-top-2",children:[Object(te.jsx)(k.a,{disabled:i,onClick:this.onCreateGroupClick,size:"small",use:"primary",children:Object(te.jsx)(u.a,{message:kn("buttons.createGroup")})}),Object(te.jsx)(k.a,{onClick:this.onCancelClick,size:"small",use:"secondary",children:Object(te.jsx)(u.a,{message:kn("buttons.cancel")})})]})]})}}Mn.propTypes={createFieldGroup:l.a.func.isRequired,customWidgetId:c.a.customWidgetId.isRequired,toggleFieldGrouping:l.a.func.isRequired,fieldGrouping:l.a.object.isRequired};var _n=Object(o.connect)(wn,Gn)(Mn),Un=s(2635);function Bn(e,t={}){return Object.assign({action:e},t)}const{track:Hn}=Un.b,Vn=e=>"DesignEditorsUI.customWidgetEditor.sidebar.copyFieldsJsonButton."+e,zn=({fields:e=[]})=>{const t=Object(o.useDispatch)(),s=JSON.stringify(e,null," "),i=()=>{t(Hn("customWidgetInteraction",Bn("field-json-copied")))};return Object(te.jsx)(Hs.a,{disabled:0===e.length,use:"link",value:s,onClick:i,children:Object(te.jsx)(Pt.a,{children:Object(te.jsx)(u.a,{message:Vn("label")})})})};zn.propTypes={fields:l.a.oneOfType([l.a.instanceOf(gt.a),l.a.arrayOf(l.a.instanceOf(gt.a))])};var Kn=zn,Jn=s(391),Xn=s(507),$n=s(313),Yn=s(291);const Qn=["autoSelect","buttonUse","buttonRowRenderer","inputRef","onChange","onCopy","textAreaProps","tooltipPlacement","use","value"],Zn=({className:e,onClick:t,tooltipPlacement:s,use:i,value:n})=>Object(te.jsx)("div",{className:e,children:Object(te.jsx)(Hs.a,{onClick:t,tooltipPlacement:s,use:i,value:n})}),ea=e=>{const t=e.target.getBoundingClientRect();return{bottom:t.bottom-e.clientY,right:t.right-e.clientX}};class ta extends i.PureComponent{constructor(e){super(e);this.handleCopyClick=e=>{const{inputRef:t,onCopy:s}=this.props;t.current&&t.current.select();s&&s(e)};this.handleTextAreaMouseMove=e=>{const t=18,{bottom:s,right:i}=ea(e),n=s<t&&i<t;this.setState({isResizing:n})};this.handleTextAreaMouseDown=e=>{const{autoSelect:t,inputRef:s}=this.props;if(t&&!this.state.isResizing){e.preventDefault();s.current&&s.current.select()}};this.state={isResizing:!1}}render(){const e=this.props,{autoSelect:t,buttonUse:s,buttonRowRenderer:i,inputRef:n,onChange:a,textAreaProps:o,tooltipPlacement:r,use:d,value:l}=e,c=Object(Et.a)(e,Qn),p="code"===d,u=p?pi.a:ri.a;"code"===d&&o.maxHeight&&delete o.maxHeight;return Object(te.jsxs)("div",Object.assign({},c,{children:[Object(te.jsx)(u,Object.assign({},o,{className:"private-text-area--copyable"+(p?" private-text-area--code is--code":""),inputRef:n,onChange:a,onMouseMove:!p&&t&&!1!==o.resize?this.handleTextAreaMouseMove:null,onMouseDown:this.handleTextAreaMouseDown,readOnly:!!p||o.readOnly,resize:!p&&o.resize,value:l,$isCode:p})),Object(te.jsx)(i,{className:"m-y-3",onClick:this.handleCopyClick,tooltipPlacement:r,use:s,value:l})]}))}}ta.propTypes={autoSelect:l.a.bool.isRequired,buttonRowRenderer:l.a.oneOfType([l.a.func,l.a.node]),buttonUse:Hs.a.propTypes.use,inputRef:$n.a,onChange:l.a.func,onCopy:l.a.func,textAreaProps:Object(Yn.a)((e,t,s)=>{if("object"!=typeof e[t])return new Error(`${s}\`: \`${t}\` must be an object.`);const{textAreaProps:i,use:n}=e;0;return null},"object"),tooltipPlacement:Hs.a.propTypes.tooltipPlacement,use:l.a.oneOf(["default","code"]),value:l.a.string};ta.defaultProps={autoSelect:!0,buttonRowRenderer:Zn,buttonUse:"tertiary",textAreaProps:{},tooltipPlacement:"right",use:"default"};ta.displayName="UICopyTextArea";var sa=Object(Xn.a)(Object(Rt.a)(ta));const ia=e=>"DesignEditorsUI.customWidgetEditor.sidebar.main.moduleSnippet."+e;class na extends i.Component{constructor(e){super(e);this.getSnippet=()=>{const{snippet:e}=this.state;this.setState({snippet:this.createSnippet(this.props)});return e};this.renderButton=()=>Object(te.jsx)(Hs.a,{className:"m-top-2",size:"extra-small",use:"tertiary-light",valueWhenCopied:this.getSnippet,children:Object(te.jsx)(u.a,{message:ia("snippetInput.buttonText")})});this.state={snippet:this.createSnippet(e)}}shouldComponentUpdate(e,t){return this.props.customWidgetId!==e.customWidgetId||this.props.customWidgetLabel!==e.customWidgetLabel||this.state.snippet!==t.snippet}componentDidUpdate(e){this.props.customWidgetId===e.customWidgetId&&this.props.customWidgetLabel===e.customWidgetLabel||this.setState({snippet:this.createSnippet(this.props)})}createSnippet(e){return Object(Jn.b)({moduleId:e.moduleId,name:e.customWidgetLabel,path:e.customWidgetPath})}render(){const e=Object(te.jsx)(u.a,{message:ia("snippetInput.label")});return Object(te.jsxs)("div",{children:[Object(te.jsx)(u.a,{message:ia("helpText")}),Object(te.jsx)(_t.a,{children:Object(te.jsx)(Zt.a,{className:"m-top-3",label:e,children:Object(te.jsx)(Ht,{inputComponent:sa,use:"code",buttonRowRenderer:this.renderButton,value:this.state.snippet})})})]})}}na.propTypes={customWidgetId:c.a.customWidgetId.isRequired,moduleId:l.a.number,customWidgetLabel:l.a.string.isRequired,customWidgetPath:l.a.string.isRequired};var aa=s(395),oa=s(183);function ra(){const e=Y.makeGetParentConnectionsByCategory(),t=L.makeGetCustomWidgetBuffer();return function(s,i){const n=q.f(s,i),a=e(s,{assetId:i.customWidgetId}),o=Object(M.b)(s),r=Object(M.k)(s),d=t(s,{assetId:i.customWidgetId}).contentTypes,l=d.includes(oa.c)||d.includes(oa.b),c=d.includes(oa.g),p=l||c,u=Object(M.g)(s);let h=!0;if(p){l&&!o&&(h=!1);c&&!r&&(h=!1)}else u||(h=!1);return{isEditingGlobalContent:n,dependentsCount:Object.keys(a).reduce((e,t)=>e+Object.keys(a[t]).length,0),hasSmartContentAccess:h}}}const da={fetchForParentConnections:aa.b,setIsEditingGlobalContent:F.g},la=e=>"DesignEditorsUI.customWidgetEditor.sidebar.main.globalAndSmartContent."+e;class ca extends i.PureComponent{constructor(...e){super(...e);this.onEditGlobalContent=()=>{this.props.setIsEditingGlobalContent(this.props.customWidgetId,!0)}}componentDidMount(){this.props.fetchForParentConnections(this.props.customWidgetId)}componentDidUpdate(e){this.props.customWidgetId!==e.customWidgetId&&this.props.fetchForParentConnections(this.props.customWidgetId)}renderDependentsMessage(){const{customWidgetId:e,dependentsCount:t}=this.props;if(!t)return null;const s=Object(te.jsx)(Us.a,{to:Object(_s.b)(B.CUSTOM_WIDGET,e),children:Object(te.jsx)(u.a,{message:la("dependentsLink"),options:{count:t}})});return Object(te.jsx)(A.a,{message:la("dependentsLink.prefix"),options:{dependentsLink:s}})}render(){const{isEditingGlobalContent:e,hasSmartContentAccess:t}=this.props;return Object(te.jsxs)("div",{children:[Object(te.jsx)("div",{children:Object(te.jsxs)(Pt.a,{children:[Object(te.jsx)(u.a,{message:la("message")}),this.renderDependentsMessage()]})}),Object(te.jsx)(Bs.a,{disabled:t,title:Object(te.jsx)(u.a,{message:la("noSmartContent")}),children:Object(te.jsx)(k.a,{className:"m-top-3",disabled:e||!t,onClick:this.onEditGlobalContent,size:"extra-small",use:"tertiary-light",children:Object(te.jsx)(u.a,{message:la("editButton.globalAndSmart")})})})]})}}ca.propTypes={customWidgetId:c.a.customWidgetId.isRequired,isEditingGlobalContent:l.a.bool.isRequired,hasSmartContentAccess:l.a.bool.isRequired,dependentsCount:l.a.number.isRequired,fetchForParentConnections:l.a.func.isRequired,setIsEditingGlobalContent:l.a.func.isRequired};var pa=Object(o.connect)(ra,da)(ca),ua=s(1042),ha=s(613),ga=s(1182),ba=s(2762),ma=s(1038);const ja=Object(ee.a)(()=>Promise.all([s.e("convert-modals~modals~upgrade-modals"),s.e("convert-modals")]).then(s.bind(null,1589)));function Oa(){const e=L.makeGetCustomWidgetBuffer(),t=Y.makeGetParentConnectionsByCategory(),s=Y.makeGetParentConnectionsCount();return function(i,n){const{hostTemplateTypes:a,id:o}=e(i,n)||{};return{hostTemplateTypes:a,customWidgetId:o,dependentsCount:s(i,{assetId:o}),dependentsByCategory:t(i,{assetId:o})}}}function fa(e){class t extends i.Component{constructor(e){super(e);this.handleUpdateTemplateCallback=e=>{e&&this.props.updateCustomWidget(e);this.handleUpdateModalClose()};this.handleUpdateModalClose=()=>{this.setState({open:!1})};this.handleUpdateHostTemplateTypesClick=()=>{this.setState({open:!0})};this.state={open:!1}}renderUpdateTemplateModal(){const{open:e}=this.state,{hostTemplateTypes:t,dependentsByCategory:s,customWidgetId:i,dependentsCount:n}=this.props;return e?Object(te.jsx)(ja,{hostTemplateTypes:t,callback:this.handleUpdateTemplateCallback,dependentsByCategory:s,customWidgetId:i,dependentsCount:n}):null}render(){const t=this.renderUpdateTemplateModal();return Object(te.jsx)(e,Object.assign({},this.props,{updateTemplateModal:t,onUpdateHostTemplateTypesClick:this.handleUpdateHostTemplateTypesClick,handleOnboardingUpdatedTemplate:this.handleOnboardingUpdatedTemplate}))}}t.propTypes={hostTemplateTypes:l.a.array.isRequired,updateCustomWidget:l.a.func.isRequired,customWidgetId:c.a.customWidgetId.isRequired,dependentsByCategory:O.dependentsByCategory,dependentsCount:l.a.number};return Object(o.connect)(Oa,null)(t)}const Ca=Object(ee.a)(()=>Promise.all([s.e("cta-picker~custom-widget-editor~layout-editor~modals"),s.e("custom-widget-editor~layout-editor~modals"),s.e("convert-modals~modals~upgrade-modals"),s.e("cta-picker~modals"),s.e("modals")]).then(s.bind(null,770))),ya=Object(Oi.a)(Mt.a),xa=e=>"DesignEditorsUI.customWidgetEditor.sidebar.main.nameLabel."+e,Ta=Object.freeze([]);function Ea(){const e=L.makeGetCustomWidgetBuffer();return(t,s)=>{const i=e(t,s);let n="";i&&(n=i.path&&i.path.startsWith("@hubspot")?i.displayName||i.label||i.name:i.name||"");return{customWidgetLabel:n,displayName:i&&i.displayName||"",isV1:!!i&&1===i.schemaVersion,isUngatedForContentTypes:Object(yt.i)(t),contentTypes:i&&i.contentTypes?i.contentTypes:Ta,hostTemplateTypes:i?i.hostTemplateTypes:Ta,customWidgetIcon:i?i.icon:null}}}const Ra={setIsSelectingIcon:F.h};class Ia extends i.PureComponent{constructor(e){super(e);this.onLabelBlur=()=>{const e=this.props.customWidgetLabel,{isValidLabel:t,label:s}=this.state;t&&s!==e?this.handleRenameConfirmOpen():this.setState({isValidLabel:!0,label:e})};this.handleRenameConfirmOpen=()=>{this.setState({showRenameConfirmModal:!0})};this.handleRenameConfirmClose=()=>{this.setState({showRenameConfirmModal:!1})};this.handleRenameConfirmCallback=(e=!1)=>{e||this.onLabelChange(this.props.customWidgetLabel,!0);this.handleRenameConfirmClose()};this.handleDisplayNameChange=e=>{const{updateCustomWidget:t}=this.props;t({displayName:e.target.value})};this.onLabelChange=(e,t)=>{this.setState({isValidLabel:t,label:e})};this.onLabelError=e=>{this.onLabelChange(e,!1)};this.onLabelSuccess=e=>{this.onLabelChange(e,!0)};this.onIconClick=()=>{const{customWidgetId:e,setIsSelectingIcon:t}=this.props;t(e,!0)};const{customWidgetLabel:t}=this.props;this.state={isValidLabel:!0,label:t,showRenameConfirmModal:!1}}componentDidUpdate(e){e.customWidgetLabel!==this.props.customWidgetLabel&&this.setState({label:this.props.customWidgetLabel})}renderRenameFileConfirmModal(){return this.state.showRenameConfirmModal?Object(te.jsx)(Ca,{callback:this.handleRenameConfirmCallback,fileId:this.props.customWidgetId,newFileName:this.state.label}):null}renderTypeLabel(){const{isReadOnly:e,isV1:t,isUngatedForContentTypes:s,contentTypes:i,hostTemplateTypes:n,revisionId:a,onUpdateHostTemplateTypesClick:o}=this.props;if(t)return null;if(s){let t,s="contentTypesLabel";if(!i.length||i.includes(oa.a)){t=Object(te.jsx)(u.a,{message:i.length?"contentUtils.contentTypes."+oa.a:xa("contentTypes.noContentTypes")});s="contentTypesLabel.other"}else t=i.map(e=>Object(h.a)("contentUtils.contentTypes."+e)).join(", ");return Object(te.jsx)(Pt.a,{className:"display-block",children:Object(te.jsx)(A.a,{message:xa(s),options:{count:i.length,types:Object(te.jsx)(k.a,{onClick:o,use:"link",size:"extra-small",disabled:!!a||e,children:t})}})})}const r=n.includes(oa.a)||n.includes(oa.f)?n.length+1:n.length;return Object(te.jsx)(Pt.a,{className:"display-block",children:Object(te.jsx)(A.a,{message:xa("templateTypesLabel"),options:{count:r,types:Object(te.jsx)(k.a,{onClick:o,use:"link",size:"extra-small",disabled:!!a||e,children:n.map(e=>Object(h.a)(xa("types."+e))).join(", ")})}})})}renderIcon(){const{isReadOnly:e,customWidgetIcon:t,isV1:s}=this.props,i=t?"":"p-y-2";let n=Object(te.jsx)(ba.a,{className:i,size:ha.o,icon:t});if(!e&&!s){const e=Object(te.jsx)(D.a,{align:"center",justify:"center",children:Object(te.jsx)("div",{className:"change-icon-text text-center",children:Object(te.jsx)(u.a,{message:xa("changeIcon")})})});n=Object(te.jsx)(ga.a,{className:"custom-widget-icon-overlay",foregroundContent:e,onClick:this.onIconClick,children:n})}return Object(te.jsx)("div",{className:"m-right-2",children:n})}render(){const{label:e}=this.state,{displayName:t}=this.props;return Object(te.jsxs)(i.Fragment,{children:[Object(te.jsxs)(G.a,{align:"center",className:"custom-widget-name-label",itemLeft:this.renderIcon(),children:[this.renderRenameFileConfirmModal(),this.props.updateTemplateModal,Object(te.jsx)(ma.a,{allowBlank:!1,onBlur:this.onLabelBlur,onError:this.onLabelError,onSuccess:this.onLabelSuccess,placeholder:Object(h.a)(xa("placeholder")),readOnly:this.props.isReadOnly,typeLabel:this.renderTypeLabel(),value:e})]}),Object(te.jsx)(Zt.a,{className:"m-top-2","data-test-id":"module-label",tooltip:Object(te.jsx)(A.a,{message:xa("displayNameTooltip")}),label:Object(te.jsx)(A.a,{message:xa("displayNameLabel")}),children:Object(te.jsx)(ya,{readOnly:this.props.isReadOnly,value:t,onChange:this.handleDisplayNameChange})})]})}}Ia.propTypes={customWidgetLabel:l.a.string.isRequired,customWidgetId:c.a.customWidgetId.isRequired,displayName:l.a.string.isRequired,revisionId:l.a.number,isReadOnly:l.a.bool.isRequired,isUngatedForContentTypes:l.a.bool.isRequired,isV1:l.a.bool.isRequired,contentTypes:l.a.array.isRequired,hostTemplateTypes:l.a.array.isRequired,onUpdateHostTemplateTypesClick:l.a.func.isRequired,updateTemplateModal:l.a.node,customWidgetIcon:l.a.string,setIsSelectingIcon:l.a.func.isRequired,updateCustomWidget:l.a.func.isRequired};var va=Object(P.compose)(Object(o.connect)(Ea,Ra),fa)(Ia),Wa=s(1091),Fa=s(774),Sa=s(503),La=s(458),qa=s(1491),Da=s(1005),Pa=s(605),Aa=s(453),Na=s(335),ka=s(337),wa=s(336),Ga=s(1492);function Ma(){const[e,t]=Object(i.useState)(!1);return Object(o.useSelector)(yt.l)?Object(te.jsx)(Aa.a,{content:Object(te.jsxs)(te.Fragment,{children:[Object(te.jsxs)(wa.a,{children:[Object(te.jsx)(Pa.a,{children:Object(te.jsx)(u.a,{message:"DesignEditorsUI.shared.programmableEmail.crmTokensHeading"})}),Object(te.jsx)(Sa.a,{className:"m-x-3",use:"beta",children:Object(te.jsx)(u.a,{message:"DesignEditorsUI.shared.programmableEmail.beta"})}),Object(te.jsx)(ka.a,{popoverUse:"longform",onClick:()=>t(!1)})]}),Object(te.jsx)(Na.a,{className:"m-bottom-4",children:Object(te.jsx)(Ga.a,{})})]}),open:e,placement:"left",use:"longform",width:520,children:Object(te.jsx)(k.a,{className:"p-left-0",onClick:()=>t(e=>!e),size:"small",use:"transparent",children:Object(te.jsx)(u.a,{message:"DesignEditorsUI.customWidgetEditor.toolbar.isEnabledForEmailV3Rendering.helpLink"})})}):null}var _a=Ma;const{track:Ua}=Un.b;class Ba extends i.PureComponent{constructor(e){super(e);this.onClickToggle=()=>{this.setState({modalOpen:!0})};this.state={modalOpen:!1}}renderConfirmModal(){return this.state.modalOpen?Object(te.jsx)(qa.a,{onConfirm:()=>{this.props.track("programmableEmailInteraction",Bn(this.props.checked?"disable":"enable"));this.props.onChange(!this.props.checked);this.setState({modalOpen:!1})},onCancel:()=>{this.setState({modalOpen:!1})},version:this.props.checked?"MODULE_TWO":"MODULE_THREE",fileId:this.props.fileId}):null}render(){return Object(te.jsxs)("div",{children:[Object(te.jsxs)("div",{className:"display-flex align-center m-bottom-2",children:[Object(te.jsx)(xi.a,{children:this.props.toggleLabel}),Object(te.jsx)(La.a,{disabled:this.props.disabled,checked:this.props.checked,onChange:this.onClickToggle,size:"extra-small"})]}),this.props.tooltipTitle,Object(te.jsx)("div",{className:"m-top-2",children:Object(te.jsx)(_a,{})}),this.props.checked&&Object(te.jsx)(Da.a,{}),this.renderConfirmModal()]})}}Ba.propTypes={disabled:l.a.bool,checked:l.a.bool.isRequired,onChange:l.a.func.isRequired,toggleLabel:l.a.node.isRequired,tooltipTitle:l.a.node,fileId:l.a.number.isRequired,track:l.a.func.isRequired};Ba.defaultProps={disabled:!1};var Ha=Object(o.connect)(null,{track:Ua})(Ba),Va=s(2809);const za=e=>"DesignEditorsUI.customWidgetEditor.toolbar."+e;function Ka(){const e=L.makeGetCustomWidgetBuffer(),t=L.makeGetIsEmailOrAnyType();return(s,i)=>{const n=e(s,i);return{isBufferLoaded:!!n,isEnabledForEmailV3Rendering:!(!n||!n.isEnabledForEmailV3Rendering),isEmailOrAnyType:t(s,i)}}}const Ja={setIsSelectingIcon:F.h};class Xa extends i.PureComponent{constructor(...e){super(...e);this.onIsEnabledForEmailV3RenderingToggleChange=e=>{this.props.updateCustomWidget({isEnabledForEmailV3Rendering:e})}}render(){return this.props.isEmailOrAnyType?Object(te.jsx)(Ha,{disabled:!this.props.isBufferLoaded||this.props.isReadOnly,checked:!!this.props.isEnabledForEmailV3Rendering,onChange:this.onIsEnabledForEmailV3RenderingToggleChange,toggleLabel:Object(te.jsxs)(te.Fragment,{children:[Object(te.jsx)(u.a,{className:"m-right-2",message:za("isEnabledForEmailV3Rendering.label")}),Object(te.jsx)(Sa.a,{use:"beta",children:Object(te.jsx)(u.a,{message:za("isEnabledForEmailV3Rendering.beta")})})]}),tooltipTitle:Object(te.jsx)(Pt.a,{use:"help",children:Object(te.jsx)(xt.a,{message:za("isEnabledForEmailV3Rendering.tooltipTitle_jsx"),elements:{KnowledgeBaseButton:()=>Object(te.jsx)(Va.a,{url:"https://knowledge.hubspot.com/email/create-programmable-emails"})}})}),fileId:this.props.customWidgetId}):null}}Xa.propTypes={customWidgetId:c.a.customWidgetId.isRequired,isEmailOrAnyType:l.a.bool.isRequired,isReadOnly:l.a.bool.isRequired,updateCustomWidget:l.a.func.isRequired,isBufferLoaded:l.a.bool.isRequired,isEnabledForEmailV3Rendering:l.a.bool.isRequired};var $a=Object(o.connect)(Ka,Ja)(Xa);const Ya=e=>"DesignEditorsUI.customWidgetEditor.sidebar.main."+e,Qa=[nn.CUSTOM_WIDGET_FIELD_TABLE_ROW,nn.CUSTOM_WIDGET_CHOICE_FIELD_OPTION],Za=Object(Fa.a)(Qa)(Tt.a),eo=e=>Object.keys(e).reduce((t,s)=>t.concat(e[s]||[]),[]);class to extends i.PureComponent{constructor(...e){super(...e);this.onFieldCreate=e=>{const{createField:t,customWidgetId:s,fieldCreateOptions:i}=this.props;t(s,new gt.a({type:e,isNew:!0,fieldCreateOptions:i}))};this.onStyleFieldCreate=e=>{const{styleFields:t,createField:s,customWidgetId:i,fieldCreateOptions:n}=this.props;s(i,new gt.a({type:e,isNew:!0,fieldCreateOptions:n}),t.id)};this.onGroupClick=e=>{const{customWidgetId:t,toggleFieldGrouping:s}=this.props;s(t,e)};this.onTagsChange=(e,t)=>{this.props.updateCustomWidget({contentTags:e,tags:t})};this.onCategoriesChange=e=>{this.props.updateCustomWidget({categories:e})};this.onOpenChange=e=>t=>{this.props.saveAccordionState(e,t.target.value)};this.onAddStyleFieldGroup=()=>{const{createFieldGroup:e,customWidgetId:t}=this.props;e(t,new gt.a({type:"group",isNew:!1,name:"style",label:"Style",tab:"STYLE"}))};this.sortFieldErrors=e=>{const{styleFields:t}=this.props,s={},i={};Object.keys(e).forEach(n=>{const a=eo(e[n]);t&&Object(ce.v)(t,n)?i[n]=a:s[n]=a});return{content:s,style:i}}}getIsOpen(e){return Object(Wa.a)(this.props.accordionStates,e)}get editorOptionsErrors(){const{moduleErrors:e}=this.props;return Object(p.pick)(e,["inline_help_text"])}renderBreadcrumbs(){const{customWidgetLabel:e}=this.props,{customWidgetIcon:t,isReadOnly:s}=this.props,i=Object(te.jsx)(ba.a,{alignment:"text-bottom",size:14,icon:t}),n=e?Object(te.jsx)("span",{children:e}):null;return Object(te.jsx)(Nt.a,{className:"field-edit-breadcrumbs",isReadOnly:s,rootIcon:i,rootLabel:n})}renderNameLabel(){return Object(te.jsx)(va,{customWidgetId:this.props.customWidgetId,isReadOnly:this.props.isReadOnly,revisionId:this.props.revisionId,updateCustomWidget:this.props.updateCustomWidget})}renderEmailV3RenderingToggle(){return Object(te.jsx)($a,{customWidgetId:this.props.customWidgetId,isReadOnly:this.props.isReadOnly,updateCustomWidget:this.props.updateCustomWidget})}renderFields(){const{fields:e,customWidgetId:t,isReadOnly:s}=this.props;return Object(te.jsx)(Pn,{customWidgetId:t,fields:e,isReadOnly:s})}renderStyleFields(){const{styleFields:e,customWidgetId:t,isReadOnly:s}=this.props;return Object(te.jsx)(Pn,{customWidgetId:t,fields:e&&e.children||[],styleFields:e,isStyleTab:!0,fieldName:e&&e.name,isReadOnly:s,createStyleFieldGroup:this.onAddStyleFieldGroup})}renderStyleTabEditControls(){const{styleFields:e,customWidgetId:t,isReadOnly:s,revisionId:i}=this.props;return Object(te.jsx)(gs,{customWidgetId:t,revisionId:i,field:e,isReadOnly:s})}renderFieldsDropdown(){const{isReadOnly:e,isFieldGroupingActive:t,isV1:s,customWidgetId:i,fields:n}=this.props;if(t)return null;if(e)return Object(te.jsx)(Kn,{fields:n});if(s)return Object(te.jsx)(Nn,{customWidgetId:i,onFieldCreate:this.onFieldCreate});const a=Object(te.jsx)(Pt.a,{children:Object(te.jsx)(u.a,{message:Ya("actionButtonLabel")})});return Object(te.jsxs)(D.a,{align:"center",children:[Object(te.jsx)(Nn,{customWidgetId:i,onFieldCreate:this.onFieldCreate}),Object(te.jsx)(qt.a,{buttonClassName:"m-left-0",buttonUse:"transparent",buttonText:a,menuWidth:150,children:Object(te.jsxs)(Dt.a,{children:[Object(te.jsx)(Kn,{fields:n}),Object(te.jsx)(k.a,{onClick:()=>{this.onGroupClick("CONTENT")},use:"link",children:Object(te.jsx)(Pt.a,{children:Object(te.jsx)(u.a,{message:Ya("fields.groupLabel")})})})]})})]})}renderStyleFieldsDropdown(){const{isReadOnly:e,isFieldGroupingActive:t,customWidgetId:s,styleFields:i}=this.props;if(t)return null;if(e)return Object(te.jsx)(Kn,{fields:i});const n=Object(te.jsx)(Pt.a,{children:Object(te.jsx)(u.a,{message:Ya("actionButtonLabel")})});return Object(te.jsxs)(D.a,{align:"center",children:[Object(te.jsx)(Nn,{customWidgetId:s,onFieldCreate:this.onStyleFieldCreate,disabled:!i,isStyleTab:!0}),Object(te.jsx)(qt.a,{buttonClassName:"m-left-0",buttonUse:"transparent",buttonText:n,menuWidth:150,children:Object(te.jsxs)(Dt.a,{children:[Object(te.jsx)(Kn,{fields:i}),Object(te.jsx)(k.a,{onClick:()=>{this.onGroupClick(cs.d)},disabled:!i,use:"link",children:Object(te.jsx)(Pt.a,{children:Object(te.jsx)(u.a,{message:Ya("fields.groupLabel")})})})]})})]})}renderGlobalAndSmartContentAccordion(){const{customWidgetPath:e,isGlobal:t,moduleId:s}=this.props;return t&&s?Object(te.jsx)(kt.a,{titleText:Object(te.jsx)(u.a,{message:Ya("accordionLabels.globalAndSmartContent")}),onOpenChange:this.onOpenChange(bs.e),open:this.getIsOpen(bs.e),children:this.props.hasGlobalContentEditorAccess?Object(te.jsx)(ua.a,{contentPath:e,globalContentType:"module"}):Object(te.jsx)(pa,{customWidgetId:this.props.customWidgetId})},"global-content"):null}renderLinkedFilesHelpLink(){const{isEmailOrAnyType:e}=this.props,t=Object(te.jsx)("h4",{children:Object(te.jsx)(u.a,{message:Ya("linkedFiles.helpLink.header")})}),s=Object(te.jsxs)("p",{children:[Object(te.jsx)(Je.a,{message:Ya("linkedFiles.helpLink.body")}),e?Object(te.jsx)(Je.a,{message:Ya("linkedFiles.helpLink.emailWarning")}):null]});return Object(te.jsx)(St,{closeOnTargetLeave:!0,content:{header:t,body:s},placement:"bottom left",children:Object(te.jsx)(Pt.a,{children:Object(te.jsx)(u.a,{message:Ya("linkedFiles.helpLink.text")})})})}renderFieldTranslationsHelpLink(){const e=Object(te.jsx)("h4",{children:Object(te.jsx)(u.a,{message:Ya("translations.helpLink.header")})}),t=Object(te.jsx)("p",{children:Object(te.jsx)(xt.a,{message:Ya("translations.helpLink.body_jsx"),options:{external:!0,href:"https://knowledge.hubspot.com/articles/kcs_article/cos-general/create-translations-of-your-modules"},elements:{Link:w.a}})});return Object(te.jsx)(St,{closeOnTargetLeave:!0,content:{header:e,body:t},placement:"bottom left",children:Object(te.jsx)(Pt.a,{children:Object(te.jsx)(u.a,{message:Ya("translations.helpLink.text")})})})}renderFieldTranslations(){const{customWidgetId:e,customWidgetLabel:t,revisionId:s,isReadOnly:i}=this.props;return Object(te.jsx)(kt.a,{actions:this.renderFieldTranslationsHelpLink(),titleText:Object(te.jsx)(u.a,{message:Ya("accordionLabels.translations")}),onOpenChange:this.onOpenChange(bs.m),open:this.getIsOpen([bs.m]),children:Object(te.jsx)(qi,{customWidgetId:e,customWidgetLabel:t,revisionId:s,isReadOnly:i})},"field-translations")}renderAccordions(){const{customWidgetId:e,isFieldGroupingActive:t,fieldType:s,updateCustomWidget:i,isReadOnly:n,assets:a,isModuleCategoriesUngated:o,isModuleStyleFieldsUngated:r,revisionId:d,isV1:l,customWidgetInlineHelpText:c,fieldsErrors:p,fieldsWarnings:g}=this.props,{content:b,style:m}=this.sortFieldErrors(p),{content:j,style:O}=this.sortFieldErrors(g),f=Object(te.jsxs)(D.a,{align:"end",children:[Object(te.jsx)(bn,{className:"m-right-2",fieldErrors:b,i18nKey:Ya("accordionLabels.hasError")}),Object(te.jsx)(mn,{className:"m-right-2",fieldWarnings:j,i18nKey:Ya("accordionLabels.hasWarning")}),Object(te.jsx)(Lt.a,{matchContentWidth:!0,children:Object(te.jsx)(u.a,{message:Ya("accordionLabels.fields")})})]}),C=Object(te.jsxs)(D.a,{align:"end",children:[Object(te.jsx)(bn,{className:"m-right-2",fieldErrors:m,i18nKey:Ya("accordionLabels.hasError")}),Object(te.jsx)(mn,{className:"m-right-2",fieldWarnings:O,i18nKey:Ya("accordionLabels.hasWarning")}),Object(te.jsx)(Lt.a,{matchContentWidth:!0,children:Object(te.jsx)(u.a,{message:Ya("accordionLabels.styleFields")})})]}),y=Object(te.jsxs)(D.a,{align:"end",children:[Object(te.jsx)(bn,{className:"m-right-2",fieldErrors:this.editorOptionsErrors,i18nKey:Ya("accordionLabels.hasError")}),Object(te.jsx)(u.a,{message:Ya("accordionLabels.editorOptions")})]}),x=Object(te.jsx)(u.a,{message:Ya("accordionLabels.linkedFiles"),options:{fileCount:a.otherAssets.length+a.cssAssets.length+a.jsAssets.length}}),T=Object(te.jsx)(u.a,{message:Ya("accordionLabels.tags")});return t?s===cs.d?this.renderStyleFields():this.renderFields():l?[Object(te.jsx)(kt.a,{actions:this.renderFieldsDropdown(),defaultOpen:!0,titleText:f,onOpenChange:this.onOpenChange(bs.d),open:this.getIsOpen(bs.d),children:this.renderFields()},"fields")]:[this.renderGlobalAndSmartContentAccordion(),Object(te.jsx)(kt.a,{actions:this.renderFieldsDropdown(),defaultOpen:!this.props.isGlobal,titleText:f,onOpenChange:this.onOpenChange(bs.d),open:this.getIsOpen(bs.d),children:this.renderFields()},"fields"),r&&Object(te.jsxs)(kt.a,{fieldType:"style",actions:this.renderStyleFieldsDropdown(),defaultOpen:!this.props.isGlobal,titleText:C,onOpenChange:this.onOpenChange(bs.k),open:this.getIsOpen(bs.k),children:[this.renderStyleTabEditControls(),this.renderStyleFields()]},"style-fields"),Object(te.jsx)(kt.a,{titleText:y,onOpenChange:this.onOpenChange(bs.c),open:this.getIsOpen(bs.c),children:Object(te.jsx)(yi,{customWidgetId:e,isReadOnly:n,updateCustomWidget:i,revisionId:d,moduleErrors:this.editorOptionsErrors,inlineHelpText:c})},"editor-options"),Object(te.jsx)(kt.a,{actions:this.renderLinkedFilesHelpLink(),titleText:x,onOpenChange:this.onOpenChange(bs.g),open:this.getIsOpen(bs.g),children:Object(te.jsx)(oi,{customWidgetId:e,isReadOnly:n,updateCustomWidget:i,revisionId:d})},"linked-files"),Object(te.jsx)(kt.a,{titleText:T,onOpenChange:this.onOpenChange([bs.l]),open:this.getIsOpen(bs.l),children:Object(te.jsx)(Ts,{customWidgetCategories:this.props.customWidgetCategories,customWidgetTags:this.props.customWidgetTags,isModuleCategoriesUngated:o,isReadOnly:n,onCategoriesChange:this.onCategoriesChange,onTagsChange:this.onTagsChange})},"tags"),this.renderFieldTranslations(),Object(te.jsx)(kt.a,{titleText:Object(h.a)(Ya("accordionLabels.moduleSnippet")),onOpenChange:this.onOpenChange(bs.j),open:this.getIsOpen(bs.j),children:Object(te.jsx)(na,{customWidgetId:this.props.customWidgetId,customWidgetLabel:this.props.customWidgetLabel,customWidgetPath:this.props.customWidgetPath,moduleId:this.props.moduleId})},"snippet")]}renderGroupControls(){const{customWidgetId:e,isFieldGroupingActive:t,isV1:s}=this.props;return!t||s?null:Object(te.jsx)(wt.a,{flush:!0,children:Object(te.jsx)(_n,{customWidgetId:e})})}render(){return Object(te.jsx)(At.a,{className:"main-sidebar-container",breadcrumbsContent:this.renderBreadcrumbs(),contentComponent:Za,children:Object(te.jsxs)(Gt.a,{className:"main-sidebar-controls",children:[this.renderNameLabel(),this.renderEmailV3RenderingToggle(),this.renderGroupControls(),this.renderAccordions()]})})}}to.propTypes={assets:l.a.object.isRequired,createField:l.a.func.isRequired,createFieldGroup:l.a.func.isRequired,isGlobal:l.a.bool.isRequired,customWidgetLabel:l.a.string.isRequired,customWidgetTags:l.a.array.isRequired,customWidgetCategories:l.a.array.isRequired,customWidgetId:c.a.customWidgetId.isRequired,fieldCreateOptions:l.a.object.isRequired,fieldsErrors:l.a.object.isRequired,fieldsWarnings:l.a.object.isRequired,moduleErrors:l.a.object.isRequired,moduleId:l.a.number,isFieldGroupingActive:l.a.bool.isRequired,fields:l.a.arrayOf(l.a.instanceOf(gt.a)).isRequired,styleFields:l.a.instanceOf(gt.a),isModuleCategoriesUngated:l.a.bool,isModuleStyleFieldsUngated:l.a.bool,isEmailOrAnyType:l.a.bool.isRequired,isReadOnly:l.a.bool.isRequired,toggleFieldGrouping:l.a.func.isRequired,fieldType:l.a.string,updateCustomWidget:l.a.func.isRequired,saveAccordionState:l.a.func.isRequired,accordionStates:l.a.object.isRequired,revisionId:l.a.number,customWidgetIcon:l.a.string,isV1:l.a.bool.isRequired,customWidgetPath:l.a.string.isRequired,hasGlobalContentEditorAccess:l.a.bool,customWidgetInlineHelpText:l.a.string};const so=Object.freeze([]);function io(){const e=L.makeGetCustomWidgetBufferContentFields(),t=L.makeGetCustomWidgetBufferStyleFields(),s=L.makeGetCustomWidgetBuffer(),i=L.makeGetAssets(),n=L.makeGetIsEmailOrAnyType(),a=L.makeGetIsReadOnly();return(o,r)=>{const d=s(o,r),l=q.f(o,r),{isActive:c,fieldType:p}=q.d(o,r);return{assets:i(o,r),isBufferLoaded:!!d,customWidgetIcon:d?d.icon:null,customWidgetId:r.customWidgetId,moduleId:d?d.moduleId:null,customWidgetLabel:d?d.name:"",isGlobal:!!d&&d.global,customWidgetCategories:d?d.categories:so,customWidgetTags:d?d.contentTags:so,isV1:!!d&&1===d.schemaVersion,fields:e(o,r),styleFields:t(o,r),isModuleCategoriesUngated:Object(yt.b)(o),isModuleStyleFieldsUngated:Object(yt.d)(o),fieldsErrors:L.getFieldsErrors(o,r),fieldsWarnings:L.getFieldsWarnings(o,r),hasGlobalContentEditorAccess:Object(M.h)(o),isFieldGroupingActive:!!c,fieldType:p,isReadOnly:Object(M.w)(o)||a(o,r)||l,moduleErrors:L.getModuleErrors(o,r),accordionStates:q.a(o,r),customWidgetPath:d?d.path:"",isEmailOrAnyType:n(o,r),customWidgetInlineHelpText:d?d.inlineHelpText:"",fieldCreateOptions:q.b(o,r)}}}const no={createField:W.f,createFieldGroup:W.g,toggleFieldGrouping:F.k,toggleFieldGroupingSelection:F.l,updateCustomWidget:W.E,saveAccordionState:F.d,fetchSfdcIntegrationStatus:Ct};class ao extends i.Component{constructor(...e){super(...e);this.updateCustomWidget=e=>{const{customWidgetId:t,updateCustomWidget:s}=this.props;s(t,e)};this.saveAccordionState=(e,t=!1)=>{this.props.saveAccordionState(this.props.customWidgetId,e,t)}}componentDidMount(){this.props.fetchSfdcIntegrationStatus()}render(){const{accordionStates:e,assets:t,createField:s,createFieldGroup:i,customWidgetIcon:n,customWidgetId:a,customWidgetPath:o,customWidgetCategories:r,fieldCreateOptions:d,fields:l,styleFields:c,isModuleCategoriesUngated:p,isModuleStyleFieldsUngated:u,hasGlobalContentEditorAccess:h,isFieldGroupingActive:g,fieldType:b,isReadOnly:m,isV1:j,moduleId:O,revisionId:f,toggleFieldGrouping:C,toggleFieldGroupingSelection:y,isEmailOrAnyType:x,fieldsErrors:T,fieldsWarnings:E,moduleErrors:R,customWidgetInlineHelpText:I}=this.props;return this.props.isBufferLoaded?Object(te.jsx)(to,{accordionStates:e,assets:t,createField:s,createFieldGroup:i,customWidgetIcon:n,customWidgetId:a,customWidgetLabel:this.props.customWidgetLabel,customWidgetPath:o,customWidgetCategories:r,customWidgetTags:this.props.customWidgetTags,fieldCreateOptions:d,fields:l,styleFields:c,isModuleCategoriesUngated:p,isModuleStyleFieldsUngated:u,fieldsErrors:T,fieldsWarnings:E,hasGlobalContentEditorAccess:h,isFieldGroupingActive:g,fieldType:b,isGlobal:this.props.isGlobal,isReadOnly:m,isV1:j,moduleErrors:R,moduleId:O,revisionId:f,toggleFieldGrouping:C,toggleFieldGroupingSelection:y,updateCustomWidget:this.updateCustomWidget,saveAccordionState:this.saveAccordionState,isEmailOrAnyType:x,customWidgetInlineHelpText:I}):null}}ao.propTypes={assets:l.a.object.isRequired,createField:l.a.func.isRequired,createFieldGroup:l.a.func.isRequired,customWidgetId:c.a.customWidgetId.isRequired,moduleId:l.a.number,isFieldGroupingActive:l.a.bool.isRequired,fieldCreateOptions:l.a.object.isRequired,fieldType:l.a.string,fields:l.a.arrayOf(l.a.instanceOf(gt.a)).isRequired,styleFields:l.a.instanceOf(gt.a),isModuleCategoriesUngated:l.a.bool,isModuleStyleFieldsUngated:l.a.bool,isReadOnly:l.a.bool.isRequired,toggleFieldGrouping:l.a.func.isRequired,toggleFieldGroupingSelection:l.a.func.isRequired,revisionId:l.a.number,updateCustomWidget:l.a.func.isRequired,saveAccordionState:l.a.func.isRequired,accordionStates:l.a.object.isRequired,customWidgetIcon:l.a.string,isBufferLoaded:l.a.bool.isRequired,isGlobal:l.a.bool.isRequired,customWidgetLabel:l.a.string.isRequired,customWidgetCategories:l.a.array.isRequired,customWidgetTags:l.a.array.isRequired,fetchSfdcIntegrationStatus:l.a.func.isRequired,isV1:l.a.bool.isRequired,customWidgetPath:l.a.string.isRequired,hasGlobalContentEditorAccess:l.a.bool,isEmailOrAnyType:l.a.bool.isRequired,fieldsErrors:l.a.object.isRequired,fieldsWarnings:l.a.object.isRequired,moduleErrors:l.a.object.isRequired,customWidgetInlineHelpText:l.a.string};ao.defaultProps={accordionStates:{}};var oo=Object(o.connect)(io,no)(ao),ro=s(1207),lo=s(2742),co=s(1141);const po=e=>"DesignEditorsUI.customWidgetEditor.sidebar.fieldEdit.editorOptions."+e,uo=({editField:e,field:t})=>{const s=t=>{e({[Ut.a]:t.target.checked})},{type:i}=t,n=t[Ut.a];return i!==Gi.BORDER?null:Object(te.jsxs)(lo.a,{checked:n,onChange:s,children:[Object(te.jsx)(xi.a,{className:"p-top-0 p-right-1",children:Object(te.jsx)(u.a,{message:po("allowCustomBorderSides")})}),Object(te.jsx)(co.a,{title:Object(te.jsx)(u.a,{message:po("allowCustomBorderSidesTooltip")})})]})};uo.propTypes={editField:l.a.func.isRequired,field:l.a.instanceOf(gt.a).isRequired};var ho=uo;const go=Object(Oi.a)(ji),bo=e=>"DesignEditorsUI.customWidgetEditor.sidebar.fieldEdit.editorOptions."+e;class mo extends i.Component{constructor(...e){super(...e);this.onHelpTextChange=e=>{this.props.editField({help_text:e.target.value})};this.onInlineHelpTextChange=e=>{this.props.editField({[Ut.o]:e.target.value})};this.onRequiredChange=e=>{this.props.editField({[Ut.B]:e.target.checked})};this.onLockedChange=e=>{this.props.editField({[Ut.p]:e.target.checked})};this.onExpandedChange=e=>{this.props.editField({[Ut.l]:e.target.checked})};this.renderRequiredToggle=()=>{const{field:e,readOnly:t}=this.props;return e.type===Gi.GROUP?null:Object(te.jsxs)("div",{children:[Object(te.jsx)(xi.a,{children:Object(te.jsx)(u.a,{message:bo("requiredLabel")})}),Object(te.jsx)(La.a,{checked:e[Ut.B],"data-test-id":"module-field-editor-options-required-toggle",onChange:this.onRequiredChange,size:"extra-small",readOnly:t})]})};this.renderLockedToggle=()=>this.props.isGlobal?null:Object(te.jsxs)("div",{children:[Object(te.jsx)(xi.a,{children:Object(te.jsx)(u.a,{message:bo("lockedLabel")})}),Object(te.jsx)(La.a,{checked:this.props.field[Ut.p],"data-test-id":"module-field-editor-options-locked-toggle",onChange:this.onLockedChange,size:"extra-small",readOnly:this.props.readOnly})]});this.renderExpandedToggle=()=>{const{field:e,readOnly:t}=this.props;if(e.type!==Gi.GROUP)return null;return e.children.some(e=>e.type===Gi.GROUP)?null:Object(te.jsxs)("div",{children:[Object(te.jsx)(xi.a,{children:Object(te.jsx)(u.a,{message:bo("expandedLabel")})}),Object(te.jsx)(La.a,{checked:e[Ut.l],"data-test-id":"module-field-editor-options-expanded-toggle",onChange:this.onExpandedChange,size:"extra-small",readOnly:t})]})};this.renderInlineHelpTextInput=()=>{const{field:e,fieldErrors:t,readOnly:s}=this.props;return Object(te.jsx)(go,{counter:"down",max:400,onChange:this.onInlineHelpTextChange,value:e[Ut.o],renderInput:({count:e,onChange:i,value:n})=>Object(te.jsx)(os,{characterCount:e,"data-test-id":"module-field-editor-inline-help",errors:t[Ut.o],label:Object(te.jsx)(u.a,{message:bo("inlineHelpTextLabel")}),tooltip:Object(te.jsx)(u.a,{message:bo("inlineHelpTextTooltip")}),children:Object(te.jsx)(Ht,{disabled:s,inputComponent:ri.a,minHeight:70,onChange:i,value:n})})})}}render(){const{editField:e,field:t,readOnly:s,isV1:i}=this.props,n=Object(te.jsx)(go,{counter:"down",max:300,onChange:this.onHelpTextChange,value:t.help_text,renderInput:({count:e,onChange:t,value:i})=>{const n=e<0;return Object(te.jsx)(Zt.a,{characterCount:e,"data-test-id":"module-field-editor-tooltip-help",error:n,label:Object(te.jsx)(u.a,{message:bo("helpTextLabel")}),tooltip:Object(te.jsx)(u.a,{message:bo("helpTextTooltip")}),validationMessage:n&&Object(te.jsx)(u.a,{message:bo("helpTextLengthWarning")}),children:Object(te.jsx)(Ht,{disabled:s,inputComponent:ri.a,minHeight:70,onChange:t,value:i})})}});return i?Object(te.jsx)(_t.a,{children:n}):Object(te.jsxs)(_t.a,{children:[this.renderRequiredToggle(),this.renderLockedToggle(),this.renderExpandedToggle(),n,this.renderInlineHelpTextInput(),Object(te.jsx)(ho,{editField:e,field:t})]})}}mo.propTypes={editField:l.a.func.isRequired,field:l.a.instanceOf(gt.a).isRequired,fieldErrors:l.a.object,isGlobal:l.a.bool,readOnly:l.a.bool,isV1:l.a.bool.isRequired};var jo=s(173),Oo=s(97),fo=s(1209),Co=s(495);const yo=e=>"DesignEditorsUI.customWidgetEditor.sidebar.fieldEdit.contentOptions."+e;class xo extends i.Component{constructor(...e){super(...e);this.state={invalidRegex:!1};this.onDefaultChange=e=>{this.props.editField({[Ut.f]:e})};this.onPlaceholderChange=e=>{this.props.editField({[Ut.w]:e.target.value})};this.onValidationRegexChange=e=>{this.props.editField({[Ut.U]:e.target.value})};this.onValidationErrorMessageChange=e=>{this.props.editField({[Ut.T]:e.target.value})};this.onShowEmojiPickerChange=({target:{checked:e}})=>{this.props.editField({[Ut.H]:e})};this.renderValidationRegexTooltip=()=>Object(te.jsxs)("span",{children:[Object(te.jsx)(u.a,{message:yo("text.regex.helpText")}),Object(te.jsx)(w.a,{className:"m-left-2",href:"https://www.w3schools.com/jsref/jsref_obj_regexp.asp",target:"_blank",children:Object(te.jsx)(u.a,{message:yo("text.regex.learnMore")})})]})}render(){const{field:e,fieldErrors:t,readOnly:s,isV1:i}=this.props,n=Object(te.jsx)(os,{errors:t[Ut.f],label:Object(te.jsx)(u.a,{message:yo("defaultLabels."+Gi.TEXT)}),children:Object(te.jsx)(Ht,{inputComponent:fo.a,onFieldChange:this.onDefaultChange,value:e[Ut.f],readOnly:s,placeholder:e[Ut.w],show_emoji_picker:e[Ut.H],allow_new_line:e[Ut.b]})});if(i)return Object(te.jsx)("div",{className:"text-content-options",children:Object(te.jsx)(_t.a,{children:n})});const a=t.validation_regex?Object(te.jsx)(u.a,{message:yo("text.regex.invalidRegex")}):null;return Object(te.jsx)("div",{className:"text-content-options",children:Object(te.jsxs)(_t.a,{children:[n,Object(te.jsx)(es.a,{label:Object(te.jsx)(u.a,{message:yo("text.placeholderLabel")}),children:Object(te.jsx)(Mt.a,{"data-test-id":"module-text-field-placeholder-input",onChange:this.onPlaceholderChange,value:e[Ut.w],disabled:s||i})}),Object(te.jsx)(es.a,{error:t.validation_regex,label:Object(te.jsx)(u.a,{message:yo("text.regex.label")}),tooltip:this.renderValidationRegexTooltip(),tooltipPlacement:"top left",validationMessage:a,children:Object(te.jsx)(Co.a,{text:"/",position:"start",children:Object(te.jsx)(Co.a,{text:"/",position:"end",children:Object(te.jsx)(Mt.a,{className:"validation-regex-input","data-test-id":"module-text-field-regex-input",onChange:this.onValidationRegexChange,placeholder:Object(h.a)(yo("text.regex.placeholder")),value:e[Ut.U],disabled:s||i})})})}),Object(te.jsx)(es.a,{label:Object(te.jsx)(u.a,{message:yo("text.validationErrorMessage.label")}),tooltip:Object(te.jsx)(u.a,{message:yo("text.validationErrorMessage.tooltip")}),children:Object(te.jsx)(Mt.a,{disabled:s||i,onChange:this.onValidationErrorMessageChange,value:e[Ut.T]})}),Object(te.jsx)(es.a,{label:Object(te.jsx)(u.a,{message:yo("text.emoji.label")}),children:Object(te.jsx)(La.a,{"data-test-id":"module-text-field-emoji-picker",size:"extra-small",onChange:this.onShowEmojiPickerChange,checked:e[Ut.H],disabled:s||i})})]})})}}xo.propTypes={editField:l.a.func.isRequired,field:l.a.instanceOf(gt.a).isRequired,fieldErrors:l.a.object,readOnly:l.a.bool,isV1:l.a.bool.isRequired};xo.defaultProps={fieldErrors:{}};var To=s(1335);const Eo=e=>"DesignEditorsUI.customWidgetEditor.sidebar.fieldEdit.contentOptions."+e,Ro=(e,t)=>({modulePath:Object(L.makeGetModulePath)()(e,t)});class Io extends i.PureComponent{constructor(...e){super(...e);this.onDefaultChange=e=>{this.props.editField({[Ut.f]:e})}}render(){const{field:e,fieldErrors:t,modulePath:s,readOnly:i}=this.props;return Object(te.jsx)(os,{errors:t[Ut.f],label:ue.a.text(Eo("defaultLabels."+Gi.RICH_TEXT)),children:Object(te.jsx)(Ht,{enabled_features:e[Ut.k],id:e.id,inputComponent:To.a,modulePath:s,onFieldChange:this.onDefaultChange,readOnly:i,shouldFetchCustomFonts:!0,value:e[Ut.f]})})}}Io.propTypes={editField:l.a.func.isRequired,field:l.a.instanceOf(gt.a).isRequired,fieldErrors:l.a.object,modulePath:l.a.string.isRequired,readOnly:l.a.bool};Io.defaultProps={fieldErrors:{}};var vo=Object(o.connect)(Ro)(Io),Wo=s(1149),Fo=s(1147),So=s(176);const Lo=e=>"DesignEditorsUI.customWidgetEditor.sidebar.fieldEdit.contentOptions."+e;class qo extends i.Component{constructor(...e){super(...e);this.onDefaultChange=e=>{this.props.editField({[Ut.f]:e})};this.onDisplayChange=e=>{this.props.editField({[Ut.g]:e.target.name})}}renderDisplayOptions(){const{field:e}=this.props,t=Object.values(So.a[Gi.BOOLEAN]).map(t=>{const s=e[Ut.g]===t;return Object(te.jsx)(Wo.a,{checked:s,inline:!0,name:t,onChange:this.onDisplayChange,size:"small",className:"content-options-radio-input",children:Object(h.a)(Lo("display.displayTypeLabels."+t))},t)});return Object(te.jsx)(es.a,{label:Object(te.jsx)(u.a,{message:Lo("display.label")}),children:Object(te.jsx)(i.Fragment,{children:t})})}render(){const{field:e,readOnly:t}=this.props;return Object(te.jsxs)(i.Fragment,{children:[this.renderDisplayOptions(),Object(te.jsx)(es.a,{label:Object(te.jsx)(u.a,{message:Lo(Gi.BOOLEAN+".label")}),children:Object(te.jsx)(Ht,{className:"dm-boolean-field",display:e[Ut.g],inputComponent:Fo.a,label:Object(h.a)(Lo("defaultLabels."+Gi.BOOLEAN)),onFieldChange:this.onDefaultChange,readOnly:t,value:e[Ut.f]})})]})}}qo.propTypes={editField:l.a.func.isRequired,field:l.a.instanceOf(gt.a).isRequired,readOnly:l.a.bool};var Do=s(67),Po=s(2664),Ao=s(96),No=s(340);class ko extends i.Component{render(){const{children:e,className:t,name:s,onClick:i,readOnly:n}=this.props;return Object(te.jsxs)(k.a,{className:t,disabled:n,onClick:i,use:"link",children:[Object(te.jsx)(Qs.a,{color:Di.CALYPSO_DARK,name:s}),e]})}}ko.propTypes={children:l.a.node,className:l.a.string,name:Object(No.a)().isRequired,onClick:l.a.func,readOnly:l.a.bool};ko.defaultProps={children:null,className:null,onClick:pe.a};var wo=s(297),Go=s(334),Mo=s(710),_o=s(478);const Uo=["children","className","closeable","CloseButton","closeButtonProps","closeButtonTooltip","connectDragPreview","connectDragSource","connectDropTarget","draggable","DragHandle","onClose"],Bo=(e,t,s)=>{const i=Object(te.jsx)("span",{className:"private-movable-group__grippie"}),n=Object(wo.a)(e,i)||i;return Object(te.jsx)(t,{size:"small"===s.size?"small":void 0,children:n})};class Ho extends i.Component{render(){const e=this.props,{children:t,className:s,closeable:i,CloseButton:n,closeButtonProps:a,closeButtonTooltip:o,connectDragPreview:r,connectDragSource:d,connectDropTarget:l,draggable:c,DragHandle:p,onClose:u}=e,h=Object(Et.a)(e,Uo);return Object(te.jsx)(_o.c,{children:e=>{const g=Object(te.jsxs)("div",Object.assign({},h,{className:ge()("private-moveable-group",s),children:[c&&Bo(d,p,e),Object(te.jsx)("div",{className:"private-moveable-group__inner has--horizontal-spacing",children:t}),i&&Object(te.jsx)(Bs.a,{title:o,children:Object(te.jsx)(n,Object.assign({className:"private-moveable-group__close",onClick:u,use:"transparent"},a,{children:Object(te.jsx)(Qs.a,{name:"delete"})}))})]})),b=Object(wo.a)(r,g)||g;return Object(wo.a)(l,b)||b}})}}Ho.propTypes={children:l.a.node,closeable:l.a.bool.isRequired,CloseButton:l.a.elementType.isRequired,closeButtonProps:l.a.object,closeButtonTooltip:Bs.a.propTypes.title,draggable:l.a.bool.isRequired,DragHandle:Object(Go.a)(wi.a).isRequired,onClose:l.a.func,connectDragSource:l.a.func,connectDropTarget:l.a.func,connectDragPreview:l.a.func};Ho.defaultProps={closeable:!1,CloseButton:Mo.a,draggable:!0,DragHandle:wi.a};Ho.displayName="UIMoveableGroup";const Vo=e=>"DesignEditorsUI.customWidgetEditor.sidebar.fieldEdit.contentOptions.choice."+e;let zo=null;const Ko=Object(en.DragSource)(nn.CUSTOM_WIDGET_CHOICE_FIELD_OPTION,{beginDrag(e){zo=e.index;return{index:e.index}},isDragging:e=>e.index===zo},(e,t)=>({connectDragSource:e.dragSource(),connectDragPreview:e.dragPreview(),isDragging:t.isDragging()})),Jo=Object(en.DropTarget)(nn.CUSTOM_WIDGET_CHOICE_FIELD_OPTION,{hover:Object(p.throttle)((e,t)=>{zo=e.index;const s=t.getItem();if(s&&e.index!==s.index){e.onMove(s.index,e.index);t.getItem().index=e.index}},250)},e=>({connectDropTarget:e.dropTarget()})),Xo=Object(i.forwardRef)((e,t)=>{const{value:s,label:i,deletable:n,duplicateError:a,onDelete:o,onLabelChange:r,onValueChange:d,connectDropTarget:l,connectDragSource:c,connectDragPreview:p,isDragging:u,onLabelBlur:h,readOnly:g}=e,b=a?[a]:[],m="choice-option"+(u?" is--dragging":"");return Object(te.jsxs)(Ho,{className:m,closeable:n,connectDragPreview:p,connectDragSource:c,connectDropTarget:l,draggable:!g,onClose:o,ref:t,children:[Object(te.jsx)(Zt.a,{"aria-label":"label",children:Object(te.jsx)(Ht,{className:"choice-label-input",onChange:r,placeholder:ue.a.text(Vo("placeholders.label")),value:i,onBlur:h,disabled:g})}),Object(te.jsx)(os,{"aria-label":"value",errors:b,children:Object(te.jsx)(Ht,{className:"is--code",onChange:d,placeholder:ue.a.text(Vo("placeholders.value")),value:s,disabled:g})})]})});Xo.propTypes={connectDragSource:l.a.func.isRequired,connectDropTarget:l.a.func.isRequired,connectDragPreview:l.a.func.isRequired,deletable:l.a.bool,duplicateError:l.a.object,isDragging:l.a.bool.isRequired,label:l.a.string,onDelete:l.a.func.isRequired,onLabelChange:l.a.func.isRequired,onValueChange:l.a.func.isRequired,value:l.a.string,onLabelBlur:l.a.func.isRequired,readOnly:l.a.bool};Xo.defaultProps={closeable:null,duplicateError:null,label:"",value:""};var $o=Object(P.compose)(Ko,Jo)(Xo);const Yo=e=>"DesignEditorsUI.customWidgetEditor.sidebar.fieldEdit.contentOptions."+e;function Qo(e){return Object(Do.c)(e)?"":e.asMutable?e.asMutable():e}class Zo extends i.Component{constructor(...e){super(...e);this.state={newChoiceAdded:!1};this.setChoiceContainerRef=e=>{this._choiceContainer=e};this.focusLastChoice=()=>{const e=Object(tn.findDOMNode)(this._choiceContainer).children;e&&e[e.length-1].querySelector(".choice-label-input").focus()};this.onDefaultChange=e=>{this.props.editField({default:e})};this.onDeleteChoice=e=>{const{field:t,editField:s}=this.props,{choices:i}=t;if(!i[e]||1===i.length)return;const n=i[e][0],a=i.slice(0,e).concat(i.slice(e+1));let o=t[Ut.f]===n?a[0][0]:t[Ut.f];t[Ut.s]&&Array.isArray(t[Ut.f])&&t[Ut.f].length&&(o=t[Ut.f].filter(e=>e!==n));s({[Ut.d]:a,[Ut.f]:o})};this.onChoiceLabelChange=(e,t)=>{const{field:s,editField:i}=this.props,{newChoiceAdded:n}=this.state;i({choices:s.choices.map((s,i)=>{if(i===e){const e=ue.a.SafeString(t.target.value).string;return[n?Object(Kt.g)(e):s[0],e]}return s})})};this.onChoiceLabelBlur=()=>{this.setState({newChoiceAdded:!1})};this.onChoiceValueChange=(e,t)=>{const{field:s,editField:i}=this.props,{choices:n}=s,a=t.target.value,o=n[e][0]===s.default;let r=s[Ut.f];const d=[...n];d[e]=[a,n[e][1]];s[Ut.s]&&Array.isArray(s[Ut.f])&&s[Ut.f].length&&(r=s[Ut.f].map(t=>t===n[e][0]?a:t));o&&(r=a);i({[Ut.d]:d,[Ut.f]:r})};this.onAddChoice=()=>{const{field:{choices:e},editField:t}=this.props;t({[Ut.d]:e.concat([["",""]])});this.setState({newChoiceAdded:!0})};this.onMoveChoice=(e,t,s=!1)=>{const{field:{choices:i},editField:n}=this.props,a=i[e];let o=i.slice(0,e).concat(i.slice(e+1));o=o.slice(0,t).concat([a],o.slice(t));n({[Ut.d]:o},s)};this.onPlaceholderChange=e=>{this.props.editField({[Ut.w]:e.target.value})};this.onMultipleChange=e=>{const{editField:t,field:s}=this.props,i=e.target.checked,n={[Ut.s]:i};i&&s[Ut.A]&&s[Ut.g]!==So.a[Gi.CHOICE].SELECT?n[Ut.g]=So.a[Gi.CHOICE].SELECT:i&&s[Ut.g]===So.a[Gi.CHOICE].RADIO?n[Ut.g]=So.a[Gi.CHOICE].CHECKBOX:i||s[Ut.g]!==So.a[Gi.CHOICE].CHECKBOX||(n[Ut.g]=So.a[Gi.CHOICE].RADIO);i&&!Array.isArray(s[Ut.f])?n[Ut.f]=Object(Do.c)(s[Ut.f])||""===s[Ut.f]?[]:[s[Ut.f]]:!i&&Array.isArray(s[Ut.f])&&(n[Ut.f]=void 0===s[Ut.f][0]?"":s[Ut.f][0]);t(n)};this.onReorderingChange=e=>{const{editField:t,field:s}=this.props,i=e.target.checked,n={[Ut.A]:i};i&&s[Ut.g]===So.a[Gi.CHOICE].CHECKBOX&&(n[Ut.g]=So.a[Gi.CHOICE].SELECT);t(n)};this.onDisplayChange=e=>{this.props.editField({[Ut.g]:e.target.name})};this.getChoiceValueDuplicates=()=>(this.props.fieldErrors[Ut.d]||[]).reduce((e,t)=>{const{type:s,data:i}=t;return s===Ao.MODULE_VALIDATION_CHOICE_DUP_VALUE?Object.assign({},e,{[i.value]:t}):e},{});this.getNonDuplicateErrors=()=>(this.props.fieldErrors[Ut.d]||[]).filter(({type:e})=>e!==Ao.MODULE_VALIDATION_CHOICE_DUP_VALUE)}componentDidUpdate(){this.state.newChoiceAdded&&this.focusLastChoice()}renderChoices(){const{field:{choices:e},readOnly:t}=this.props,s=this.getChoiceValueDuplicates(),i=e.length>2&&!t;return e.map((e,n)=>{const[a,o]=e,r=s[a];return Object(te.jsx)($o,{deletable:i,duplicateError:r,index:n,label:o,onDelete:(...e)=>this.onDeleteChoice(n,...e),onLabelChange:(...e)=>this.onChoiceLabelChange(n,...e),onMove:this.onMoveChoice,onValueChange:(...e)=>this.onChoiceValueChange(n,...e),value:a,onLabelBlur:this.onChoiceLabelBlur,readOnly:t},n)})}renderMultipleToggle(){const{field:e,readOnly:t}=this.props;return Object(te.jsx)(lo.a,{checked:e[Ut.s],className:"p-y-8",onChange:this.onMultipleChange,readOnly:t,size:"small",children:Object(te.jsx)(u.a,{message:Yo("choice.labels.allowMultiple")})})}renderReorderingToggle(){const{field:e,readOnly:t}=this.props;return e[Ut.s]?Object(te.jsx)(lo.a,{checked:e[Ut.A],className:"p-bottom-6",onChange:this.onReorderingChange,readOnly:t,size:"small",children:Object(te.jsx)(u.a,{message:Yo("choice.labels.allowReordering")})}):null}renderDisplayOptions(){const{field:e}=this.props,t=e[Ut.s],s=Object.values(So.a[Gi.CHOICE]).map(s=>{const i=e[Ut.g]===s;let n;s===So.a[Gi.CHOICE].RADIO&&t&&(n=!0);s!==So.a[Gi.CHOICE].CHECKBOX||t&&!e[Ut.A]||(n=!0);return s===So.a[Gi.CHOICE].BUTTONS?null:Object(te.jsx)(Wo.a,{checked:i,className:"content-options-radio-input",disabled:n,inline:!0,name:s,onChange:this.onDisplayChange,size:"small",children:Object(h.a)(Yo("display.displayTypeLabels."+s))},s)});return Object(te.jsx)(es.a,{label:Object(te.jsx)(u.a,{message:Yo("display.label")}),children:Object(te.jsx)(i.Fragment,{children:s})})}render(){const e=this.getNonDuplicateErrors(),{field:t,isV1:s,readOnly:i}=this.props,n=Object(te.jsxs)(D.a,{children:[Object(te.jsx)("span",{className:"m-right-1",children:Object(te.jsx)(u.a,{message:Yo("choice.labels.choices")})}),Object(te.jsx)(Ai.a,{title:Object(te.jsx)(Pt.a,{children:Object(te.jsx)(u.a,{message:Yo("choice.htmlUsageTooltip")})}),color:Di.BATTLESHIP,tooltipPlacement:"top"})]}),a=Object(te.jsxs)(D.a,{children:[Object(te.jsx)("span",{className:"m-right-1",children:Object(te.jsx)(u.a,{message:Yo("choice.labels.placeholder")})}),Object(te.jsx)(Ai.a,{title:Object(te.jsx)(Pt.a,{children:Object(te.jsx)(u.a,{message:Yo("choice.placeholderTooltip")})}),color:Di.BATTLESHIP,tooltipProps:{placement:"top"}})]}),o=!s&&Object(te.jsx)(es.a,{label:a,children:Object(te.jsx)(Mt.a,{onChange:this.onPlaceholderChange,value:t[Ut.w],disabled:i})});return Object(te.jsx)("div",{className:"choice-content-options",children:Object(te.jsxs)(_t.a,{children:[Object(te.jsx)(es.a,{label:Object(h.a)(Yo("choice.labels.default")),children:Object(te.jsx)(Po.a,{choices:t[Ut.d],display:t[Ut.g],multiple:t[Ut.s],onFieldChange:this.onDefaultChange,placeholder:t[Ut.w],preset:t[Ut.y],readOnly:i,reordering_enabled:t[Ut.A],required:!1,value:Qo(t[Ut.f])})}),this.renderMultipleToggle(),this.renderReorderingToggle(),this.renderDisplayOptions(),Object(te.jsx)(os,{errors:e,label:n,children:Object(te.jsxs)("div",{children:[Object(te.jsx)("div",{ref:this.setChoiceContainerRef,children:this.renderChoices()}),Object(te.jsx)(ko,{className:"m-top-3",name:"add",onClick:this.onAddChoice,readOnly:i,children:Object(te.jsx)("span",{className:"m-left-1",children:Object(te.jsx)(u.a,{message:Yo("choice.addChoice")})})})]})}),o]})})}}Zo.propTypes={editField:l.a.func.isRequired,field:l.a.instanceOf(gt.a).isRequired,fieldErrors:l.a.object,isV1:l.a.bool.isRequired,readOnly:l.a.bool};Zo.defaultProps={fieldErrors:{}};var er=Zo,tr=s(512),sr=s(2788);const ir=e=>"DesignEditorsUI.customWidgetEditor.sidebar.fieldEdit.contentOptions."+e;function nr(e){return null===e?void 0:e}class ar extends i.Component{constructor(...e){super(...e);this.onDefaultChange=e=>{this.props.editField({[Ut.f]:e})};this.onAttributeChange=(e,t)=>{const s=t.target.value;this.props.editField({[e]:s})};this.onDisplayChange=e=>{this.props.editField({[Ut.g]:e.target.name})}}renderDisplayOptions(){const{field:e}=this.props,t=Object.values(So.a[Gi.NUMBER]).map(t=>{const s=e[Ut.g]===t;return Object(te.jsx)(Wo.a,{checked:s,inline:!0,name:t,onChange:this.onDisplayChange,size:"small",className:"content-options-radio-input",children:Object(h.a)(ir("display.displayTypeLabels."+t))},t)});return Object(te.jsx)(es.a,{label:Object(te.jsx)(u.a,{message:ir("display.label")}),children:Object(te.jsx)(i.Fragment,{children:t})})}render(){const{field:e,fieldErrors:t,readOnly:s}=this.props;return Object(te.jsx)("div",{children:Object(te.jsxs)(_t.a,{children:[Object(te.jsx)(wt.a,{flush:!0,children:Object(te.jsxs)(D.a,{children:[Object(te.jsx)(es.a,{className:"m-right-2",label:Object(te.jsx)(u.a,{message:ir("number.prefix.label")}),tooltip:Object(te.jsx)(u.a,{message:ir("number.prefix.tooltip")}),children:Object(te.jsx)(Ht,{inputComponent:Mt.a,onChange:(...e)=>this.onAttributeChange(Ut.x,...e),value:e[Ut.x]||"",readOnly:s})}),Object(te.jsx)(es.a,{className:"m-top-0",label:Object(te.jsx)(u.a,{message:ir("number.suffix.label")}),tooltip:Object(te.jsx)(u.a,{message:ir("number.suffix.tooltip")}),children:Object(te.jsx)(Ht,{inputComponent:Mt.a,onChange:(...e)=>this.onAttributeChange(Ut.M,...e),value:e[Ut.M]||"",readOnly:s})})]})}),Object(te.jsx)(wt.a,{flush:!0,children:Object(te.jsxs)(D.a,{children:[Object(te.jsx)(os,{className:"m-right-2",errors:t[Ut.r],label:Object(te.jsx)(u.a,{message:ir("number.min")}),children:Object(te.jsx)(Ht,{inputComponent:tr.a,onChange:(...e)=>this.onAttributeChange(Ut.r,...e),value:e[Ut.r],readOnly:s})}),Object(te.jsx)(es.a,{className:"m-top-0",label:Object(te.jsx)(u.a,{message:ir("number.max")}),children:Object(te.jsx)(Ht,{inputComponent:tr.a,onChange:(...e)=>this.onAttributeChange(Ut.q,...e),value:e[Ut.q],readOnly:s})})]})}),Object(te.jsx)(wt.a,{flush:!0,children:Object(te.jsx)(es.a,{className:"m-top-0",label:Object(te.jsx)(u.a,{message:ir("number.step")}),children:Object(te.jsx)(Ht,{inputComponent:tr.a,onChange:(...e)=>this.onAttributeChange(Ut.L,...e),value:e[Ut.L],readOnly:s})})}),Object(te.jsxs)(wt.a,{flush:!0,children:[this.renderDisplayOptions(),Object(te.jsx)(os,{errors:t[Ut.f],label:Object(te.jsx)(u.a,{message:ir("defaultLabels."+Gi.NUMBER)}),children:Object(te.jsx)(Ht,{display:e[Ut.g],inputComponent:sr.a,onFieldChange:this.onDefaultChange,max:nr(e[Ut.q]),min:nr(e[Ut.r]),prefix:e[Ut.x],readOnly:s,step:nr(e[Ut.L]),suffix:e[Ut.M],value:e[Ut.f]},`${e[Ut.x]}-${e[Ut.M]}`)})]})]})})}}ar.propTypes={editField:l.a.func.isRequired,field:l.a.instanceOf(gt.a).isRequired,fieldErrors:l.a.object,readOnly:l.a.bool};ar.defaultProps={fieldErrors:{}};var or=s(2697);const rr=e=>"DesignEditorsUI.customWidgetEditor.sidebar.fieldEdit.contentOptions."+e;class dr extends i.Component{constructor(...e){super(...e);this.onDefaultChange=e=>{this.props.editField({[Ut.f]:e})}}render(){const{field:e,readOnly:t}=this.props;return Object(te.jsx)(es.a,{label:ue.a.text(rr("defaultLabels."+Gi.DATE)),children:Object(te.jsx)(Ht,{inputComponent:or.a,onFieldChange:this.onDefaultChange,type:e.type,value:e[Ut.f],readOnly:t})})}}dr.propTypes={editField:l.a.func.isRequired,field:l.a.instanceOf(gt.a).isRequired,readOnly:l.a.bool};var lr=s(513);const cr=e=>"DesignEditorsUI.customWidgetEditor.sidebar.fieldEdit.contentOptions."+e;class pr extends i.PureComponent{constructor(...e){super(...e);this.onStepChange=e=>{const t=e.target.value;!isNaN(t)&&t>0&&this.props.editField({[Ut.L]:t})};this.onDefaultChange=e=>{this.props.editField({[Ut.f]:e})}}render(){const{field:e,readOnly:t}=this.props;return Object(te.jsxs)("div",{children:[Object(te.jsx)(es.a,{label:ue.a.text(cr("defaultLabels."+Gi.DATE_TIME)),children:Object(te.jsx)(Ht,{inputComponent:or.a,onFieldChange:this.onDefaultChange,step:e[Ut.L],type:e.type,value:e[Ut.f],readOnly:t})}),Object(te.jsx)(es.a,{label:ue.a.text(cr("datetime.step")),tooltip:ue.a.text(cr("datetime.stepTooltip")),tooltipPlacement:"left",children:Object(te.jsx)(Co.a,{position:"end",text:ue.a.text(cr("datetime.minutes")),children:Object(te.jsx)(Ht,{inputComponent:lr.a,onChange:this.onStepChange,value:e[Ut.L],disabled:t})})})]})}}pr.propTypes={editField:l.a.func.isRequired,field:l.a.instanceOf(gt.a).isRequired,readOnly:l.a.bool};var ur=s(1179);const hr=100,gr=e=>"DesignEditorsUI.customWidgetEditor.sidebar.fieldEdit.contentOptions."+e;class br extends i.Component{constructor(...e){super(...e);this.onDefaultChange=e=>{this.props.editField({[Ut.f]:e})};this.onShowOpacityChange=e=>{const{field:t,editField:s}=this.props,i=e.target.checked,n={[Ut.J]:i};i||(n[Ut.f]=this.resetColorOpacity(t));s(n)};this.onOverrideOpacityChange=e=>{const{field:t,isEmailOrAnyType:s,editField:i}=this.props,n=e.target.checked,a={[Ut.J]:n?!s:void 0};s&&(a[Ut.f]=this.resetColorOpacity(t));i(a)}}resetColorOpacity(e){return Object.assign({},e.default,{opacity:hr})}renderShowOpacityToggle(){const{field:e,readOnly:t}=this.props,s=void 0!==e[Ut.J];return Object(te.jsxs)("div",{className:"m-top-3",children:[Object(te.jsx)(lo.a,{checked:s,description:Object(te.jsx)(Ai.a,{title:Object(te.jsx)(u.a,{message:gr("color.overrideOpacityHelp")})}),descriptionLayout:"horizontal",onChange:this.onOverrideOpacityChange,children:Object(te.jsx)(u.a,{message:gr("color.overrideOpacity")})}),s&&Object(te.jsxs)("div",{className:"m-top-3",children:[Object(te.jsx)(Vs.a,{className:"p-right-4 p-top-1",children:Object(te.jsx)(u.a,{message:gr("color.showOpacity")})}),Object(te.jsx)(Ht,{checked:e[Ut.J],disabled:t,inputComponent:La.a,onChange:this.onShowOpacityChange,required:!0,size:"extra-small"})]})]})}render(){const{field:e,fieldErrors:t,readOnly:s,isEmailOrAnyType:i}=this.props;return Object(te.jsx)("div",{className:"custom-widget-editor-color-picker",children:Object(te.jsxs)(_t.a,{children:[Object(te.jsx)(os,{errors:t[Ut.f],label:Object(h.a)(gr("defaultLabels."+Gi.COLOR)),children:Object(te.jsx)(ur.a,{onFieldChange:this.onDefaultChange,value:e[Ut.f],readOnly:s,isEmailOrAnyType:i,show_opacity:e[Ut.J]})}),this.renderShowOpacityToggle()]})})}}br.propTypes={editField:l.a.func.isRequired,field:l.a.instanceOf(gt.a).isRequired,fieldErrors:l.a.object,readOnly:l.a.bool,isEmailOrAnyType:l.a.bool};function mr(){const e=Object(L.makeGetIsEmailOrAnyType)();return(t,s)=>({isEmailOrAnyType:e(t,s)})}var jr=Object(o.connect)(mr,null)(br),Or=s(2787);const fr=e=>"DesignEditorsUI.customWidgetEditor.sidebar.fieldEdit.contentOptions."+e;class Cr extends i.PureComponent{constructor(...e){super(...e);this.onFieldChange=e=>{this.props.editField({[Ut.f]:e})}}render(){const{field:e,readOnly:t}=this.props;return Object(te.jsx)(Ht,{onFieldChange:this.onFieldChange,value:e[Ut.f],label:Object(h.a)(fr("defaultLabels."+Gi.CTA)),inputComponent:Or.a,readOnly:t})}}Cr.propTypes={editField:l.a.func.isRequired,field:l.a.instanceOf(gt.a).isRequired,readOnly:l.a.bool};var yr=s(1314),xr=s(239),Tr=s(457),Er=s(35);const Rr=e=>"DesignEditorsUI.customWidgetEditor.sidebar.fieldEdit.contentOptions."+e,Ir=Object.keys(Er.b).filter(e=>e!==Er.b["fontawesome-5"]).map(e=>({text:e,value:e}));class vr extends i.PureComponent{constructor(e){super(e);this.onDefaultChange=e=>{this.props.editField({[Ut.f]:e})};this.onSetChange=({target:{value:e}})=>{this.props.editField({[Ut.n]:e})};this.onIconSetWarningClose=()=>{this.setState({showIconSetWarning:!1});this.props.dismissIconSetWarning()};const t=e.field&&e.field[Ut.n];this.state={showIconSetWarning:t!==Er.a}}componentDidUpdate(e){const{field:t}=this.props,{field:s}=e,i=t&&t[Ut.n];(s&&s[Ut.n])!==i&&this.setState({showIconSetWarning:i!==Er.a})}render(){const{field:e,hasDismissedIconSetWarning:t,readOnly:s}=this.props;let i=e[Ut.n]||Er.a;i===Er.b["fontawesome-5"]&&(i=Er.b["fontawesome-5.0.10"]);const n=this.state.showIconSetWarning&&!t;return Object(te.jsxs)(_t.a,{children:[Object(te.jsx)(yr.a,{icon_set:i,label:Object(te.jsx)(u.a,{message:Rr("defaultLabels."+Gi.ICON)}),onFieldChange:this.onDefaultChange,value:e[Ut.f],readOnly:s}),Object(te.jsx)(es.a,{label:Object(te.jsx)(u.a,{message:Rr("icon.set.label")}),tooltip:Object(te.jsx)(A.a,{message:Rr("icon.set.tooltip"),options:{changelogLink:Object(te.jsx)(w.a,{external:!0,href:"https://fontawesome.com/changelog/latest",children:Object(te.jsx)(u.a,{message:Rr("icon.set.changelogLink")})})}}),children:Object(te.jsx)(Os.a,{onChange:this.onSetChange,options:Ir,value:i})}),n&&Object(te.jsx)(N.a,{className:"m-top-2",type:"warning",closeable:!0,onClose:this.onIconSetWarningClose,children:Object(te.jsx)(A.a,{message:Rr("icon.iconSetWarning"),options:{iconSetProperty:Object(te.jsx)("code",{children:"icon_set"})}})})]})}}vr.propTypes={dismissIconSetWarning:l.a.func.isRequired,editField:l.a.func.isRequired,field:l.a.instanceOf(gt.a).isRequired,hasDismissedIconSetWarning:l.a.bool.isRequired,readOnly:l.a.bool};function Wr(e){return{hasDismissedIconSetWarning:Object(xr.m)(e)}}const Fr={dismissIconSetWarning:Tr.d};var Sr=Object(o.connect)(Wr,Fr)(vr),Lr=s(1208),qr=s(186);const Dr=e=>"DesignEditorsUI.customWidgetEditor.sidebar.fieldEdit.contentOptions."+e,Pr={ALL:"ALL",EXACT_ONLY:"EXACT_ONLY",NONE:"NONE"},Ar={ALL:"ALL",NONE:"NONE"},Nr=Object.keys(Pr).map(e=>({text:Object(h.a)(Dr("image.sizeControlType.options."+e)),value:e})),kr=Object.keys(Ar).map(e=>({text:Object(h.a)(Dr("image.showLoadingType.options."+e)),value:e}));class wr extends i.Component{constructor(e){super(e);this.onDefaultChange=e=>{this.props.editField({[Ut.f]:e})};this.onResizableChange=e=>{this.props.editField({[Ut.D]:!e.target.checked})};this.onShowLoadingChange=e=>{const t=e.target.value,s={[Ut.I]:t===Ar.ALL},i=t===Ar.ALL&&this.loadingControlType===Ar.NONE;this.props.editField(s);this.setState({showImageLoadingWarning:i})};this.onSizeControlTypeChange=e=>{let t={},s=!1;switch(e.target.value){case Pr.ALL:t={[Ut.D]:!0,[Ut.E]:!0};this.sizeControlType===Pr.EXACT_ONLY&&(s=!0);break;case Pr.EXACT_ONLY:t={[Ut.D]:!0,[Ut.E]:!1,[Ut.f]:Object.assign({},this.props.field[Ut.f],{size_type:qr.a.EXACT})};break;case Pr.NONE:t={[Ut.D]:!1}}this.setState({showResponsiveImageWarning:s});this.props.editField(t)};this.onResponsiveImageWarningClose=()=>{this.setState({showResponsiveImageWarning:!1});this.props.dismissResponsiveImageWarning()};this.onLoadingWarningClose=()=>{this.setState({showImageLoadingWarning:!1});this.props.dismissShowLoadingWarning()};this.state={showResponsiveImageWarning:!1,showImageLoadingWarning:!1}}get sizeControlType(){return this.props.field[Ut.D]?this.props.field[Ut.E]?Pr.ALL:Pr.EXACT_ONLY:Pr.NONE}get loadingControlType(){return this.props.field[Ut.I]?Ar.ALL:Ar.NONE}renderShowLoading(){const e=!this.props.hasDismissedShowLoadingWarning&&this.state.showImageLoadingWarning;return Object(te.jsxs)("div",{children:[Object(te.jsx)(es.a,{className:"m-top-4",label:Object(te.jsx)(u.a,{message:Dr("image.showLoadingType.label")}),tooltip:Object(te.jsx)(u.a,{message:Dr("image.showLoadingType.tooltip")}),children:Object(te.jsx)(Os.a,{"data-test-id":"module-image-field-size-dropdown",disabled:this.props.readOnly,options:kr,onChange:this.onShowLoadingChange,required:!0,value:this.loadingControlType})}),e&&Object(te.jsx)(N.a,{className:"m-top-2",type:"warning",closeable:!0,onClose:this.onLoadingWarningClose,children:Object(te.jsx)(A.a,{message:Dr("image.showLoadingType.loadingControlWarning"),options:{loadingProperty:Object(te.jsx)("code",{children:"loading"})}})})]})}renderResponsiveSizeControl(){const e=!this.props.hasDismissedResponsiveImageWarning&&this.state.showResponsiveImageWarning,t=Object(te.jsx)("code",{children:"size_type"});return Object(te.jsxs)("div",{children:[Object(te.jsx)(es.a,{className:"m-top-4",label:Object(te.jsx)(u.a,{message:Dr("image.sizeControlType.label")}),tooltip:Object(te.jsx)(u.a,{message:Dr("image.sizeControlType.tooltip")}),children:Object(te.jsx)(Os.a,{"data-test-id":"module-image-field-size-dropdown",disabled:this.props.readOnly,options:Nr,onChange:this.onSizeControlTypeChange,required:!0,value:this.sizeControlType})}),e&&Object(te.jsx)(N.a,{className:"m-top-2",type:"warning",closeable:!0,onClose:this.onResponsiveImageWarningClose,children:Object(te.jsx)(A.a,{message:Dr("image.sizeControlType.responsiveImageWarning"),options:{sizeTypeProperty:t}})})]})}render(){const{field:e,readOnly:t,isV1:s,isEmail:i}=this.props;return Object(te.jsxs)(_t.a,{children:[Object(te.jsx)(es.a,{children:Object(te.jsx)(Lr.a,{label:Object(h.a)(Dr("defaultLabels."+Gi.IMAGE)),onFieldChange:this.onDefaultChange,value:e[Ut.f],readOnly:t,resizable:e[Ut.D],responsive:e[Ut.E],forceHideResponsive:i,show_loading:e[Ut.I],forceShowLoading:!i})}),!s&&this.renderResponsiveSizeControl(),!s&&this.renderShowLoading()]})}}wr.propTypes={editField:l.a.func.isRequired,field:l.a.instanceOf(gt.a).isRequired,readOnly:l.a.bool,isV1:l.a.bool.isRequired,isEmail:l.a.bool.isRequired,hasDismissedResponsiveImageWarning:l.a.bool.isRequired,dismissResponsiveImageWarning:l.a.func.isRequired,dismissShowLoadingWarning:l.a.func.isRequired,hasDismissedShowLoadingWarning:l.a.bool.isRequired};function Gr(e){return{hasDismissedResponsiveImageWarning:Object(xr.n)(e),hasDismissedShowLoadingWarning:Object(xr.o)(e)}}const Mr={dismissResponsiveImageWarning:Tr.e,dismissShowLoadingWarning:Tr.f};var _r=Object(o.connect)(Gr,Mr)(wr),Ur=s(1189),Br=s(180);const Hr=e=>"DesignEditorsUI.customWidgetEditor.sidebar.fieldEdit.contentOptions."+e,Vr=[Br.a.FILE,Br.a.IMAGE,Br.a.VIDEO,Br.a.DOCUMENT,Br.a.AUDIO];class zr extends i.Component{constructor(...e){super(...e);this.onDefaultChange=e=>{this.props.editField({[Ut.f]:e})};this.onPickerChange=e=>{this.props.editField({[Ut.v]:e.target.name})};this.renderPickerRadios=()=>{const{field:e,readOnly:t}=this.props;return Vr.reduce((s,i)=>{const n=Br.a[i].toLowerCase();s.push(Object(te.jsx)(Wo.a,{checked:e[Ut.v]===n,disabled:t,name:n,onChange:this.onPickerChange,children:ue.a.text(Hr("file.pickerTypes."+n))},n));return s},[])}}render(){const{field:e,readOnly:t,fieldErrors:s}=this.props;return Object(te.jsx)("div",{children:Object(te.jsxs)(_t.a,{children:[Object(te.jsx)(es.a,{label:ue.a.text(Hr("file.pickerLabel")),children:Object(te.jsx)("div",{children:this.renderPickerRadios()})}),Object(te.jsx)(os,{"aria-label":"value",errors:s[Ut.f],children:Object(te.jsx)(Ht,{inputComponent:Ur.a,label:ue.a.text(Hr("defaultLabels."+Gi.FILE)),onFieldChange:this.onDefaultChange,picker:e[Ut.v],value:e[Ut.f],wrap:!0,readOnly:t})})]})})}}zr.propTypes={editField:l.a.func.isRequired,field:l.a.instanceOf(gt.a).isRequired,readOnly:l.a.bool,fieldErrors:l.a.object};var Kr=s(2665);const Jr=e=>"DesignEditorsUI.customWidgetEditor.sidebar.fieldEdit.contentOptions."+e;class Xr extends i.Component{constructor(e){super(e);this.onDefaultChange=this.onDefaultChange.bind(this)}onDefaultChange(e){this.props.editField({[Ut.f]:e})}render(){const{field:e,fieldErrors:t}=this.props;return Object(te.jsx)(os,{errors:t[Ut.f],label:Object(h.a)(Jr("defaultLabels."+Gi.HTML)),children:Object(te.jsx)(Ht,{inputComponent:Kr.a,onFieldChange:this.onDefaultChange,value:e[Ut.f]})})}}Xr.propTypes={editField:l.a.func.isRequired,field:l.a.instanceOf(gt.a).isRequired,fieldErrors:l.a.object};Xr.defaultProps={fieldErrors:{}};var $r=Xr,Yr=s(2587);const Qr=e=>"DesignEditorsUI.customWidgetEditor.sidebar.fieldEdit.contentOptions."+e;class Zr extends i.Component{constructor(...e){super(...e);this.onDefaultChange=e=>{this.props.editField({[Ut.f]:e})}}render(){const{field:e,readOnly:t}=this.props,s=Object(te.jsx)(u.a,{message:Qr("defaultLabels."+Gi.SIMPLE_MENU)});return Object(te.jsx)(es.a,{label:s,children:Object(te.jsx)(Yr.a,{onFieldChange:this.onDefaultChange,value:e[Ut.f],readOnly:t})})}}Zr.propTypes={editField:l.a.func.isRequired,field:l.a.instanceOf(gt.a).isRequired,readOnly:l.a.bool};var ed=s(2666);const td=e=>"DesignEditorsUI.customWidgetEditor.sidebar.fieldEdit.contentOptions."+e,sd=e=>td("image.showLoadingType."+e),id={ALL:"ALL",NONE:"NONE"},nd=Object.keys(id).map(e=>({text:Object(h.a)(sd("options."+e)),value:e}));class ad extends i.Component{constructor(...e){super(...e);this.onDefaultChange=e=>{this.props.editField({[Ut.f]:e})};this.onShowLoadingChange=({target:{value:e}})=>{const t=e===id.ALL;this.props.editField({[Ut.I]:t})}}get loadingControlType(){return this.props.field[Ut.I]?id.ALL:id.NONE}renderShowLoading(){return Object(te.jsx)(es.a,{className:"m-top-4",label:Object(te.jsx)(u.a,{message:sd("label")}),tooltip:Object(te.jsx)(u.a,{message:sd("tooltip")}),children:Object(te.jsx)(Os.a,{"data-test-id":"module-image-field-size-dropdown",disabled:this.props.readOnly,options:nd,onChange:this.onShowLoadingChange,required:!0,value:this.loadingControlType})})}render(){const{field:e,readOnly:t,isEmail:s}=this.props,i=Object(te.jsx)(u.a,{message:td("defaultLabels."+Gi.LOGO)});return Object(te.jsxs)("div",{children:[Object(te.jsx)(es.a,{label:i,children:Object(te.jsx)(Ht,{inputComponent:ed.a,onFieldChange:this.onDefaultChange,value:e[Ut.f],wrap:!0,readOnly:t,forceShowLoading:!s})}),this.renderShowLoading()]})}}ad.propTypes={editField:l.a.func.isRequired,field:l.a.instanceOf(gt.a).isRequired,isEmail:l.a.bool.isRequired,readOnly:l.a.bool};var od=ad,rd=s(1485);const dd=e=>"DesignEditorsUI.customWidgetEditor.sidebar.fieldEdit.contentOptions."+e;function ld(){return{}}const cd={setFullScreenEditorOpen:F.f};class pd extends i.PureComponent{constructor(...e){super(...e);this.openFullScreenEditor=()=>{this.props.setFullScreenEditorOpen(this.props.customWidgetId,!0)}}renderEditButton(){const{type:e}=this.props.field;return Object(te.jsx)(k.a,{disabled:this.props.readOnly,use:"tertiary-light",onClick:this.openFullScreenEditor,children:Object(te.jsx)(u.a,{message:dd(e+".edit")})})}renderRichTextPreview(){const{field:e}=this.props;return Object(te.jsx)(rd.a,{onClick:this.openFullScreenEditor,value:e[Ut.f]||""})}renderOption(){switch(this.props.field.type){case Gi.RICH_TEXT:return this.renderRichTextPreview();default:return this.renderEditButton()}}render(){const{type:e}=this.props.field;return Object(te.jsxs)("div",{className:"m-y-3",children:[Object(te.jsx)("div",{children:Object(te.jsx)(xi.a,{className:"p-top-0",children:Object(te.jsx)(u.a,{message:dd("defaultLabels."+e)})})}),this.renderOption()]})}}pd.propTypes={customWidgetId:c.a.customWidgetId.isRequired,setFullScreenEditorOpen:l.a.func.isRequired,field:l.a.instanceOf(gt.a).isRequired,readOnly:l.a.bool};var ud=Object(o.connect)(ld,cd)(pd),hd=s(1146);const gd=Object(Oi.a)(Mt.a),bd=e=>"DesignEditorsUI.customWidgetEditor.sidebar.fieldEdit.contentOptions."+e;class md extends i.PureComponent{constructor(...e){super(...e);this.onFieldChange=e=>{this.props.editField({[Ut.f]:e})};this.onPlaceholderChange=({target:{value:e}})=>{this.props.editField({[Ut.w]:e})}}renderPlaceholderLabel(){return Object(te.jsxs)(D.a,{children:[Object(te.jsx)("span",{className:"m-right-1",children:Object(te.jsx)(u.a,{message:bd("selectFields.placeholder.label")})}),Object(te.jsx)(Ai.a,{title:Object(te.jsx)(Pt.a,{children:Object(te.jsx)(u.a,{message:bd("selectFields.placeholder.tooltip")})}),color:Di.BATTLESHIP,tooltipPlacement:"top"})]})}render(){const{field:e,componentsByType:t,formControlProps:s,inputProps:i,readOnly:n}=this.props;return Object(te.jsxs)(_t.a,{children:[Object(te.jsx)(es.a,Object.assign({label:Object(te.jsx)(u.a,{message:bd("defaultLabels."+e.type)})},s,{children:Object(te.jsx)(Ht,Object.assign({onFieldChange:this.onFieldChange,value:e[Ut.f],required:!1,componentsByType:t,editor:ro.a.DESIGN_MANAGER,type:e.type,inputComponent:t[e.type],readOnly:n,tooltipPlacement:"top left",placeholder:e[Ut.w]},i))})),Object(te.jsx)(es.a,{label:this.renderPlaceholderLabel(),children:Object(te.jsx)(gd,{"data-test-id":"module-field-placeholder-input",onChange:this.onPlaceholderChange,value:e[Ut.w]||"",disabled:n})})]})}}md.propTypes={editField:l.a.func.isRequired,field:l.a.instanceOf(gt.a).isRequired,componentsByType:l.a.object.isRequired,inputProps:l.a.object.isRequired,formControlProps:l.a.object.isRequired,readOnly:l.a.bool};md.defaultProps={inputProps:{},formControlProps:{}};var jd=Object(hd.a)(md);const Od=e=>"DesignEditorsUI.customWidgetEditor.sidebar.fieldEdit.contentOptions."+e;class fd extends i.PureComponent{constructor(...e){super(...e);this.state={error:null};this.setError=e=>{this.setState({error:e})}}render(){const{field:e,readOnly:t}=this.props,{error:s}=this.state;return Object(te.jsx)(jd,Object.assign({},this.props,{inputProps:{setError:this.setError,error:!!s,readOnly:t},formControlProps:{validationMessage:s,label:ue.a.text(Od("defaultLabels."+e.type))}}))}}fd.propTypes={editField:l.a.func.isRequired,field:l.a.instanceOf(gt.a).isRequired,readOnly:l.a.bool};var Cd=s(2605);const yd=e=>"DesignEditorsUI.customWidgetEditor.sidebar.fieldEdit.contentOptions."+e;class xd extends i.PureComponent{constructor(...e){super(...e);this.onDefaultChange=e=>{this.props.editField({[Ut.f]:e})}}render(){const{field:e,isEmailOrAnyType:t,modulePath:s,readOnly:i}=this.props;return Object(te.jsx)("div",{className:"custom-widget-editor-font-picker",children:Object(te.jsx)(_t.a,{children:Object(te.jsx)(es.a,{children:Object(te.jsx)(Cd.a,{buttonSize:"small",isEmailOrAnyType:t,label:Object(h.a)(yd("defaultLabels."+Gi.FONT)),modulePath:s,onFieldChange:this.onDefaultChange,readOnly:i,showSizeUnit:!0,value:e[Ut.f]})})})})}}xd.propTypes={editField:l.a.func.isRequired,field:l.a.instanceOf(gt.a).isRequired,isEmailOrAnyType:l.a.bool,modulePath:l.a.string,readOnly:l.a.bool};function Td(){const e=Object(L.makeGetIsEmailOrAnyType)(),t=Object(L.makeGetModulePath)();return(s,i)=>({isEmailOrAnyType:e(s,i),modulePath:t(s,i)})}var Ed=Object(o.connect)(Td,null)(xd),Rd=s(1028),Id=s(174),vd=s(164);const Wd=["partial","field","componentsByType"],Fd=e=>"DesignEditorsUI.customWidgetEditor.sidebar.fieldEdit.contentOptions."+e;class Sd extends i.PureComponent{constructor(...e){super(...e);this.validateType=()=>{const e=this.props.field[vd.c],t=this.props.field[vd.m];e||t?e&&"string"==typeof e&&t!==Id.SLUG&&t!==Id.NAME?this.props.editField({[vd.m]:Id.SLUG}):e&&"number"==typeof e&&t!==Id.ID?this.props.editField({[vd.m]:Id.ID}):e&&"object"==typeof e&&t!==Id.ALL&&this.props.editField({[vd.m]:Id.ALL}):this.props.editField({[vd.m]:Id.SLUG})};this.onFieldChange=(e,t)=>{this.props.editField({[e]:t})}}componentDidMount(){this.validateType()}renderOptions(){return Object.keys(Id).filter(e=>"default"!==e).map(e=>Object(te.jsxs)(Wo.a,{name:e,size:"small",checked:e===this.props.field[vd.m],onChange:this.props.partial(this.onFieldChange,vd.m,e),disabled:this.props.readOnly,className:"p-bottom-2",children:[Object(te.jsx)(u.a,{message:Fd(`tag.valueSelect.options.${e}.label`)}),Object(te.jsx)(Pt.a,{use:"help",className:"display-block",children:Object(te.jsx)(u.a,{message:Fd(`tag.valueSelect.options.${e}.helpText`)})})]},e))}render(){const e=this.props,{partial:t,field:s,componentsByType:i}=e,n=Object(Et.a)(e,Wd);return Object(te.jsxs)("div",{children:[Object(te.jsx)(Zt.a,{label:Object(te.jsx)(u.a,{message:Fd("defaultLabels.tag")}),children:Object(te.jsx)(Ht,Object.assign({onFieldChange:t(this.onFieldChange,vd.c),value:s[vd.c],required:!1,componentsByType:i,type:Gi.TAG,inputComponent:i[Gi.TAG],tag_value:s[vd.m]||Id.SLUG},n))}),Object(te.jsx)(Zt.a,{label:Object(te.jsx)(u.a,{message:Fd("tag.valueSelect.label")}),tooltip:Object(te.jsx)(u.a,{message:Fd("tag.valueSelect.tooltip")}),children:Object(te.jsx)("div",{children:this.renderOptions()})})]})}}Sd.propTypes={editField:l.a.func.isRequired,field:l.a.instanceOf(gt.a).isRequired,componentsByType:l.a.object.isRequired,partial:l.a.func.isRequired,readOnly:l.a.bool};var Ld=Object(P.compose)(hd.a,Object(Rd.a)())(Sd),qd=s(2597),Dd=s(2789),Pd=s(177),Ad=s(2589);const Nd=["children","option"];function kd(e,t){const{urlSupportedTypePermissions:s}=Object(q.b)(e,t);return{hasDismissedAdvancedRelOptionsWarning:Object(xr.k)(e),urlSupportedTypePermissions:s}}const wd={dismissAdvancedRelOptionsWarning:Tr.b},Gd=e=>"DesignEditorsUI.customWidgetEditor.sidebar.fieldEdit.contentOptions."+e;class Md extends i.PureComponent{constructor(...e){super(...e);this.getTypeOptions=()=>{const{field:e,urlSupportedTypePermissions:t={}}=this.props;return Object.keys(Pd.a).map(s=>{const i=!1===t[s],n=e[Ut.Q].includes(s);return{showMissingPermissionsTooltip:i,disabled:i&&!n,badge:i&&n&&Object(te.jsx)(Qs.a,{color:Di.MARIGOLD,name:"warning"}),value:s,text:ue.a.text("ContentComponents.cmv2.fields.url.linkType.linkLabels."+s)}})};this.onFieldChange=e=>{this.props.editField({[Ut.f]:e})};this.onAcceptedTypesChange=({target:{value:e}})=>{this.props.editField({[Ut.Q]:e})};this.onShowAdvancedRelOptionsChange=({target:{checked:e}})=>{this.props.editField({[Ut.G]:e})};this.onAdvancedRelWarningClose=()=>{this.props.dismissAdvancedRelOptionsWarning()};this.renderOption=e=>{let{children:t,option:s}=e,i=Object(Et.a)(e,Nd);return Object(te.jsx)("span",Object.assign({},i,{children:Object(te.jsx)(Bs.a,{title:Object(te.jsx)(u.a,{message:Gd("url.disabledUrlType")}),disabled:!s.showMissingPermissionsTooltip,children:t})}))}}renderLinkOrUrlField(){const{field:e,fieldErrors:t,readOnly:s}=this.props,i=e.type===Gi.URL?qd.a:Dd.a;return Object(te.jsx)(es.a,{label:Object(te.jsx)(u.a,{message:Gd("defaultLabels."+e.type)}),error:t[Ut.f],children:Object(te.jsx)(i,{onFieldChange:this.onFieldChange,componentsByType:Ad.a,value:e[Ut.f],show_advanced_rel_options:e.type===Gi.LINK&&e[Ut.G],supported_types:e[Ut.Q],readOnly:s})})}renderSupportedTypesSelect(){const{field:e}=this.props;return Object(te.jsx)(es.a,{label:Object(te.jsx)(u.a,{message:Gd("url.acceptedTypesSelect.label")}),children:Object(te.jsx)(Os.a,{multi:!0,value:e[Ut.Q],defaultValue:Object.values(Pd.a||{}),anchorType:"button",onChange:this.onAcceptedTypesChange,options:this.getTypeOptions(),itemComponent:this.renderOption,placeholder:ue.a.text(Gd("url.acceptedTypesSelect.placeholder"))})})}renderShowAdvancedRelOptionsToggle(){const{field:e,hasDismissedAdvancedRelOptionsWarning:t,readOnly:s}=this.props;if(e.type===Gi.URL)return null;const i=!t&&e[Ut.G];return Object(te.jsxs)("div",{className:"m-top-4",children:[Object(te.jsx)(Vs.a,{className:"p-right-4 p-top-1",children:Object(te.jsx)(u.a,{message:Gd("url.advancedRelOptions")})}),Object(te.jsx)(Ht,{checked:e[Ut.G],disabled:s,inputComponent:La.a,onChange:this.onShowAdvancedRelOptionsChange,size:"extra-small"}),i&&Object(te.jsx)(N.a,{className:"m-top-3",type:"warning",closeable:!0,onClose:this.onAdvancedRelWarningClose,children:Object(te.jsx)(A.a,{message:Gd("url.advancedRelOptionsWarning"),options:{relProperty:Object(te.jsx)("code",{children:"rel"})}})})]})}render(){return Object(te.jsxs)(_t.a,{children:[this.renderLinkOrUrlField(),this.renderSupportedTypesSelect(),this.renderShowAdvancedRelOptionsToggle()]})}}Md.propTypes={dismissAdvancedRelOptionsWarning:l.a.func,editField:l.a.func.isRequired,field:l.a.instanceOf(gt.a).isRequired,hasDismissedAdvancedRelOptionsWarning:l.a.bool,readOnly:l.a.bool,fieldErrors:l.a.object,urlSupportedTypePermissions:l.a.object.isRequired};Md.defaultProps={inputProps:{},formControlProps:{}};var _d=Object(o.connect)(kd,wd)(Md),Ud=s(2667);const Bd=e=>"DesignEditorsUI.customWidgetEditor.sidebar.fieldEdit.contentOptions."+e;class Hd extends i.PureComponent{constructor(...e){super(...e);this.onResizableChange=e=>{this.props.editField({[Ut.D]:e.target.checked})};this.onShowPreviewChange=e=>{this.props.editField({[Ut.K]:e.target.checked})};this.onDefaultChange=e=>{this.props.editField({[Ut.f]:e})};this.onChangeShowAdvancedOptions=e=>{this.props.editField({[Ut.F]:e.target.checked})};this.onAdvancedVideoOptionsWarningClose=()=>{this.props.dismissAdvancedVideoOptionsWarning()}}renderSizeControlToggle(){const{field:e,readOnly:t}=this.props;return Object(te.jsxs)("div",{className:"m-top-3",children:[Object(te.jsx)(Vs.a,{className:"p-right-4 p-top-1",children:Object(te.jsx)(u.a,{message:Bd("embed.sizeControlOptionsLabel")})}),Object(te.jsx)(Ht,{checked:e[Ut.D],defaultChecked:!0,disabled:t,inputComponent:La.a,onChange:this.onResizableChange,required:!0,size:"extra-small"})]})}renderShowPreviewToggle(){const{field:e,readOnly:t}=this.props;return Object(te.jsxs)("div",{className:"m-top-3",children:[Object(te.jsx)(Vs.a,{className:"p-right-4 p-top-1",children:Object(te.jsx)(u.a,{message:Bd("embed.showPreview.labelVideo")})}),Object(te.jsx)(Ht,{checked:e[Ut.K],defaultChecked:!0,disabled:t,inputComponent:La.a,onChange:this.onShowPreviewChange,required:!0,size:"extra-small"})]})}renderShowAdvancedVideoOptionsToggle(){const{field:e,hasDismissedAdvancedVideoOptionsWarning:t}=this.props,s=!t&&e[Ut.F];return Object(te.jsxs)("div",{className:"m-top-3",children:[Object(te.jsx)(Vs.a,{className:"p-right-4 p-top-1",children:Object(te.jsx)(u.a,{message:Bd("embed.showAdvancedOptions")})}),Object(te.jsx)(La.a,{checked:e[Ut.F],"data-test-id":"module-field-editor-advanced-options-toggle",onChange:this.onChangeShowAdvancedOptions,size:"extra-small"}),s&&Object(te.jsx)(N.a,{className:"m-top-3",type:"warning",closeable:!0,onClose:this.onAdvancedVideoOptionsWarningClose,children:Object(te.jsx)(u.a,{message:Bd("embed.advancedVideoOptionsWarning")})})]})}render(){const{field:e,fieldErrors:t,readOnly:s}=this.props;return Object(te.jsx)("div",{className:"cmv2-edit-form cmv2-field-group cmv2-edit-form--with-padding",children:Object(te.jsxs)(_t.a,{children:[Object(te.jsx)(os,{errors:t[Ut.f],children:Object(te.jsx)(Ud.a,{label:Object(te.jsx)(u.a,{message:Bd("defaultLabels."+Gi.VIDEO)}),onFieldChange:this.onDefaultChange,readOnly:s,resizable:e[Ut.D],show_advanced_options:e[Ut.F],show_preview:e[Ut.K],value:e[Ut.f]})}),this.renderSizeControlToggle(),this.renderShowPreviewToggle(),this.renderShowAdvancedVideoOptionsToggle()]})})}}Hd.propTypes={dismissAdvancedVideoOptionsWarning:l.a.func,editField:l.a.func.isRequired,field:l.a.instanceOf(gt.a).isRequired,fieldErrors:l.a.object,hasDismissedAdvancedVideoOptionsWarning:l.a.bool,readOnly:l.a.bool};const Vd=e=>({hasDismissedAdvancedVideoOptionsWarning:Object(xr.l)(e)}),zd={dismissAdvancedVideoOptionsWarning:Tr.c};var Kd=Object(o.connect)(Vd,zd)(Hd),Jd=s(1145),Xd=s(2586);const $d=Ad.a[Gi.RICH_TEXT],Yd=e=>"DesignEditorsUI.customWidgetEditor.sidebar.fieldEdit.contentOptions."+e;class Qd extends i.Component{constructor(...e){super(...e);this.onFieldChange=e=>{this.props.editField({[Ut.f]:e})};this.onRedirect=e=>{this.redirectPending=!0;this.redirectToForm=e};this.renderRichTextField=e=>Object(te.jsx)($d,Object.assign({},e,{modulePath:this.props.modulePath,shouldFetchCustomFonts:!0}))}componentDidUpdate(e){if(this.redirectPending&&e.formIdFromBuffer!==this.props.formIdFromBuffer)this.props.saveCustomWidget(this.props.customWidgetId);else if(this.redirectPending&&this.redirectToForm&&e.isSaving&&!this.props.isSaving){this.redirectPending=!1;this.redirectToForm()}}render(){const{componentsByType:e}=this.props;this.props.compact||(e[Gi.RICH_TEXT]=this.renderRichTextField);return Object(te.jsx)(es.a,{label:Object(h.a)(Yd("defaultLabels."+Gi.FORM)),children:Object(te.jsx)(Ht,{onFieldChange:this.onFieldChange,value:this.props.field[Ut.f],readOnly:this.props.readOnly,type:Gi.FORM,inputComponent:Xd.a,onRedirect:this.onRedirect,componentsByType:e,required:!1,required_property_types:this.props.field[Ut.C]})})}}Qd.propTypes={compact:l.a.bool,componentsByType:l.a.object.isRequired,customWidgetId:c.a.customWidgetId.isRequired,editField:l.a.func.isRequired,field:l.a.instanceOf(gt.a).isRequired,formIdFromBuffer:l.a.string,isSaving:l.a.bool.isRequired,modulePath:l.a.string.isRequired,readOnly:l.a.bool,saveCustomWidget:l.a.func.isRequired};function Zd(){const e=L.makeGetRequestStatus(),t=L.makeGetModulePath();return(s,i)=>{const{isSaving:n=!1}=e(s,i)||{},a=t(s,i),o=q.g(s,i),r=L.getCustomWidgetBufferFieldsMap(s,{customWidgetId:i.customWidgetId})[i.field.id]||{};return{isSaving:n,modulePath:a,richTextPreviewIconName:o?"remove":"expand",formIdFromBuffer:r[Ut.f]&&r[Ut.f].form_id}}}const el={saveCustomWidget:W.B};var tl=Object(P.compose)(Object(o.connect)(Zd,el),Jd.a)(Qd),sl=s(1328),il=s(2782),nl=s(1082);const al=e=>"DesignEditorsUI.customWidgetEditor.sidebar.fieldEdit.contentOptions."+e,ol=Object(Oi.a)(ri.a),rl=Object(Oi.a)(Mt.a);function dl(e){return e?e.asMutable?e.asMutable():e:[]}function ll(){return(e,t)=>{const s=q.l(e,t).map(e=>e.name).join("."),i=t.field[Ut.t];return{crmPropertyOptions:nl.f(e,{objectType:i}),crmObjectTypeOptions:nl.k(e),crmObjectSchema:nl.g(e,{objectType:i}),fieldNamePath:"module."+(s||t.field.name),selectedCrmObjectType:nl.t(e,{objectType:i})}}}const cl={fetchCrmObjectSchema:il.e,fetchCrmObjectTypes:il.g};class pl extends i.Component{constructor(...e){super(...e);this.onObjectTypeChange=e=>{this.props.editField({[Ut.t]:e.target.value,[Ut.z]:[],[Ut.j]:[],[Ut.f]:null})};this.onPropertiesToFetchChange=e=>{this.props.editField({[Ut.z]:e.target.value})};this.onDisplayPropertiesChange=e=>{this.props.editField({[Ut.j]:e.target.value})};this.onDisplayFormatChange=e=>{this.props.editField({[Ut.i]:e.target.value})};this.onPlaceholderChange=e=>{this.props.editField({[Ut.w]:e.target.value})};this.onDefaultChange=e=>{this.props.editField({[Ut.f]:e})}}componentDidMount(){const{crmObjectSchema:e,fetchCrmObjectSchema:t,fetchCrmObjectTypes:s,field:i}=this.props;s();const n=i[Ut.t];n&&!e&&t(n)}componentDidUpdate(e){const{crmObjectSchema:t,fetchCrmObjectSchema:s,field:i}=this.props,n=i[Ut.t];e.field[Ut.t]!==n&&n&&!t&&s(n)}renderCRMObjectTypeSelect(){const{crmObjectTypeOptions:e,fieldErrors:t,readOnly:s,selectedCrmObjectType:i}=this.props;return Object(te.jsx)(os,{errors:t[Ut.t],label:Object(te.jsx)(u.a,{message:al("crmobject.objectType.label")}),children:Object(te.jsx)(Ht,{inputComponent:Os.a,disabled:s,onChange:this.onObjectTypeChange,options:e,placeholder:Object(te.jsx)(u.a,{message:al("crmobject.objectType.placeholder")}),required:!0,value:i})})}renderPropertiesToFetch(){const{crmPropertyOptions:e,field:t,fieldNamePath:s,readOnly:i}=this.props;return Object(te.jsx)(es.a,{label:Object(te.jsx)(u.a,{message:al("crmobject.propertiesToFetch.label")}),tooltip:Object(te.jsx)(Je.a,{message:al("crmobject.propertiesToFetch.tooltip"),options:{fieldNamePath:s}}),tooltipProps:{use:"longform"},children:Object(te.jsx)(Ht,{inputComponent:Os.a,disabled:i,onChange:this.onPropertiesToFetchChange,multi:!0,options:e,placeholder:Object(te.jsx)(u.a,{message:al("crmobject.propertiesToFetch.placeholder")}),required:!0,value:dl(t[Ut.z])})})}renderDisplayProperties(){const{crmPropertyOptions:e,field:t,readOnly:s}=this.props;return Object(te.jsx)(es.a,{label:Object(te.jsx)(u.a,{message:al("crmobject.displayProperties.label")}),tooltip:Object(te.jsxs)(i.Fragment,{children:[Object(te.jsx)("p",{children:Object(te.jsx)(u.a,{message:al("crmobject.displayProperties.tooltip1")})}),Object(te.jsx)("p",{children:Object(te.jsx)(u.a,{message:al("crmobject.displayProperties.tooltip2")})})]}),tooltipProps:{headingText:Object(te.jsx)(u.a,{message:al("crmobject.displayProperties.tooltipTitle")}),use:"longform"},children:Object(te.jsx)(Ht,{inputComponent:Os.a,disabled:s,onChange:this.onDisplayPropertiesChange,multi:!0,options:e,placeholder:Object(te.jsx)(u.a,{message:al("crmobject.displayProperties.placeholder")}),required:!0,value:dl(t[Ut.j])})})}renderPropertiesDisplayFormat(){const{field:e,readOnly:t}=this.props;return Object(te.jsx)(es.a,{label:Object(te.jsx)(u.a,{message:al("crmobject.displayFormat.label")}),tooltip:Object(te.jsxs)(i.Fragment,{children:[Object(te.jsx)("p",{children:Object(te.jsx)(u.a,{message:al("crmobject.displayFormat.tooltip1")})}),Object(te.jsx)("p",{children:Object(te.jsx)(u.a,{message:al("crmobject.displayFormat.tooltip2")})})]}),tooltipProps:{headingText:Object(te.jsx)(u.a,{message:al("crmobject.displayFormat.tooltipTitle")}),use:"longform"},children:Object(te.jsx)(Ht,{disabled:t||!e[Ut.j],inputComponent:ol,maxHeight:300,onChange:this.onDisplayFormatChange,placeholder:Object(h.a)(al("hubdbrow.displayFormat.placeholder")),required:!0,shrink:!0,value:e[Ut.i]})})}renderPlaceholderInput(){const{field:e,readOnly:t}=this.props;return Object(te.jsx)(es.a,{label:Object(te.jsx)(u.a,{message:al("selectFields.placeholder.label")}),tooltip:Object(te.jsx)(u.a,{message:al("selectFields.placeholder.tooltip")}),children:Object(te.jsx)(Ht,{inputComponent:rl,onChange:this.onPlaceholderChange,value:e[Ut.w],disabled:t})})}render(){const{crmObjectSchema:e,field:t,readOnly:s}=this.props;return Object(te.jsxs)(i.Fragment,{children:[this.renderCRMObjectTypeSelect(),t[Ut.t]&&e&&this.renderPropertiesToFetch(),t[Ut.t]&&e&&this.renderDisplayProperties(),t[Ut.t]&&e&&this.renderPropertiesDisplayFormat(),t[Ut.t]&&this.renderPlaceholderInput(),t[Ut.t]&&Object(te.jsx)(es.a,{label:Object(te.jsx)(u.a,{message:al("defaultLabels."+Gi.CRM_OBJECT)}),children:Object(te.jsx)(Ht,{display_properties:t[Ut.j],display_format:t[Ut.i],inputComponent:sl.a,object_type:t[Ut.t],onFieldChange:this.onDefaultChange,placeholder:t[Ut.w],readOnly:s,type:t.type,value:t[Ut.f]})})]})}}pl.propTypes={crmObjectSchema:l.a.object,crmObjectTypeOptions:l.a.array.isRequired,crmPropertyOptions:l.a.array.isRequired,editField:l.a.func.isRequired,fetchCrmObjectSchema:l.a.func.isRequired,fetchCrmObjectTypes:l.a.func.isRequired,field:l.a.instanceOf(gt.a).isRequired,fieldErrors:l.a.object,fieldNamePath:l.a.string,readOnly:l.a.bool,selectedCrmObjectType:l.a.string};var ul=Object(o.connect)(ll,cl)(pl),hl=s(1329);const gl=e=>"DesignEditorsUI.customWidgetEditor.sidebar.fieldEdit.contentOptions."+e,bl=Object(Oi.a)(Mt.a);function ml(){return(e,t)=>{const s=t.field[Ut.t];return{crmObjectTypeOptions:nl.k(e),crmObjectSchema:nl.g(e,{objectType:s}),selectedCrmObjectType:nl.t(e,{objectType:s})}}}const jl={fetchCrmObjectSchema:il.e,fetchCrmObjectTypes:il.g};class Ol extends i.Component{constructor(...e){super(...e);this.onObjectTypeChange=e=>{this.props.editField({[Ut.t]:e.target.value,[Ut.f]:{property:null}})};this.onPlaceholderChange=e=>{this.props.editField({[Ut.w]:e.target.value})};this.onDefaultChange=e=>{this.props.editField({[Ut.f]:e})}}componentDidMount(){const{crmObjectSchema:e,fetchCrmObjectSchema:t,fetchCrmObjectTypes:s,field:i}=this.props;s();const n=i[Ut.t];n&&!e&&t(n)}componentDidUpdate(e){const{crmObjectSchema:t,fetchCrmObjectSchema:s,field:i}=this.props,n=i[Ut.t];e.field[Ut.t]!==n&&n&&!t&&s(n)}renderCRMObjectTypeSelect(){const{crmObjectTypeOptions:e,fieldErrors:t,readOnly:s,selectedCrmObjectType:i}=this.props;return Object(te.jsx)(os,{errors:t[Ut.t],label:Object(te.jsx)(u.a,{message:gl("crmobject.objectType.label")}),children:Object(te.jsx)(Ht,{inputComponent:Os.a,disabled:s,onChange:this.onObjectTypeChange,options:e,placeholder:Object(te.jsx)(u.a,{message:gl("crmobject.objectType.placeholder")}),required:!0,value:i})})}renderPlaceholderInput(){const{field:e,readOnly:t}=this.props;return Object(te.jsx)(es.a,{label:Object(te.jsx)(u.a,{message:gl("selectFields.placeholder.label")}),tooltip:Object(te.jsx)(u.a,{message:gl("selectFields.placeholder.tooltip")}),children:Object(te.jsx)(Ht,{inputComponent:bl,onChange:this.onPlaceholderChange,value:e[Ut.w],disabled:t})})}render(){const{field:e,readOnly:t}=this.props;return Object(te.jsxs)(i.Fragment,{children:[this.renderCRMObjectTypeSelect(),e[Ut.t]&&this.renderPlaceholderInput(),e[Ut.t]&&Object(te.jsx)(es.a,{label:Object(te.jsx)(u.a,{message:gl("defaultLabels."+Gi.CRM_OBJECT_PROPERTY)}),children:Object(te.jsx)(Ht,{inputComponent:hl.a,object_type:e[Ut.t],onFieldChange:this.onDefaultChange,placeholder:e[Ut.w],readOnly:t,type:e.type,value:e[Ut.f]})})]})}}Ol.propTypes={crmObjectSchema:l.a.object,crmObjectTypeOptions:l.a.array.isRequired,editField:l.a.func.isRequired,fetchCrmObjectSchema:l.a.func.isRequired,fetchCrmObjectTypes:l.a.func.isRequired,field:l.a.instanceOf(gt.a).isRequired,fieldErrors:l.a.object,readOnly:l.a.bool,selectedCrmObjectType:l.a.string};var fl=Object(o.connect)(ml,jl)(Ol),Cl=s(2698);const yl=e=>"DesignEditorsUI.customWidgetEditor.sidebar.fieldEdit.contentOptions."+e;class xl extends i.Component{constructor(e){super(e);this.onDefaultChange=this.onDefaultChange.bind(this)}onDefaultChange(e){this.props.editField({[Ut.f]:e})}render(){const{field:e,readOnly:t}=this.props;return Object(te.jsx)(es.a,{label:Object(te.jsx)(u.a,{message:yl("defaultLabels."+Gi.GRADIENT)}),children:Object(te.jsx)(Ht,{inputComponent:Cl.a,onFieldChange:this.onDefaultChange,value:e[Ut.f]&&e[Ut.f].asMutable({deep:!0}),readOnly:t})})}}xl.propTypes={editField:l.a.func.isRequired,field:l.a.instanceOf(gt.a).isRequired,readOnly:l.a.bool};var Tl=xl,El=s(1331);const Rl=e=>"DesignEditorsUI.customWidgetEditor.sidebar.fieldEdit.contentOptions."+e;class Il extends i.Component{constructor(e){super(e);this.onDefaultChange=this.onDefaultChange.bind(this)}onDefaultChange(e){this.props.editField({[Ut.f]:e})}render(){const{field:e,readOnly:t}=this.props;return Object(te.jsx)(es.a,{label:Object(te.jsx)(u.a,{message:Rl("defaultLabels."+Gi.SPACING)}),children:Object(te.jsx)(Ht,{inputComponent:El.a,onFieldChange:this.onDefaultChange,value:e[Ut.f],readOnly:t})})}}Il.propTypes={editField:l.a.func.isRequired,field:l.a.instanceOf(gt.a).isRequired,readOnly:l.a.bool};var vl=Il,Wl=s(2699);const Fl=e=>"DesignEditorsUI.customWidgetEditor.sidebar.fieldEdit.contentOptions."+e;class Sl extends i.Component{constructor(e){super(e);this.onDefaultChange=this.onDefaultChange.bind(this)}onDefaultChange(e){this.props.editField({[Ut.f]:e})}render(){const{field:e,readOnly:t}=this.props;return Object(te.jsx)(es.a,{label:Object(te.jsx)(u.a,{message:Fl("defaultLabels."+Gi.BACKGROUND_IMAGE)}),children:Object(te.jsx)(Ht,{inputComponent:Wl.a,onFieldChange:this.onDefaultChange,value:e[Ut.f],readOnly:t})})}}Sl.propTypes={editField:l.a.func.isRequired,field:l.a.instanceOf(gt.a).isRequired,readOnly:l.a.bool};var Ll=Sl,ql=s(1272),Dl=s(2641),Pl=s(178),Al=s(1200);const Nl=e=>"DesignEditorsUI.customWidgetEditor.sidebar.fieldEdit.contentOptions."+e;function kl(e){return e?e.asMutable?e.asMutable():e:[]}const{HTML:wl,MEDIA_BRIDGE:Gl,OEMBED:Ml}=Pl.a,_l="ALL_SOURCE_TYPES",Ul="ALL_PROVIDERS",Bl="CUSTOM_PROVIDERS",Hl=Object.keys(Pl.b).map(e=>({text:Object(h.a)(Nl("embed.supportedOembedTypes.options."+e)),value:Pl.b[e]})),Vl=e=>({hasFetchedProviders:On.a(e),mediaBridgeProviderOptions:On.e(e)}),zl={fetchMediaBridgeProviders:jn.b};class Kl extends i.Component{constructor(e){super(e);this.onSupportedSourceTypeOptionToggle=e=>{const{field:t}=this.props,{checked:s,name:i}=e.target,{[Ut.P]:n=[]}=t;s?this.onSupportedSourceTypesChange(n.concat([i])):this.onSupportedSourceTypesChange(n.filter(e=>e!==i))};this.onSupportedSourceTypesChange=e=>{const{field:t}=this.props,s={[Ut.P]:e},i=t[Ut.f]&&t[Ut.f].source_type;i&&!e.includes(i)&&(s[Ut.f]=Object.assign({},t[Ut.f],{source_type:e[0]}));this.props.editField(s)};this.onSupportedOembedTypesChange=e=>{this.props.editField({[Ut.O]:e.target.value})};this.onSupportedMediaBridgeProvidersChange=e=>{const{field:t,editField:s}=this.props,{media_bridge_object:i}=t[Ut.f]||{},{provider_id:n}=i||{},a=e.target.value,o={[Ut.N]:a};n&&!a.includes(n)&&(o[Ut.f]=Object.assign({},t[Ut.f],{media_bridge_object:Object.assign({},i,{id:null,oembed_url:"",provider_id:null},Object(Al.h)(i))}));s(o)};this.onSupportedMediaBridgeProvidersCheck=e=>{const{editField:t}=this.props;if(e.target.name===Ul){this.setState({isCheckedAllProviders:!0});t({[Ut.N]:[]})}else this.setState({isCheckedAllProviders:!1})};this.onResizableChange=e=>{this.props.editField({[Ut.D]:e.target.checked})};this.onShowPreviewChange=e=>{this.props.editField({[Ut.K]:e.target.checked})};this.onDefaultChange=e=>{this.props.editField({[Ut.f]:e})};this.renderSupportedSourceTypeCheckbox=e=>{const{field:t,isEmail:s,readOnly:i}=this.props,{[Ut.P]:n=[]}=t,a=s&&e===wl,o=Object(te.jsx)(u.a,{message:Nl("embed.supportedSourceTypes.options."+e)});return Object(te.jsx)(lo.a,{checked:n.includes(e),disabled:i||a,name:e,onChange:this.onSupportedSourceTypeOptionToggle,size:"small",children:a?Object(te.jsx)(Bs.a,{title:Object(te.jsx)(u.a,{message:Nl("embed.supportedSourceTypes.emailTooltip")}),children:o}):o},e)};const t=e.field[Ut.N];this.state={isCheckedAllProviders:!t||!(!t||0!==t.length)}}componentDidMount(){const{fetchMediaBridgeProviders:e,hasFetchedProviders:t}=this.props;t||e()}shouldComponentUpdate(e,t){return a()(this,e,t)}componentDidUpdate(e){const{fetchMediaBridgeProviders:t,hasFetchedProviders:s}=this.props,{[Ut.P]:i}=e.field||{};i.includes(Gl)||!this.hasMediaBridgeSource||s||t()}get hasMediaBridgeSource(){return this.props.field[Ut.P].includes(Gl)}renderSupportedSourceTypesRadios(){const{field:e,fieldErrors:t,isEmail:s,mediaBridgeProviderOptions:i,readOnly:n}=this.props;if(i&&i.length)return Object(te.jsx)(os,{errors:t[Ut.P],label:Object(te.jsx)(u.a,{message:Nl("embed.supportedSourceTypes.label")}),tooltip:Object(te.jsx)(A.a,{message:Nl("embed.supportedSourceTypes.tooltip"),options:{oembedProviderLink:Object(te.jsx)(w.a,{external:!0,href:"https://oembed.com/#section7",children:Object(te.jsx)(u.a,{message:Nl("embed.supportedSourceTypes.oembedProviderLinkText")})})}}),tooltipProps:{maxWidth:235},children:Object(te.jsx)(ql.a,{name:"supportedSourceTypes",children:Object.values(Pl.a).map(this.renderSupportedSourceTypeCheckbox)})});let a=_l;e[Ut.P]&&1===e[Ut.P].length&&(a=e[Ut.P][0]);s&&(a=Pl.a.OEMBED);return Object(te.jsx)(es.a,{label:Object(te.jsx)(u.a,{message:Nl("embed.supportedSourceTypes.label")}),tooltip:Object(te.jsx)(A.a,{message:Nl("embed.supportedSourceTypes.tooltip"),options:{oembedProviderLink:Object(te.jsx)(w.a,{external:!0,href:"https://oembed.com/#section7",children:Object(te.jsx)(u.a,{message:Nl("embed.supportedSourceTypes.oembedProviderLinkText")})})}}),tooltipProps:{maxWidth:235},children:Object(te.jsxs)("div",{children:[Object(te.jsx)(Wo.a,{checked:a===Ml,disabled:n,name:Ml,onChange:()=>this.onSupportedSourceTypesChange([Ml]),size:"small",children:Object(te.jsx)(u.a,{message:Nl("embed.supportedSourceTypes.options.embedUrlOnly")})}),Object(te.jsx)(Wo.a,{checked:a===wl,disabled:n||s,name:wl,onChange:()=>this.onSupportedSourceTypesChange([wl]),size:"small",children:Object(te.jsx)(Bs.a,{disabled:!s,title:Object(te.jsx)(u.a,{message:Nl("embed.supportedSourceTypes.emailTooltip")}),children:Object(te.jsx)(u.a,{message:Nl("embed.supportedSourceTypes.options.embedCodeOnly")})})}),Object(te.jsx)(Wo.a,{checked:a===_l,disabled:n||s,name:_l,onChange:()=>this.onSupportedSourceTypesChange([Ml,wl]),size:"small",children:Object(te.jsx)(Bs.a,{disabled:!s,title:Object(te.jsx)(u.a,{message:Nl("embed.supportedSourceTypes.emailTooltip")}),children:Object(te.jsx)(u.a,{message:Nl("embed.supportedSourceTypes.options.allTypes")})})})]})})}renderSupportedOembedTypesSelect(){const{field:e,readOnly:t}=this.props;if(!e[Ut.P]||!e[Ut.P].includes(Ml))return null;const s=e[Ut.O]&&1===e[Ut.O].length?Hl.map(e=>Object.assign({},e,{clearableValue:!1})):Hl;return Object(te.jsx)(es.a,{className:"m-top-3",label:Object(te.jsx)(u.a,{message:Nl("embed.supportedOembedTypes.label")}),tooltip:Object(te.jsx)(A.a,{message:Nl("embed.supportedOembedTypes.tooltip.message"),options:{documentationLink:Object(te.jsx)(w.a,{external:!0,href:"https://developers.hubspot.com/docs/cms/building-blocks/module-theme-fields/oembed",children:Object(te.jsx)(u.a,{message:Nl("embed.supportedOembedTypes.tooltip.documentationLink")})})}}),children:Object(te.jsx)(Ht,{inputComponent:Os.a,disabled:t,onChange:this.onSupportedOembedTypesChange,multi:!0,options:s,required:!0,value:kl(e[Ut.O])})})}renderMediaBridgeProvidersOptions(){const{field:e,mediaBridgeProviderOptions:t,readOnly:s}=this.props,n=kl(e[Ut.N]),a=[...t];return t&&t.length&&this.hasMediaBridgeSource?Object(te.jsx)(es.a,{className:"m-top-3",label:Object(te.jsx)(u.a,{message:Nl("embed.supportedMediaBridgeProviders.label")}),tooltip:Object(te.jsx)(A.a,{message:Nl("embed.supportedMediaBridgeProviders.tooltip")}),children:Object(te.jsxs)(i.Fragment,{children:[Object(te.jsx)(Wo.a,{checked:this.state.isCheckedAllProviders,disabled:s,name:Ul,onChange:this.onSupportedMediaBridgeProvidersCheck,size:"small",children:Object(te.jsx)(Ai.a,{title:Object(te.jsx)(u.a,{message:Nl("embed.supportedMediaBridgeProviders.options.allProviders.tooltip")}),children:Object(te.jsx)(u.a,{message:Nl("embed.supportedMediaBridgeProviders.options.allProviders.label")})})}),Object(te.jsx)(Wo.a,{checked:!this.state.isCheckedAllProviders,disabled:s,name:Bl,onChange:this.onSupportedMediaBridgeProvidersCheck,size:"small",children:Object(te.jsx)(Ai.a,{title:Object(te.jsx)(u.a,{message:Nl("embed.supportedMediaBridgeProviders.options.custom.tooltip")}),children:Object(te.jsx)(u.a,{message:Nl("embed.supportedMediaBridgeProviders.options.custom.label")})})}),!this.state.isCheckedAllProviders&&Object(te.jsx)(Ht,{disabled:s,inputComponent:Os.a,multi:!0,onChange:this.onSupportedMediaBridgeProvidersChange,options:a,required:!0,value:n})]})}):null}renderSizeControlToggle(){const{field:e,readOnly:t}=this.props;return Object(te.jsxs)("div",{className:"m-top-6",children:[Object(te.jsx)(Vs.a,{className:"p-right-4 p-top-1",children:Object(te.jsx)(u.a,{message:Nl("embed.sizeControlOptionsLabel")})}),Object(te.jsx)(Ht,{checked:e[Ut.D],defaultChecked:!0,disabled:t,inputComponent:La.a,onChange:this.onResizableChange,required:!0,size:"extra-small"})]})}renderShowPreviewToggle(){const{field:e,readOnly:t}=this.props;return Object(te.jsxs)("div",{className:"m-top-3",children:[Object(te.jsx)(Vs.a,{className:"p-right-4 p-top-1",children:Object(te.jsx)(u.a,{message:Nl("embed.showPreview.labelGeneral")})}),Object(te.jsx)(Ht,{checked:e[Ut.K],defaultChecked:!0,disabled:t,inputComponent:La.a,onChange:this.onShowPreviewChange,required:!0,size:"extra-small"})]})}render(){const{field:e,isEmail:t,readOnly:s}=this.props;return Object(te.jsxs)(_t.a,{children:[this.renderSupportedSourceTypesRadios(),this.renderSupportedOembedTypesSelect(),this.renderMediaBridgeProvidersOptions(),Object(te.jsx)(es.a,{label:Object(te.jsx)(u.a,{message:Nl("defaultLabels."+Gi.EMBED)}),children:Object(te.jsx)(Ht,{inputComponent:Dl.a,isInEmail:t,onFieldChange:this.onDefaultChange,readOnly:s||!e[Ut.P][0],resizable:e[Ut.D],show_preview:e[Ut.K],supported_media_bridge_providers:e[Ut.N],supported_source_types:e[Ut.P],supported_oembed_types:e[Ut.O],type:e.type,value:e[Ut.f]})}),this.renderSizeControlToggle(),this.renderShowPreviewToggle()]})}}Kl.propTypes={editField:l.a.func.isRequired,field:l.a.instanceOf(gt.a).isRequired,fieldErrors:l.a.object,isEmail:l.a.bool,readOnly:l.a.bool,fetchMediaBridgeProviders:l.a.func.isRequired,hasFetchedProviders:l.a.bool,mediaBridgeProviderOptions:l.a.arrayOf(l.a.object)};var Jl=Object(o.connect)(Vl,zl)(Kl),Xl=s(1205),$l=s(1336),Yl=s(1067),Ql=s(2781),Zl=s(1068);const ec=e=>"DesignEditorsUI.customWidgetEditor.sidebar.fieldEdit.contentOptions."+e,tc=Object(Oi.a)(ri.a),sc=Object(Oi.a)(Mt.a),ic={NAME:"hs_name",PATH:"hs_path"};function nc(e){return e?e.asMutable?e.asMutable():e:[]}const ac=(e,t)=>{const s="id";return{hubDbTable:Yl.i(e,{id:t.field[Ut.R]}),isUnpublished:Yl.o(e,{[s]:t.field[Ut.R]})}},oc={fetchHubDbTable:Ql.d};class rc extends i.Component{constructor(...e){super(...e);this.onTableChange=e=>{const{editField:t}=this.props;t({[Ut.R]:e.target.value,[Ut.f]:{id:null}})};this.onColumnsToFetchChange=e=>{this.props.editField({[Ut.e]:e.target.value})};this.onDisplayColumnsChange=e=>{this.props.editField({[Ut.h]:e.target.value})};this.onDisplayFormatChange=e=>{this.props.editField({[Ut.i]:e.target.value})};this.onPlaceholderChange=e=>{this.props.editField({[Ut.w]:e.target.value})};this.onDefaultChange=e=>{this.props.editField({[Ut.f]:e})}}componentDidUpdate(e){const{editField:t,fetchHubDbTable:s,field:i,hubDbTable:n}=this.props;e.field[Ut.R]===i[Ut.R]||n||s(i[Ut.R]);if(!Object(p.isEqual)(e.hubDbTable,n)){const e=nc(i[Ut.e]),s=nc(i[Ut.h]),a={},o=this.updateColumns(e,n),r=this.updateColumns(s,n);e&&o&&!Object(p.isEqual)(e,o)&&(a[Ut.e]=o);s&&r&&!Object(p.isEqual)(s,r)&&(a[Ut.h]=r);t(Object.assign({},a))}}getColumnOptions(e=!0){const{columns:t,useForPages:s}=this.props.hubDbTable||{};if(!t)return null;const i=s?[{text:Object(h.a)(ec("hubdbrow.builtInColumns.name")),value:ic.NAME,help:ic.NAME},{text:Object(h.a)(ec("hubdbrow.builtInColumns.path")),value:ic.PATH,help:ic.PATH}]:[];return t.reduce((t,s)=>{!e&&Zl.b[s.type]||t.push({text:s.label,value:s.name,help:s.name});return t},i)}updateColumns(e,t){if(!e)return[];const{columns:s,useForPages:i}=t||{},n=i?{[ic.NAME]:ic.NAME,[ic.PATH]:ic.PATH}:{},a=s.reduce((e,t)=>{e[t.name]=t.name;return e},n);return e.filter(e=>a[e])}renderHubDBTableSelect(){const{contentTypes:e,fieldErrors:t,hubDbTable:s,readOnly:i,hostTemplateTypes:n}=this.props;return Object(te.jsx)(os,{errors:t[Ut.R],className:"m-top-3",label:Object(te.jsx)(u.a,{message:ec("hubdbrow.table")}),children:Object(te.jsx)(Ht,{contentTypes:e,disabled:i,editor:ro.a.DESIGN_MANAGER,inputComponent:Xl.a,isInRowField:!0,hostTemplateTypes:n,onChange:this.onTableChange,required:!0,type:Gi.HUBDB_TABLE,value:s&&s.id})})}renderColumnsToFetch(){const{field:e,hubDbTable:t,isUnpublished:s,readOnly:n}=this.props;return Object(te.jsx)(es.a,{className:"m-top-3",label:Object(te.jsx)(u.a,{message:ec("hubdbrow.columnsToFetch.label")}),tooltip:Object(te.jsxs)(i.Fragment,{children:[Object(te.jsx)("p",{children:Object(te.jsx)(u.a,{message:ec("hubdbrow.columnsToFetch.tooltip1")})}),Object(te.jsx)("p",{children:Object(te.jsx)(u.a,{message:ec("hubdbrow.columnsToFetch.tooltip2")})})]}),tooltipProps:{headingText:Object(te.jsx)(u.a,{message:ec("hubdbrow.columnsToFetch.tooltipTitle")}),use:"longform"},children:Object(te.jsx)(Ht,{disabled:n||!(t&&t.id)||s,inputComponent:Os.a,multi:!0,onChange:this.onColumnsToFetchChange,options:this.getColumnOptions(),placeholder:Object(te.jsx)(u.a,{message:ec("hubdbrow.columnsToFetch.placeholder")}),value:nc(e[Ut.e])})})}renderDisplayColumns(){const{field:e,hubDbTable:t,isUnpublished:s,readOnly:n}=this.props,a=!1;return Object(te.jsx)(es.a,{className:"m-top-3",label:Object(te.jsx)(u.a,{message:ec("hubdbrow.displayColumns.label")}),tooltip:Object(te.jsxs)(i.Fragment,{children:[Object(te.jsx)("p",{children:Object(te.jsx)(u.a,{message:ec("hubdbrow.displayColumns.tooltip1")})}),Object(te.jsx)("p",{children:Object(te.jsx)(u.a,{message:ec("hubdbrow.displayColumns.tooltip2")})})]}),tooltipProps:{headingText:Object(te.jsx)(u.a,{message:ec("hubdbrow.displayColumns.tooltipTitle")}),use:"longform"},children:Object(te.jsx)(Ht,{disabled:n||!(t&&t.id)||s,inputComponent:Os.a,multi:!0,onChange:this.onDisplayColumnsChange,options:this.getColumnOptions(a),placeholder:Object(te.jsx)(u.a,{message:ec("hubdbrow.displayColumns.placeholder")}),required:!0,value:nc(e[Ut.h])})})}renderColumnsDisplayFormat(){const{field:e,isUnpublished:t,readOnly:s}=this.props;return Object(te.jsx)(es.a,{className:"m-top-3",label:Object(te.jsx)(u.a,{message:ec("hubdbrow.displayFormat.label")}),tooltip:Object(te.jsxs)(i.Fragment,{children:[Object(te.jsx)("p",{children:Object(te.jsx)(u.a,{message:ec("hubdbrow.displayFormat.tooltip1")})}),Object(te.jsx)("p",{children:Object(te.jsx)(u.a,{message:ec("hubdbrow.displayFormat.tooltip2")})})]}),tooltipProps:{headingText:Object(te.jsx)(u.a,{message:ec("hubdbrow.displayFormat.tooltipTitle")}),use:"longform"},children:Object(te.jsx)(Ht,{disabled:s||!e[Ut.h]||t,inputComponent:tc,maxHeight:300,onChange:this.onDisplayFormatChange,placeholder:Object(h.a)(ec("hubdbrow.displayFormat.placeholder")),required:!0,shrink:!0,value:e[Ut.i]})})}renderPlaceholderInput(){const{field:e,hubDbTable:t,isUnpublished:s,readOnly:i}=this.props;return Object(te.jsx)(es.a,{label:Object(te.jsx)(u.a,{message:ec("selectFields.placeholder.label")}),tooltip:Object(te.jsx)(u.a,{message:ec("selectFields.placeholder.tooltip")}),children:Object(te.jsx)(Ht,{disabled:i||!(t&&t.id)||s,inputComponent:sc,onChange:this.onPlaceholderChange,value:e[Ut.w]})})}render(){const{contentTypes:e,field:t,isEmail:s,readOnly:n,hostTemplateTypes:a}=this.props;return t[Ut.R]?Object(te.jsxs)(i.Fragment,{children:[this.renderHubDBTableSelect(),this.renderColumnsToFetch(),this.renderDisplayColumns(),this.renderColumnsDisplayFormat(),this.renderPlaceholderInput(),Object(te.jsx)(es.a,{label:Object(te.jsx)(u.a,{message:ec("defaultLabels."+Gi.HUBDB_ROW)}),children:Object(te.jsx)(Ht,{contentTypes:e,columns_to_fetch:t[Ut.e],display_columns:t[Ut.h],display_format:t[Ut.i],editor:ro.a.DESIGN_MANAGER,inputComponent:$l.a,hostTemplateTypes:a,isInEmail:s,onFieldChange:this.onDefaultChange,placeholder:t[Ut.w],readOnly:n,table_name_or_id:t[Ut.R],type:t.type,value:t[Ut.f]})})]}):this.renderHubDBTableSelect()}}rc.propTypes={contentTypes:l.a.array,editField:l.a.func.isRequired,field:l.a.instanceOf(gt.a).isRequired,fieldErrors:l.a.object,hostTemplateTypes:l.a.array,isEmail:l.a.bool,readOnly:l.a.bool,fetchHubDbTable:l.a.func.isRequired,hubDbTable:l.a.object,isUnpublished:l.a.bool};var dc=Object(o.connect)(ac,oc)(rc),lc=s(1337);const cc=e=>"DesignEditorsUI.customWidgetEditor.sidebar.fieldEdit.contentOptions."+e;class pc extends i.Component{constructor(...e){super(...e);this.onDefaultChange=e=>{this.props.editField({[Ut.f]:e})}}render(){const{field:e,readOnly:t}=this.props;return Object(te.jsx)(es.a,{label:Object(te.jsx)(u.a,{message:cc("defaultLabels."+Gi.BORDER)}),children:Object(te.jsx)(Ht,{allow_custom_border_sides:!0,inputComponent:lc.a,onFieldChange:this.onDefaultChange,value:e[Ut.f],readOnly:t})})}}pc.propTypes={editField:l.a.func.isRequired,field:l.a.instanceOf(gt.a).isRequired,readOnly:l.a.bool};var uc=pc,hc=s(1338);const gc=e=>"DesignEditorsUI.customWidgetEditor.sidebar.fieldEdit.contentOptions."+e;class bc extends i.PureComponent{constructor(...e){super(...e);this.onDefaultChange=e=>{this.props.editField({[Ut.f]:e})}}render(){const{field:e,readOnly:t}=this.props;return Object(te.jsx)("div",{className:"custom-widget-editor-font-picker",children:Object(te.jsx)(es.a,{label:Object(te.jsx)(u.a,{message:gc("defaultLabels."+Gi.ALIGNMENT)}),children:Object(te.jsx)(hc.a,{onFieldChange:this.onDefaultChange,value:e[Ut.f],readOnly:t,buttonSize:"small"})})})}}bc.propTypes={editField:l.a.func.isRequired,field:l.a.instanceOf(gt.a).isRequired,readOnly:l.a.bool};var mc=bc,jc=s(1339);const Oc=e=>"DesignEditorsUI.customWidgetEditor.sidebar.fieldEdit.contentOptions."+e;class fc extends i.PureComponent{constructor(...e){super(...e);this.onDefaultChange=e=>{this.props.editField({[Ut.f]:e})}}render(){const{field:e,readOnly:t}=this.props;return Object(te.jsx)("div",{className:"custom-widget-editor-font-picker",children:Object(te.jsx)(es.a,{label:Object(te.jsx)(u.a,{message:Oc("defaultLabels."+Gi.TEXT_ALIGNMENT)}),children:Object(te.jsx)(jc.a,{onFieldChange:this.onDefaultChange,value:e[Ut.f],readOnly:t,buttonSize:"small"})})})}}fc.propTypes={editField:l.a.func.isRequired,field:l.a.instanceOf(gt.a).isRequired,readOnly:l.a.bool};var Cc=fc,yc=s(2581);const xc=e=>"DesignEditorsUI.customWidgetEditor.sidebar.fieldEdit.contentOptions."+e;function Tc(e){return e?e.asMutable?e.asMutable():e:[]}function Ec(){return(e,t)=>{const s=q.l(e,t).map(e=>e.name).join(".");return{crmPropertyOptions:nl.f(e,{objectType:Gi.PRODUCT}),crmObjectSchema:nl.g(e,{objectType:Gi.PRODUCT}),fieldNamePath:"module."+(s||t.field.name)}}}const Rc={fetchCrmObjectSchema:il.e};class Ic extends i.Component{constructor(...e){super(...e);this.onPropertiesToFetchChange=e=>{this.props.editField({[Ut.z]:e.target.value})};this.onDefaultChange=e=>{this.props.editField({[Ut.f]:e})}}componentDidMount(){const{crmObjectSchema:e,fetchCrmObjectSchema:t}=this.props;e||t(Gi.PRODUCT)}renderPropertiesToFetch(){const{crmPropertyOptions:e,field:t,fieldNamePath:s,readOnly:i}=this.props;return Object(te.jsx)(es.a,{label:Object(te.jsx)(u.a,{message:xc("crmobject.propertiesToFetch.label")}),tooltip:Object(te.jsx)(Je.a,{message:xc("crmobject.propertiesToFetch.tooltip"),options:{fieldNamePath:s}}),tooltipProps:{use:"longform"},children:Object(te.jsx)(Ht,{inputComponent:Os.a,disabled:i,onChange:this.onPropertiesToFetchChange,multi:!0,options:e,placeholder:Object(te.jsx)(u.a,{message:xc("crmobject.propertiesToFetch.placeholder")}),required:!0,value:Tc(t[Ut.z])})})}render(){const{crmObjectSchema:e,field:t,readOnly:s}=this.props;return Object(te.jsxs)(i.Fragment,{children:[e&&this.renderPropertiesToFetch(),Object(te.jsx)(es.a,{label:Object(te.jsx)(u.a,{message:xc("defaultLabels."+Gi.PRODUCT)}),children:Object(te.jsx)(Ht,{inputComponent:yc.a,object_type:Gi.PRODUCT,onFieldChange:this.onDefaultChange,readOnly:s,type:t.type,value:t[Ut.f]})})]})}}Ic.propTypes={crmObjectSchema:l.a.object,crmPropertyOptions:l.a.array.isRequired,editField:l.a.func.isRequired,fetchCrmObjectSchema:l.a.func.isRequired,field:l.a.instanceOf(gt.a).isRequired,fieldNamePath:l.a.string,readOnly:l.a.bool};var vc=Object(o.connect)(Ec,Rc)(Ic);const Wc={episode:"episode",show:"show"};var Fc=({editField:e,field:t})=>{const s=t=>{e({entity_type:t})};return Object(te.jsx)(Zt.a,{label:Object(te.jsx)(u.a,{message:"DesignEditorsUI.customWidgetEditor.sidebar.fieldEdit.contentOptions.podcast.entityType.label"}),children:Object(te.jsxs)(ql.a,{name:"entity_type",children:[Object(te.jsx)(Wo.a,{checked:Boolean(!t.entity_type||t.entity_type===Wc.episode),size:"small",onChange:({currentTarget:{checked:e}})=>{e&&s(Wc.episode)},children:Object(te.jsx)(u.a,{message:"DesignEditorsUI.customWidgetEditor.sidebar.fieldEdit.contentOptions.podcast.entityType.episode"})}),Object(te.jsx)(Wo.a,{checked:t.entity_type===Wc.show,size:"small",onChange:({currentTarget:{checked:e}})=>{e&&s(Wc.show)},children:Object(te.jsx)(u.a,{message:"DesignEditorsUI.customWidgetEditor.sidebar.fieldEdit.contentOptions.podcast.entityType.show"})})]})})};const Sc={[Gi.TEXT]:xo,[Gi.RICH_TEXT]:vo,[Gi.BOOLEAN]:qo,[Gi.CHOICE]:er,[Gi.NUMBER]:ar,[Gi.DATE]:dr,[Gi.DATE_TIME]:pr,[Gi.COLOR]:jr,[Gi.CTA]:Cr,[Gi.IMAGE]:_r,[Gi.FILE]:zr,[Gi.BLOG]:jd,[Gi.TAG]:Ld,[Gi.FORM]:tl,[Gi.WORKFLOW]:jd,[Gi.FOLLOW_UP_EMAIL]:fd,[Gi.EMAIL]:jd,[Gi.HUBDB_TABLE]:jd,[Gi.PAGE]:jd,[Gi.MENU]:jd,[Gi.HUBL]:$r,[Gi.HTML]:$r,[Gi.MEETING]:jd,[Gi.SIMPLE_MENU]:Zr,[Gi.LOGO]:od,[Gi.ICON]:Sr,[Gi.SFDC_CAMPAIGN]:jd,[Gi.SURVEY]:jd,[Gi.FONT]:Ed,[Gi.URL]:_d,[Gi.LINK]:_d,[Gi.VIDEO]:Kd,[Gi.CRM_OBJECT]:ul,[Gi.CRM_OBJECT_PROPERTY]:fl,[Gi.GRADIENT]:Tl,[Gi.SPACING]:vl,[Gi.BACKGROUND_IMAGE]:Ll,[Gi.EMBED]:Jl,[Gi.HUBDB_ROW]:dc,[Gi.BORDER]:uc,[Gi.ALIGNMENT]:mc,[Gi.TEXT_ALIGNMENT]:Cc,[Gi.PAYMENT]:jd,[Gi.PRODUCT]:vc,[Gi.PODCAST]:Fc},Lc=Object(Hi.a)({[Gi.SIMPLE_MENU]:null,[Gi.RICH_TEXT]:null,[Gi.HTML]:null,[Gi.HUBL]:null});class qc extends i.PureComponent{renderMissingRequiredDefaultWarning(){const{fieldWarnings:e}=this.props,t=e&&e[Ut.f];if(!t||!t.length)return null;const s=t.find(e=>e.type===Oo.MODULE_DATA_VALIDATION_REQUIRED_FIELD_MISSING||e.type===Oo.MODULE_DATA_VALIDATION_LOCKED_REQUIRED_FIELD_MISSING);return s&&Object(te.jsx)(N.a,{className:"m-bottom-2",type:"warning",children:Object(te.jsx)(u.a,{message:"DesignEditorsUI.customWidgetEditor.errors.field."+s.type})})}render(){const{compact:e,customWidgetContentTypes:t,customWidgetHostTemplateTypes:s,customWidgetId:n,editField:a,field:o,fieldErrors:r,fieldWarnings:d,isEmailOrAnyType:l,isV1:c,onPreviewClick:p,readOnly:u}=this.props,h=Sc[o.type],g=o.set("default",Object(jo.a)(o));return e&&Lc[o.type]?Object(te.jsx)(ud,{customWidgetId:n,field:o,readOnly:u}):h?Object(te.jsxs)(i.Fragment,{children:[this.renderMissingRequiredDefaultWarning(),Object(te.jsx)(h,{compact:e,customWidgetId:n,isV1:c,editField:a,field:g,fieldErrors:r,fieldWarnings:d,contentTypes:t,hostTemplateTypes:s,readOnly:u,onPreviewClick:p,isEmail:l})]}):null}}qc.propTypes={customWidgetContentTypes:l.a.array,customWidgetHostTemplateTypes:l.a.array,customWidgetId:c.a.customWidgetId.isRequired,editField:l.a.func.isRequired,field:l.a.instanceOf(gt.a).isRequired,fieldErrors:l.a.object,fieldWarnings:l.a.object,compact:l.a.bool.isRequired,readOnly:l.a.bool,isV1:l.a.bool.isRequired,onPreviewClick:l.a.func,isEmailOrAnyType:l.a.bool.isRequired};qc.defaultProps={customWidgetContentTypes:null,customWidgetHostTemplateTypes:null,fieldErrors:{},fieldWarnings:{},compact:!1,onPreviewClick:pe.a};var Dc=s(171);const Pc=e=>"DesignEditorsUI.customWidgetEditor.sidebar.fieldEdit."+e,Ac=e=>Pc("displayConditions."+e),Nc="^w*$";function kc(){return(e,t)=>{const s=L.makeGetCustomWidgetBufferFields()(e,t);return{controllingFields:Object(ce.l)(s,t.field.name)}}}class wc extends i.PureComponent{constructor(e){super(e);this.onToggleClick=e=>{const t=e.target.checked;this.setState({enabled:t});this.props.editField({[Ut.V]:t?this.state.visibility:null})};this.onVisibilityPropertyChange=(e,t)=>{const s=t.target.value,i=this.props.field[Ut.V]||{};this.setState({enabled:!0,visibility:Object.assign({},this.state.visibility,{[e]:s})});this.props.editField({[Ut.V]:Object.assign({},i,{[e]:s})})};this.filterControllingFieldsOptions=(e,t)=>t.length?Object(ce.k)(e,t,!1):e;this.state=this.getState(e.field)}componentDidMount(){const e=this.props.field[Ut.V];e&&!e.operator&&this.state.visibility.operator&&this.props.editField({[Ut.V]:this.state.visibility})}componentDidUpdate(e){const{field:t}=e,{field:s}=this.props;t.id===s.id&&Object(p.isEqual)(t.visibility,s.visibility)||this.setState(this.getState(s))}getState(e){const t=e[Ut.V],{controlling_value_regex:s}=t||{};let i=t?t.operator:null;i||(i=s===Nc?Dc.c.EMPTY:s?Dc.c.MATCHES_REGEX:Dc.c.NOT_EMPTY);return{enabled:!!t,visibility:Object.assign({},t,{operator:i})}}getControllingFieldsOptions(){return this.props.controllingFields.map(e=>Object.assign({text:e.label,value:e.name,help:e.name},e))}getOperatorsOptions(){return Object.keys(Dc.c).map(e=>({text:Object(h.a)(Ac("operators."+e)),value:e}))}renderFieldValue({help:e}){return e?Object(te.jsx)("span",{className:"controlling-field-name is--code",children:Object(te.jsx)(Lt.a,{children:e})}):Object(te.jsx)(u.a,{message:Ac("placeholders.field")})}renderDisplayConditionsHelpTooltip(){const e=Object(te.jsx)(Pt.a,{children:Object(te.jsxs)("div",{children:[Object(te.jsx)("p",{children:Object(te.jsx)(Je.a,{message:Ac("helpTooltip.explanation")})}),Object(te.jsxs)(Dt.a,{styled:!0,children:[Object(te.jsx)(u.a,{message:Ac("helpTooltip.examples.address")}),Object(te.jsx)(u.a,{message:Ac("helpTooltip.examples.imageDescription")})]}),Object(te.jsx)(u.a,{message:Ac("helpTooltip.moreHelp")}),Object(te.jsx)(w.a,{className:"m-left-1",target:"_blank",href:"http://designers.hubspot.com/docs/modules/field-options-and-usage#display-conditions",children:Object(te.jsx)(u.a,{message:Ac("helpTooltip.learnMore")})})]})});return Object(te.jsx)(Ai.a,{title:e,color:Di.BATTLESHIP,tooltipPlacement:"top left",tooltipProps:{headingText:Object(h.a)(Ac("helpTooltip.headingText")),className:"field-edit-help-tooltip",use:"longform"}})}renderDisplayConditionsTitle(){const e=Object(p.pick)(this.props.fieldErrors,["controlling_field","controlling_value_regex"]),t=Object(p.pick)(this.props.fieldWarnings,["controlling_field","controlling_value_regex"]);return Object(te.jsxs)(D.a,{align:"end",children:[Object(te.jsx)(bn,{className:"m-right-2",fieldErrors:e,i18nKey:Pc("contentOptions.hasFieldError")}),Object(te.jsx)(mn,{className:"m-right-2",fieldWarnings:t,i18nKey:Pc("contentOptions.hasFieldWarning")}),Object(te.jsx)("span",{className:"m-right-1",children:Object(te.jsx)(u.a,{message:Ac("accordionLabel")})}),this.renderDisplayConditionsHelpTooltip()]})}render(){const{enabled:e,visibility:t}=this.state,{controllingFields:s,field:i,fieldErrors:n,fieldWarnings:a,onOpenChange:o,open:r,readOnly:d}=this.props,{controlling_field:l,controlling_field_path:c,controlling_value_regex:p,operator:g,property:b}=t,m=s.find(e=>c?e.name===c:e.id===l),j=Object(te.jsx)(La.a,{checked:e,onChange:this.onToggleClick,size:"extra-small",readOnly:d}),O=g===Dc.c.EMPTY||g===Dc.c.NOT_EMPTY||d,f=g===Dc.c.MATCHES_REGEX?Object(h.a)(Ac("placeholders.regex")):Object(h.a)(Ac("placeholders.value"));return Object(te.jsx)(kt.a,{actions:j,containerClassName:"field-edit-accordion-container",titleText:this.renderDisplayConditionsTitle(),onOpenChange:o,open:r,children:Object(te.jsx)("div",{children:Object(te.jsxs)(_t.a,{children:[Object(te.jsx)(os,{className:"m-bottom-2",errors:n.controlling_field,label:Object(h.a)(Ac("conditionLabel")),children:Object(te.jsx)(Ht,{dropdownClassName:"controlling-field-select-dropdown",inputComponent:Os.a,onChange:(...e)=>this.onVisibilityPropertyChange("controlling_field_path",...e),filterOptions:this.filterControllingFieldsOptions,options:this.getControllingFieldsOptions(),placeholder:Object(h.a)(Ac("placeholders.field")),value:m&&m.name,valueRenderer:this.renderFieldValue,disabled:d})}),Object(jo.c)(m)&&Object(te.jsxs)(D.a,{align:"center",children:[Object(te.jsx)(Ht,{className:"m-bottom-2",onChange:(...e)=>this.onVisibilityPropertyChange("property",...e),placeholder:Object(h.a)(Ac("placeholders.property")),value:b||"",disabled:d}),Object(te.jsx)(Ai.a,{className:"m-left-1",title:Object(te.jsx)(u.a,{message:Ac("helpTooltip.property")}),color:Di.BATTLESHIP,tooltipPlacement:"top left"})]}),Object(te.jsx)(Ht,{className:"m-bottom-2",inputComponent:Os.a,onChange:(...e)=>this.onVisibilityPropertyChange("operator",...e),options:this.getOperatorsOptions(),placeholder:Object(h.a)(Ac("placeholders.operator")),value:g,disabled:d}),Object(te.jsx)(os,{errors:n.controlling_value_regex||a.controlling_value_regex,children:Object(te.jsx)(Ht,{disabled:O,onChange:(...e)=>this.onVisibilityPropertyChange("controlling_value_regex",...e),placeholder:f,value:O?"":p})})]})})},i.name+"-repeater-options")}}wc.propTypes={controllingFields:l.a.arrayOf(l.a.object).isRequired,editField:l.a.func.isRequired,field:l.a.instanceOf(gt.a).isRequired,fieldErrors:l.a.object,fieldWarnings:l.a.object,onOpenChange:l.a.func,open:l.a.bool,readOnly:l.a.bool};wc.defaultProps={fieldErrors:{},fieldWarnings:{}};var Gc=Object(o.connect)(kc)(wc),Mc=s(1139),_c=s(2695),Uc=s(2758);const Bc=e=>"DesignEditorsUI.customWidgetEditor.sidebar.fieldEdit."+e,Hc=e=>Bc("occurrence."+e),Vc=["max"];class zc extends i.PureComponent{constructor(e){super(e);Object(p.bindAll)(this,["getState","onToggleClick","onNumberValueChange","onSortingLabelFieldChange","onChange"]);this.state=this.getState(e.field)}componentDidUpdate(e){if(e.field.id!==this.props.field.id){const e=this.getState(this.props.field);this.setState(e)}}getState(e){const t=e[Ut.u];return{enabled:!!t,occurrence:t||{}}}onToggleClick(e){const t=e.target.checked;this.setState({enabled:t});this.props.editField({[Ut.u]:t?this.state.occurrence:null})}onNumberValueChange(e,t){const s=t.target.value;(-1!==Vc.indexOf(e)&&!s||s>=0)&&this.onChange(e,s)}onSortingLabelFieldChange(e){this.onChange("sorting_label_field",e.target.value)}onChange(e,t){const s=this.props.field[Ut.u]||{};this.setState({enabled:!0,[Ut.u]:Object.assign({},this.state.occurrence,{[e]:t})});this.props.editField({[Ut.u]:Object.assign({},s,{[e]:t})})}renderOccurrenceHelpTooltip(){const e=Object(te.jsx)(Pt.a,{children:Object(te.jsxs)("div",{children:[Object(te.jsx)("p",{children:Object(te.jsx)(Je.a,{message:Hc("helpTooltip.explanation")})}),Object(te.jsxs)(Dt.a,{styled:!0,children:[Object(te.jsx)(u.a,{message:Hc("helpTooltip.examples.gallery")}),Object(te.jsx)(u.a,{message:Hc("helpTooltip.examples.collection")}),Object(te.jsx)(u.a,{message:Hc("helpTooltip.examples.group")})]}),Object(te.jsx)(u.a,{message:Hc("helpTooltip.moreHelp")}),Object(te.jsx)(w.a,{className:"m-left-1",target:"_blank",href:"http://designers.hubspot.com/docs/modules/repeating-fields-and-loops",children:Object(te.jsx)(u.a,{message:Hc("helpTooltip.learnMore")})})]})});return Object(te.jsx)(Ai.a,{title:e,color:Di.BATTLESHIP,tooltipPlacement:"top left",tooltipProps:{headingText:Object(h.a)(Hc("helpTooltip.headingText")),placement:"top left",className:"field-edit-help-tooltip",use:"longform"}})}renderOccurrenceTitle(){const e=Object(p.pick)(this.props.fieldErrors,Ut.u),t=Object(p.pick)(this.props.fieldWarnings,Ut.u);return Object(te.jsxs)(D.a,{align:"end",children:[Object(te.jsx)(bn,{className:"m-right-2",fieldErrors:e,i18nKey:Bc("contentOptions.hasFieldError")}),Object(te.jsx)(mn,{className:"m-right-2",fieldWarnings:t,i18nKey:Bc("contentOptions.hasFieldWarning")}),Object(te.jsx)("span",{className:"m-right-1",children:Object(te.jsx)(u.a,{message:Hc("accordionLabel")})}),this.renderOccurrenceHelpTooltip()]})}renderSortingLabelFieldPreview(e){if(!e)return null;const t=Object(p.pick)(this.props,Object.values(Uc.q||{})),s=Object(te.jsx)(_c.a,{defaultLabel:e.label,field:e,resources:t}),i=Object(te.jsx)("div",{className:"cmv2-occurrence",children:Object(te.jsx)(Pi.a,{className:"occurrences-table m-all-0",hover:!1,children:Object(te.jsx)("tbody",{children:Object(te.jsx)(Mc.a,{deletable:!1,fieldId:e.id,index:0,isPreview:!0,value:s})})})});return Object(te.jsx)(Bs.a,{className:"repeater-options-tooltip",placement:"top left",title:i,children:Object(te.jsx)(k.a,{use:"link",children:Object(te.jsx)(Pt.a,{children:Object(te.jsx)(u.a,{message:Hc("sortingLabel.previewLink")})})})})}renderSortingLabelFieldSelect(){const{field:e,readOnly:t}=this.props,{children:s=[]}=e;if(e.type!==Gi.GROUP||!s.length)return null;const i=s.map(e=>({text:e.label,value:e.id})),{occurrence:{sorting_label_field:n}}=this.state,a=n&&s.find(e=>e.id===n),o=Object(te.jsxs)("span",{children:[Object(te.jsx)("span",{className:"m-right-1",children:Object(te.jsx)(u.a,{message:Hc("sortingLabel.label")})}),Object(te.jsx)(Ai.a,{title:Object(te.jsx)(Pt.a,{children:Object(te.jsx)(u.a,{message:Hc("sortingLabel.tooltip")})}),color:Di.BATTLESHIP,tooltipProps:{placement:"top left"}})]});return Object(te.jsx)(Zt.a,{help:this.renderSortingLabelFieldPreview(a),label:o,children:Object(te.jsx)(Ht,{clearable:!0,inputComponent:Os.a,onChange:this.onSortingLabelFieldChange,options:i,placeholder:Object(h.a)(Hc("sortingLabel.placeholder")),value:a?n:null,disabled:t})})}render(){const{fieldErrors:e,fieldWarnings:t,field:s,onOpenChange:i,open:n,readOnly:a}=this.props,{enabled:o,occurrence:r}=this.state,{min:d,max:l,default:c}=r,p=[],g=[],b=[];e[Ut.u]&&e[Ut.u].forEach(e=>{switch(e.type){case Ao.MODULE_VALIDATION_OCCURRENCE_MIN_LESS_THAN_ZERO:p.push(e);break;case Ao.MODULE_VALIDATION_OCCURRENCE_MAX_LESS_THAN_ONE:case Ao.MODULE_VALIDATION_OCCURRENCE_MAX_LESS_THAN_MIN:g.push(e);break;default:b.push(e)}});const m=[],j=[],O=[];t[Ut.u]&&t[Ut.u].forEach(e=>{switch(e.type){case Ao.MODULE_VALIDATION_OCCURRENCE_MIN_LESS_THAN_ZERO:m.push(e);break;case Ao.MODULE_VALIDATION_OCCURRENCE_MAX_LESS_THAN_ONE:case Ao.MODULE_VALIDATION_OCCURRENCE_MAX_LESS_THAN_MIN:j.push(e);break;default:O.push(e)}});const f=Object(te.jsx)(La.a,{checked:o,"data-test-id":"module-field-editor-repeater-toggle",onChange:this.onToggleClick,size:"extra-small",readOnly:a});return Object(te.jsx)(kt.a,{actions:f,containerClassName:"field-edit-accordion-container",titleText:this.renderOccurrenceTitle(),onOpenChange:i,open:n,children:Object(te.jsx)("div",{children:Object(te.jsxs)(_t.a,{children:[Object(te.jsx)(os,{className:"m-bottom-3",errors:p.concat(g),warnings:m.concat(j),label:Object(h.a)(Hc("countLimitsLabel")),children:Object(te.jsxs)(D.a,{align:"end",children:[Object(te.jsx)(Pt.a,{use:"help",children:Object(te.jsx)(os,{error:!!p.length,label:Object(h.a)(Hc("minLabel")),children:Object(te.jsx)(Ht,{"data-test-id":"module-field-editor-repeater-min",inputComponent:lr.a,onChange:(...e)=>this.onNumberValueChange("min",...e),placeholder:Object(h.a)(Hc("minPlaceholder")),value:d,min:0,disabled:a})})}),Object(te.jsx)("span",{className:"p-x-2 p-y-1",children:Object(te.jsx)(u.a,{message:Hc("toLabel")})}),Object(te.jsx)(Pt.a,{use:"help",children:Object(te.jsx)(os,{error:!!g.length,label:Object(h.a)(Hc("maxLabel")),children:Object(te.jsx)(Ht,{"data-test-id":"module-field-editor-repeater-max",inputComponent:lr.a,onChange:(...e)=>this.onNumberValueChange("max",...e),placeholder:Object(h.a)(Hc("maxPlaceholder")),value:l,min:1,disabled:a})})})]})}),Object(te.jsx)(os,{errors:b,warnings:O,label:Object(h.a)(Hc("defaultCountLabel")),children:Object(te.jsx)(Ht,{"data-test-id":"module-field-editor-repeater-default",inputComponent:lr.a,onChange:(...e)=>this.onNumberValueChange("default",...e),placeholder:Object(h.a)(Hc("defaultPlaceholder")),value:c,min:0,disabled:a})}),this.renderSortingLabelFieldSelect()]})})},s.id+"-repeater-options")}}zc.propTypes={editField:l.a.func.isRequired,field:l.a.instanceOf(gt.a).isRequired,fieldErrors:l.a.object,fieldWarnings:l.a.object,onOpenChange:l.a.func,open:l.a.bool,readOnly:l.a.bool};zc.defaultProps={fieldErrors:{},fieldWarnings:{}};var Kc=zc;const Jc=e=>"DesignEditorsUI.customWidgetEditor.sidebar.fieldEdit.contentOptions."+e;function Xc(){const e=L.makeGetCustomWidgetBufferFields();return(t,s)=>{const i=e(t,s),{field:n}=s;return{depth:n?Object(ce.p)(i,n.id):0,fieldCreateOptions:Object(q.b)(t,s)}}}const $c={createField:W.f,toggleFieldGrouping:F.k};class Yc extends i.Component{constructor(...e){super(...e);this.onChildCreate=e=>{const{createField:t,customWidgetId:s,field:i,fieldCreateOptions:n}=this.props;t(s,new gt.a({type:e,isNew:!0,fieldCreateOptions:n}),i.id)};this.onGroupClick=()=>{const{customWidgetId:e,toggleFieldGrouping:t}=this.props;t(e)}}get canContainChildren(){return this.props.depth<Zi.a-1}renderChildren(){const{field:e,depth:t,customWidgetId:s,fieldName:i,readOnly:n}=this.props;if(!e.children||!e.children.length){const e=this.canContainChildren?"noChildren":"tooDeep";return Object(te.jsx)("div",{className:"p-bottom-3",children:Object(te.jsx)(Pt.a,{use:"help",children:Object(te.jsx)(u.a,{message:Jc("group."+e)})})})}return Object(te.jsx)(Pn,{customWidgetId:s,fields:e.children,fieldName:i,depth:t+1,isReadOnly:n})}renderGroupControls(){const{isFieldGroupingActive:e,readOnly:t,customWidgetId:s,field:i}=this.props;return e||!this.canContainChildren||t?null:Object(te.jsxs)(D.a,{align:"baseline",justify:"between",children:[Object(te.jsx)(xi.a,{children:Object(te.jsx)(u.a,{message:Jc("defaultLabels."+Gi.GROUP)})}),Object(te.jsxs)("div",{children:[Object(te.jsx)(Nn,{customWidgetId:s,onFieldCreate:this.onChildCreate,isStyleTab:i.tab===cs.d}),Object(te.jsx)(k.a,{onClick:this.onGroupClick,use:"link",children:Object(te.jsx)(Pt.a,{children:Object(te.jsx)(u.a,{message:Jc("group.groupButtonLabel")})})})]})]})}render(){return Object(te.jsxs)("div",{className:"group-content-options",children:[this.renderGroupControls(),this.renderChildren()]})}}Yc.propTypes={createField:l.a.func.isRequired,customWidgetId:c.a.customWidgetId.isRequired,field:l.a.instanceOf(gt.a).isRequired,fieldCreateOptions:l.a.object.isRequired,fieldName:l.a.string,depth:l.a.number,isFieldGroupingActive:l.a.bool.isRequired,toggleFieldGrouping:l.a.func.isRequired,readOnly:l.a.bool};Yc.defaultProps={depth:0,fieldsErrors:{}};var Qc=Object(P.compose)(Object(o.connect)(Xc,$c))(Yc),Zc=s(1486);const ep=e=>"DesignEditorsUI.customWidgetEditor.sidebar.fieldEdit."+e,tp=e=>"DesignEditorsUI.customWidgetEditor.errors.field."+e;class sp extends i.PureComponent{constructor(e){super(e);this.onBreadcrumbsLinkClick=e=>{const{customWidgetId:t,setSelectedField:s}=this.props;s(t,{id:e})};this.editField=e=>{const{customWidgetId:t}=this.props,{field:s}=this.state,i=s.merge(e);this.setState({field:i});this.debouncedEditField(t,i)};this.debouncedEditField=Object(p.debounce)((function(e,t){this.props.editField(e,t)}),1e3);this.onCloneClick=()=>{this.props.cloneField(this.props.customWidgetId,this.props.field.id)};this.onDeleteClick=()=>{this.props.deleteField(this.props.customWidgetId,this.props.field.id)};this.onNameChange=e=>{const t=e.target.value;this.editField({name:t})};this.onPreviewClick=()=>{this.props.setFullScreenEditorOpen(this.props.customWidgetId,!this.props.isFullScreenEditorOpen)};this.onOpenChange=e=>t=>{this.props.saveAccordionState(e,t.target.value)};this.state={field:e.field}}componentDidUpdate(e){Object(p.isEqual)(e.field,this.props.field)||this.setState({field:this.props.field})}get contentOptionsErrors(){const{fieldErrors:e}=this.props;return Object(p.pick)(e,[Ut.r,Ut.d,Ut.f,Ut.U,Ut.t,Ut.P,Ut.R])}get contentOptionsWarnings(){const{fieldWarnings:e}=this.props;return Object(p.pick)(e,[Ut.r,Ut.d,Ut.f,Ut.U,Ut.t,Ut.P,Ut.R])}get fieldName(){return this.props.fieldBreadcrumbs.map(e=>e.name).join(".")||this.state.field.name}getIsOpen(e){return Object(Wa.a)(this.props.accordionStates,[this.state.field.id,e])}renderFieldGroupErrors(){if(this.props.isFieldGroupingActive)return null;const{children:e=[]}=this.props.fieldErrors,t=e.map(({type:e,data:t})=>Object(te.jsx)(Pt.a,{use:"error",children:Object(te.jsx)(u.a,{message:tp(e),options:t})},e));return Object(te.jsx)("div",{className:"p-x-6 p-y-3",children:t})}renderFieldGroupWarnings(){if(this.props.isFieldGroupingActive)return null;const{children:e=[]}=this.props.fieldWarnings,t=e.map(({type:e,data:t})=>Object(te.jsx)(Pt.a,{use:"error",children:Object(te.jsx)(u.a,{message:tp(e),options:t})},e));return Object(te.jsx)("div",{className:"p-x-6 p-y-3",children:t})}renderCopyDropdown(){const{field:e}=this.state,t=Object(te.jsx)(Pt.a,{children:Object(te.jsx)(u.a,{message:ep("copyDropdown")})});return Object(te.jsx)(qt.a,{buttonUse:"transparent",buttonClassName:"p-all-0",buttonText:t,menuWidth:150,placement:"bottom left",popoverProps:{className:"copy-dropdown"},children:Object(te.jsxs)(Dt.a,{children:[Object(te.jsx)(Tn,{customWidgetId:this.props.customWidgetId,field:e,fieldName:this.fieldName,hostTemplateTypes:this.props.customWidgetHostTemplateTypes,contentTypes:this.props.customWidgetContentTypes}),Object(te.jsx)(Tn,{customWidgetId:this.props.customWidgetId,field:e,fieldName:this.fieldName,hostTemplateTypes:this.props.customWidgetHostTemplateTypes,contentTypes:this.props.customWidgetContentTypes,useFullSnippet:!1})]})})}renderNameInput(){const{fieldErrors:e,isFieldGroupingActive:t,readOnly:s}=this.props,{field:i}=this.state;return t?null:Object(te.jsx)(_t.a,{children:Object(te.jsx)(os,{className:"field-name-input",errors:e.name,help:this.renderCopyDropdown(),label:Object(h.a)(ep("nameLabel")),children:Object(te.jsx)(Ht,{className:"is--code",inputComponent:Mt.a,onChange:this.onNameChange,value:i.name,disabled:s})})})}renderContentOptions(){const{isEmailOrAnyType:e,customWidgetId:t,customWidgetPath:s,customWidgetContentTypes:i,customWidgetHostTemplateTypes:n,isFieldGroupingActive:a,readOnly:o,isV1:r,isGlobal:d,hasGlobalContentEditorAccess:l}=this.props,{field:c}=this.state;if(c.type===Gi.GROUP)return Object(te.jsx)(wt.a,{children:Object(te.jsx)(Qc,{customWidgetId:t,fieldName:this.fieldName,field:c,isFieldGroupingActive:a,readOnly:o})});const p=Object(te.jsxs)(D.a,{align:"end",children:[Object(te.jsx)(bn,{className:"m-right-2",fieldErrors:this.contentOptionsErrors,i18nKey:ep("contentOptions.hasFieldError")}),Object(te.jsx)(mn,{className:"m-right-2",fieldWarnings:this.contentOptionsWarnings,i18nKey:ep("contentOptions.hasFieldWarning")}),Object(te.jsx)(u.a,{message:ep("contentOptions.accordionLabel")})]});return Object(te.jsxs)(kt.a,{defaultOpen:!0,titleText:p,onOpenChange:this.onOpenChange(bs.a),open:this.getIsOpen(bs.a),children:[d&&l&&Object(te.jsx)(Zc.a,{className:"m-bottom-8 p-top-5",contentPath:s}),Object(te.jsx)(qc,{customWidgetContentTypes:i,customWidgetHostTemplateTypes:n,editor:ro.a.DESIGN_MANAGER,isEmailOrAnyType:e,customWidgetId:t,isV1:r,editField:this.editField,field:c,fieldErrors:this.contentOptionsErrors,fieldWarnings:this.contentOptionsWarnings,compact:!0,readOnly:o,onPreviewClick:this.onPreviewClick})]})}renderAccordions(){const{customWidgetId:e,fieldErrors:t,fieldWarnings:s,isFieldGroupingActive:n,isGlobal:a,readOnly:o,isV1:r,isStyleTab:d}=this.props,{field:l}=this.state,c=this.renderContentOptions();if(n)return c;const p=Object(i.cloneElement)(c,{key:l.id+"-content-options"}),u=Object(te.jsx)(kt.a,{titleText:Object(h.a)(ep("editorOptions.accordionLabel")),onOpenChange:this.onOpenChange(bs.c),open:this.getIsOpen(bs.c),children:Object(te.jsx)(mo,{editField:this.editField,field:l,fieldErrors:t,isGlobal:a,readOnly:o,isV1:r})},l.id+"-editor-options"),g=d?null:Object(te.jsx)(Kc,{editField:this.editField,field:l,fieldErrors:t,fieldWarnings:s,onOpenChange:this.onOpenChange(bs.i),open:this.getIsOpen(bs.i),readOnly:o},l.id+"-repeater-options");return r?[p,u]:[p,u,Object(te.jsx)(Gc,{customWidgetId:e,editField:this.editField,field:l,fieldErrors:t,fieldWarnings:s,onOpenChange:this.onOpenChange(bs.b),open:this.getIsOpen(bs.b),readOnly:o},l.id+"-display-conditions"),g]}renderGroupControls(){const{customWidgetId:e,isFieldGroupingActive:t}=this.props;return t?Object(te.jsx)(wt.a,{flush:!0,children:Object(te.jsx)(_n,{customWidgetId:e})}):null}renderBreadcrumbs(){const{fieldBreadcrumbs:e,customWidgetIcon:t,isFieldGroupingActive:s,isFullScreenEditorOpen:i}=this.props,n=Object(te.jsx)(ba.a,{alignment:"text-bottom",size:14,icon:t});return Object(te.jsx)(Nt.a,{className:"field-edit-breadcrumbs",isReadOnly:s||i,items:e,onLinkClick:this.onBreadcrumbsLinkClick,rootIcon:n})}renderCannotEditFieldTypeAlert(){if(this.props.canEditFieldType)return null;const e=this.props.canCreateFieldType?"missingEditPermission":"missingEditAndCreatePermission";return Object(te.jsx)(N.a,{type:"warning",children:Object(te.jsx)(u.a,{message:ep(e)})})}renderFieldEditControls(){const{customWidgetId:e,isFieldGroupingActive:t,readOnly:s,canCreateFieldType:i}=this.props,{field:n}=this.state;let a=n.type===Gi.GROUP?"cloneGroup":"cloneField";s||i||(a="missingCreatePermission");const o=n.type===Gi.GROUP?"deleteGroup":"deleteField",r=t||s;return Object(te.jsxs)(Gt.a,{className:"field-edit-controls",children:[this.renderCannotEditFieldTypeAlert(),Object(te.jsx)(Qt,{customWidgetId:e,editField:this.editField,field:n,isReadOnly:r}),Object(te.jsxs)(Vt.a,{children:[Object(te.jsx)(zt.a,{title:Object(h.a)(ep(a)),iconName:"duplicate",onClick:this.onCloneClick,isReadOnly:r||!i}),Object(te.jsx)(zt.a,{title:Object(h.a)(ep(o)),iconName:"delete",onClick:this.onDeleteClick,isReadOnly:r})]}),this.renderGroupControls(),this.renderNameInput(),Object(te.jsx)(wt.a,{flush:!0,children:this.renderAccordions()}),this.renderFieldGroupErrors(),this.renderFieldGroupWarnings()]})}render(){const{customWidgetId:e,isFieldGroupingActive:t}=this.props,{field:s}=this.state;if(!s)return null;const i="field-edit-inputs"+(t?" is--field-grouping-active":"");return Object(te.jsx)(At.a,{breadcrumbsContent:this.renderBreadcrumbs(),className:"field-edit-sidebar-container",contentClassName:i,children:this.renderFieldEditControls()},`${e}-${s.id}`)}}sp.propTypes={canEditFieldType:l.a.bool.isRequired,canCreateFieldType:l.a.bool.isRequired,customWidgetContentTypes:l.a.array,customWidgetHostTemplateTypes:l.a.array,customWidgetIcon:l.a.string,customWidgetId:c.a.customWidgetId.isRequired,customWidgetPath:l.a.string.isRequired,cloneField:l.a.func.isRequired,deleteField:l.a.func.isRequired,editField:l.a.func.isRequired,field:l.a.instanceOf(gt.a),fieldBreadcrumbs:l.a.array,fieldErrors:l.a.object,fieldWarnings:l.a.object,isEmailOrAnyType:l.a.bool.isRequired,isFieldGroupingActive:l.a.bool.isRequired,isFullScreenEditorOpen:l.a.bool.isRequired,isGlobal:l.a.bool,isStyleTab:l.a.bool,setSelectedField:l.a.func.isRequired,saveAccordionState:l.a.func.isRequired,accordionStates:l.a.object.isRequired,readOnly:l.a.bool,isV1:l.a.bool.isRequired,setFullScreenEditorOpen:l.a.func.isRequired,hasGlobalContentEditorAccess:l.a.bool.isRequired};sp.defaultProps={customWidgetContentTypes:null,customWidgetHostTemplateTypes:null,customWidgetIcon:null,field:null,fieldErrors:{},fieldWarnings:{},fieldBreadcrumbs:[]};var ip=sp;function np(){const e=L.makeGetCustomWidgetBuffer(),t=L.makeGetCustomWidgetBufferFields(),s=q.o(),i=L.makeGetIsEmailOrAnyType(),n=L.makeGetIsReadOnly();return(a,o)=>{const r=e(a,o),{isActive:d}=q.d(a,o),l=s(a,o),c=q.k(a,o),p=q.f(a,o),u=!(!c.field||!l[c.field.type][ki.b]);return Object.assign({customWidgetId:o.customWidgetId,isReadOnly:Object(M.w)(a)||n(a,o)||p||!u,fieldErrors:q.c(a,o),fieldWarnings:q.e(a,o),fieldBreadcrumbs:q.l(a,o),fields:t(a,o),isFieldGroupingActive:!!d,isFullScreenEditorOpen:q.g(a,o),customWidgetContentTypes:r?r.contentTypes:null,customWidgetHostTemplateTypes:r?r.hostTemplateTypes:null,customWidgetIcon:r?r.icon:null,isGlobal:!!r&&r.global,isV1:!!r&&1===r.schemaVersion,accordionStates:q.a(a,o),canEditFieldType:u,canCreateFieldType:!(!c.field||!l[c.field.type][ki.a]),isEmailOrAnyType:i(a,o),customWidgetPath:r?r.path:"",hasGlobalContentEditorAccess:Object(M.h)(a,o)},c)}}const ap={cloneField:W.e,deleteField:W.i,editField:W.k,setSelectedField:F.j,saveAccordionState:F.d,fetchSfdcIntegrationStatus:Ct,setFullScreenEditorOpen:F.f};class op extends i.Component{constructor(...e){super(...e);this.saveAccordionState=(e,t=!1)=>{this.props.saveAccordionState(this.props.customWidgetId,e,t,this.props.field.id)};this.isStyleTab=this.props.fieldBreadcrumbs[0]&&this.props.fieldBreadcrumbs[0].tab===cs.d}componentDidMount(){this.props.fetchSfdcIntegrationStatus()}render(){const{customWidgetContentTypes:e,customWidgetHostTemplateTypes:t,customWidgetIcon:s,customWidgetId:i,customWidgetPath:n,editField:a,field:o,fieldErrors:r,fieldWarnings:d,fieldBreadcrumbs:l,setSelectedField:c,isFieldGroupingActive:p,isFullScreenEditorOpen:u,accordionStates:h,canEditFieldType:g,canCreateFieldType:b,isGlobal:m,cloneField:j,deleteField:O,isReadOnly:f,isV1:C,setFullScreenEditorOpen:y,isEmailOrAnyType:x,hasGlobalContentEditorAccess:T}=this.props;return Object(te.jsx)(ip,{canEditFieldType:g,canCreateFieldType:b,customWidgetContentTypes:e,customWidgetHostTemplateTypes:t,customWidgetIcon:s,customWidgetId:i,customWidgetPath:n,cloneField:j,deleteField:O,editField:a,field:o,isStyleTab:this.isStyleTab,fieldBreadcrumbs:l,fieldErrors:r,fieldWarnings:d,isEmailOrAnyType:x,isFieldGroupingActive:p,isFullScreenEditorOpen:u,isGlobal:m,setSelectedField:c,saveAccordionState:this.saveAccordionState,accordionStates:h,readOnly:f,isV1:C,setFullScreenEditorOpen:y,hasGlobalContentEditorAccess:T})}}op.propTypes={customWidgetContentTypes:l.a.array,customWidgetHostTemplateTypes:l.a.array,customWidgetIcon:l.a.string,customWidgetId:c.a.customWidgetId.isRequired,customWidgetPath:l.a.string.isRequired,cloneField:l.a.func.isRequired,deleteField:l.a.func.isRequired,editField:l.a.func.isRequired,field:l.a.instanceOf(gt.a),fieldBreadcrumbs:l.a.array.isRequired,fieldErrors:l.a.object.isRequired,fieldWarnings:l.a.object.isRequired,isEmailOrAnyType:l.a.bool.isRequired,isFieldGroupingActive:l.a.bool.isRequired,isFullScreenEditorOpen:l.a.bool.isRequired,isGlobal:l.a.bool,setSelectedField:l.a.func.isRequired,saveAccordionState:l.a.func.isRequired,accordionStates:l.a.object.isRequired,canEditFieldType:l.a.bool.isRequired,canCreateFieldType:l.a.bool.isRequired,isReadOnly:l.a.bool.isRequired,fetchSfdcIntegrationStatus:l.a.func.isRequired,isV1:l.a.bool.isRequired,setFullScreenEditorOpen:l.a.func.isRequired,hasGlobalContentEditorAccess:l.a.bool.isRequired};op.defaultProps={customWidgetContentTypes:null,customWidgetHostTemplateTypes:null,customWidgetIcon:null,field:null,accordionStates:{}};var rp=Object(o.connect)(np,ap)(op),dp=s(1315);const lp=e=>"DesignEditorsUI.customWidgetEditor.sidebar.icon."+e,cp=({customWidgetIcon:e,FileManager:t,onFileManagerOpen:s,onResetToDefault:n,onIconSelect:a})=>{const[o,r]=Object(i.useState)(!1),d=()=>r(!o);return Object(te.jsxs)("div",{children:[Object(te.jsx)(xi.a,{children:Object(te.jsx)(u.a,{message:lp("iconSelect.label")})}),Object(te.jsxs)(D.a,{align:"center",direction:"column",children:[Object(te.jsx)("div",{children:Object(te.jsx)(k.a,{className:"icon-upload-button",onClick:s,use:"unstyled",children:Object(te.jsx)(ba.a,{size:"xxl",icon:e})})}),Object(te.jsxs)("div",{children:[Object(te.jsx)(dp.a,{icons:[],iconSet:Er.b["fontawesome-5.14.0"],isOpen:o,onClose:d,onIconSelect:e=>{d();a(e)},selectedIcons:[],totalIcons:100}),Object(te.jsx)(k.a,{className:"m-bottom-4",onClick:d,size:"small",children:Object(te.jsx)(u.a,{message:lp("iconSelect.browseIcons")})})]}),Object(te.jsx)("div",{children:Object(te.jsx)(k.a,{className:"m-bottom-4",onClick:s,size:"small",children:Object(te.jsx)(u.a,{message:lp("iconSelect.uploadIcon")})})}),Object(te.jsx)("div",{children:Object(te.jsx)(k.a,{onClick:n,use:"link",children:Object(te.jsx)(u.a,{message:lp("iconSelect.resetToDefault")})})})]}),t]})};cp.propTypes={customWidgetIcon:l.a.string,onResetToDefault:l.a.func.isRequired,FileManager:l.a.node,onFileManagerOpen:l.a.func.isRequired,onIconSelect:l.a.func};var pp=Object(Ks.a)(cp),up=s(1137);const hp=e=>"DesignEditorsUI.customWidgetEditor.sidebar.icon."+e,gp=1e4,bp=Object(Hi.a)({IS_SVG:null,IS_SIZE_LESS_THAN_MAX:null});class mp extends i.Component{constructor(...e){super(...e);this.state={errors:{}};this.onBackToFieldsClick=()=>{this.props.setIsSelectingIcon(!1)};this.onFileSelect=e=>{const t={},{extension:s="",size:i,url:n}=e;"svg"!==s.toLowerCase()&&(t[bp.IS_SVG]=!0);i&&i>gp&&(t[bp.IS_SIZE_LESS_THAN_MAX]=!0);this.setState({errors:t});Object.keys(t).length||this.props.updateIcon(n)};this.onIconSelect=e=>{const{name:t,type:s,iconSet:i}=e;let n=encodeURIComponent(t);i&&i!==Er.a&&(n=`${i}:${n}`);s&&s!==up.a.REGULAR&&(n=`${n}:${s}`);this.props.updateIcon(n)};this.onResetToDefault=()=>{this.setState({errors:{}});this.props.updateIcon(null)};this.renderIconRequirement=e=>{const t=this.state.errors[e],s="icon-requirements-list-item"+(t?" is--error":""),i=t?"error":null;return Object(te.jsx)(Pt.a,{className:s,use:i,children:Object(te.jsx)(u.a,{message:hp("iconRequirements.requirements."+e)})},e)}}renderBreadcrumbs(){return Object(te.jsx)(Nt.a,{singleBreadcrumbIsBackLink:!0,children:Object(te.jsx)(w.a,{onClick:this.onBackToFieldsClick,children:Object(te.jsx)(u.a,{message:hp("backToFields")})})})}renderIconRequirements(){const e=Object.keys(this.state.errors).length?Object(te.jsx)(Pt.a,{use:"error",children:Object(te.jsx)(u.a,{message:hp("iconRequirements.error")})}):null,t=Object.keys(bp).map(this.renderIconRequirement);return Object(te.jsxs)("div",{children:[e,Object(te.jsx)(Dt.a,{className:"icon-requirements-list",children:t})]})}render(){const e=Object(te.jsx)(u.a,{message:hp("iconRequirements.label")});return Object(te.jsx)(At.a,{className:"icon-sidebar-container",breadcrumbsContent:this.renderBreadcrumbs(),children:Object(te.jsxs)(Gt.a,{children:[Object(te.jsx)(pp,{customWidgetIcon:this.props.customWidgetIcon,onResetToDefault:this.onResetToDefault,onFileSelect:this.onFileSelect,onIconSelect:this.onIconSelect}),Object(te.jsx)(Pt.a,{children:Object(te.jsx)(u.a,{message:hp("colorWarning")})}),Object(te.jsx)(_t.a,{children:Object(te.jsx)(Zt.a,{label:e,children:this.renderIconRequirements()})})]})})}}mp.propTypes={customWidgetIcon:l.a.string,setIsSelectingIcon:l.a.func.isRequired,updateIcon:l.a.func.isRequired};function jp(){return(e,t)=>{const s=L.makeGetCustomWidgetBuffer()(e,t);return{customWidgetId:t.customWidgetId,isBufferLoaded:!!s,customWidgetIcon:s&&s.icon||void 0}}}const Op={setIsSelectingIcon:F.h,updateCustomWidget:W.E};class fp extends i.Component{constructor(...e){super(...e);this.setIsSelectingIcon=e=>{const{setIsSelectingIcon:t,customWidgetId:s}=this.props;t(s,e)};this.updateIcon=e=>{const{customWidgetId:t,updateCustomWidget:s}=this.props;s(t,{icon:e})}}shouldComponentUpdate(e){const{isBufferLoaded:t,customWidgetId:s,customWidgetIcon:i}=this.props;return!(t===e.isBufferLoaded&&s===e.customWidgetId&&i===e.customWidgetIcon)}render(){return this.props.isBufferLoaded?Object(te.jsx)(mp,{customWidgetIcon:this.props.customWidgetIcon,setIsSelectingIcon:this.setIsSelectingIcon,updateIcon:this.updateIcon}):null}}fp.propTypes={isBufferLoaded:l.a.bool.isRequired,customWidgetId:c.a.customWidgetId.isRequired,customWidgetIcon:l.a.string,setIsSelectingIcon:l.a.func.isRequired,updateCustomWidget:l.a.func.isRequired};var Cp=Object(o.connect)(jp,Op)(fp);const yp="main",xp="field-edit",Tp="icon";class Ep extends i.Component{get activeViewId(){const{isSelectingIcon:e,selectedField:t}=this.props;return e?Tp:t.field?xp:yp}renderContent(){const{customWidgetId:e,revisionId:t}=this.props;switch(this.activeViewId){case Tp:return Object(te.jsx)(Cp,{customWidgetId:e,revisionId:t});case xp:return Object(te.jsx)(rp,{customWidgetId:e,revisionId:t});default:return Object(te.jsx)(oo,{customWidgetId:e,revisionId:t})}}render(){const e=ge()("custom-widget-editor-sidebar",this.activeViewId===yp&&"main-sidebar",this.activeViewId===xp&&"field-edit-sidebar",this.activeViewId===Tp&&"icon-sidebar");return Object(te.jsx)("div",{className:e,children:this.renderContent()})}}Ep.propTypes={customWidgetId:c.a.customWidgetId.isRequired,isSelectingIcon:l.a.bool.isRequired,selectedField:l.a.object.isRequired,revisionId:l.a.number};function Rp(){return(e,t)=>({customWidgetId:t.customWidgetId,isSelectingIcon:q.h(e,t),selectedField:q.k(e,t)})}class Ip extends i.Component{render(){const{customWidgetId:e,isSelectingIcon:t,selectedField:s,revisionId:i}=this.props;return Object(te.jsx)(Ep,{customWidgetId:e,revisionId:i,isSelectingIcon:t,selectedField:s})}}Ip.propTypes={customWidgetId:c.a.customWidgetId.isRequired,isSelectingIcon:l.a.bool.isRequired,selectedField:l.a.object.isRequired,revisionId:l.a.number};var vp=Object(o.connect)(Rp,{})(Ip),Wp=s(599),Fp=s(600),Sp=s(773),Lp=s(1128),qp=s(1123),Dp=s(1125),Pp=s(1124),Ap=s(1126),Np=s(2718),kp=s(1103),wp=s(212),Gp=s(2601),Mp=s(1119);const _p=Object(Np.a)()(Lp.a);function Up(){const e=L.makeGetCustomWidgetBuffer(),t=L.makeGetCustomWidgetBufferFields(),s=Object(L.makeGetIsEmailOrAnyType)(),i=L.makeGetSmartContentProps(),n=L.makeGetSmartObjects(),a=L.makeGetIsReadOnly();return function(o,r){const d=t(o,r);let l=e(o,r);l=l?l.set("fields",d):{fields:d,id:r.customWidgetId};const c=i(o,r);return Object.assign({isEmailOrAnyType:s(o,r),isReadOnly:Object(M.w)(o)||a(o,r),customWidgetBuffer:l,smartRuleIds:(c.smartObjects||[]).map(e=>e.criterion_id),smartRulesById:n(o,r),selectedSmartRuleId:q.n(o,r)},c)}}const Bp={setIsEditingGlobalContent:F.g,editGlobalContent:W.l,addSmartRule:W.c,editSmartRule:W.m,editSmartRulesOrder:W.n,removeSmartRule:W.y,removeSmartRules:W.z,selectSmartRule:F.e,updateSmartRules:W.H,makeSmart:W.s},Hp=e=>"DesignEditorsUI.customWidgetEditor.globalContentCard."+e;class Vp extends i.PureComponent{constructor(e){super(e);this.getGlobalContent=(e,t)=>{let s=e.fields.reduce((e,t)=>Object.assign({},e,{[t.name]:t.default}),{});if(t){const e=this.props.smartRulesById[t]||{};s=Object.assign({},s,e)}return s};this.editGlobalContent=e=>{const t=this.getGlobalContent(this.props.customWidgetBuffer,this.props.selectedSmartRuleId),s={};Object.keys(e).forEach(i=>{const n=e[i];Object(p.isEqual)(t[i],n)||(s[i]=n)});this.props.editGlobalContent(this.props.customWidgetId,s)};this.handleCancel=()=>{this.props.setIsEditingGlobalContent(this.props.customWidgetId,!1)};this.keybindingConfig={[C.b.NONE]:{[C.a.ESCAPE]:new x.a({handler:this.handleCancel})}};this.handleFormUpdate=(e,t,s)=>{this.setState({globalContent:s});this.props.selectedSmartRuleId?this.debouncedEditSmartRule(this.props.customWidgetId,this.props.selectedSmartRuleId,s):this.debouncedEditGlobalContent(s)};this.getSmartObjectData=e=>Object(wp.a)(e,kp.e.WIDGET);this.handleSelectSmartRule=(e={})=>{const{customWidgetId:t,selectSmartRule:s,smartRulesById:i}=this.props,{id:n}=e;s(t,n);n&&!i[n]&&this.handleAddSmartRule(e)};this.handleAddSmartRule=e=>{const{customWidgetId:t,selectSmartRule:s,addSmartRule:i}=this.props;i(t,this.getSmartObjectData(e));s(t,e.id)};this.handleMakeSmart=({definition:e,criterionType:t,initialCriterion:s})=>{const i={definitionId:e.id,smartObjects:[this.getSmartObjectData(s)],smartType:t};this.props.makeSmart(this.props.customWidgetId,i)};this.handleSaveSmartDefinition=(e,t={})=>{const{customWidgetId:s,updateSmartRules:i}=this.props;i(s,e.map(this.getSmartObjectData),t)};const t=Wp.b.bind(null,this.guardReadOnly);this.handleFormUpdate=t(this.handleFormUpdate,this);this.handleRemoveSelectedSmartRule=t(this.handleRemoveSelectedSmartRule,this);this.handleAddSmartRule=t(this.handleAddSmartRule,this);this.handleEditSmartRulesOrder=t(this.handleEditSmartRulesOrder,this);this.handleRemoveAllSmartRules=t(this.handleRemoveAllSmartRules,this);this.editGlobalContent=t(this.editGlobalContent,this);this.debouncedEditGlobalContent=Object(p.debounce)(this.editGlobalContent,Fp.a);this.handleMakeSmart=t(this.handleMakeSmart,this);this.debouncedEditSmartRule=Object(p.debounce)(e.editSmartRule,Fp.a);this.state={globalContent:this.getGlobalContent(this.props.customWidgetBuffer,this.props.selectedSmartRuleId)}}componentDidUpdate(e){const{customWidgetId:t,revisionId:s,selectedSmartRuleId:i}=this.props;e.customWidgetId===t&&e.revisionId===s&&e.selectedSmartRuleId===i||this.setState({globalContent:this.getGlobalContent(this.props.customWidgetBuffer,this.props.selectedSmartRuleId)})}get formKey(){const{customWidgetId:e,revisionId:t,selectedSmartRuleId:s}=this.props;return[e,t,s].filter(Boolean).join("-")}guardReadOnly(){return this.props.isReadOnly}renderForm(){const{isReadOnly:e,customWidgetId:t,customWidgetBuffer:s}=this.props;return Object(te.jsx)(Mp.a,{flush:!1,id:""+t,module:this.state.globalContent,moduleSpec:s,onUpdate:this.handleFormUpdate,readOnly:e,hideLockedFields:!1},this.formKey)}renderSmartDefinitionControls(){const{isEligibleForSmartContent:e,isEmailOrAnyType:t,isReadOnly:s,customWidgetId:i,definitionId:n,selectedSmartRuleId:a,smartType:o,smartRuleIds:r,revisionId:d}=this.props;return e?Object(te.jsx)("div",{className:"p-x-6 p-bottom-3",children:Object(te.jsx)(Gp.a,{anonymousTargeting:!t,definitionId:n,onAddRule:this.handleAddSmartRule,onSaveSmartDefinition:this.handleSaveSmartDefinition,onSelectRule:this.handleSelectSmartRule,readOnly:s||!!d,selectedRuleId:a,smartType:o,targetId:i,validRules:r},this.formKey+"-smart-controls")}):null}render(){const e=this.props.isEligibleForSmartContent?"globalAndSmart":"global",t=Object(te.jsx)(u.a,{message:Hp("title."+e),options:{label:this.props.customWidgetBuffer.name}});return Object(te.jsx)(_p,{className:"custom-widget-global-content-card",keybindingConfig:this.keybindingConfig,children:Object(te.jsxs)(Ap.a,{children:[Object(te.jsx)(Pp.a,{className:"p-bottom-0",children:Object(te.jsx)(Sp.a,{className:"m-top-0",flush:!0,children:Object(te.jsx)(k.a,{onClick:this.handleCancel,use:"link",children:Object(te.jsx)(u.a,{message:Hp("backButtonText")})})})}),Object(te.jsx)(Dp.a,{title:t}),Object(te.jsxs)(qp.a,{flush:!0,children:[this.renderSmartDefinitionControls(),this.renderForm()]})]})})}}Vp.propTypes={customWidgetId:c.a.customWidgetId.isRequired,revisionId:l.a.number,customWidgetBuffer:l.a.instanceOf(f.a).isRequired,isEmailOrAnyType:l.a.bool,isReadOnly:l.a.bool.isRequired,setIsEditingGlobalContent:l.a.func.isRequired,editGlobalContent:l.a.func.isRequired,selectedSmartRuleId:l.a.number,definitionId:l.a.number,smartRuleIds:l.a.arrayOf(l.a.number),smartRulesById:l.a.object.isRequired,smartType:l.a.oneOf(Object.keys(kp.b)),addSmartRule:l.a.func.isRequired,editSmartRule:l.a.func.isRequired,selectSmartRule:l.a.func.isRequired,makeSmart:l.a.func.isRequired,isEligibleForSmartContent:l.a.bool.isRequired,updateSmartRules:l.a.func.isRequired};var zp=Object(o.connect)(Up,Bp)(Vp),Kp=s(436);const Jp=e=>"DesignEditorsUI.customWidgetEditor.sidebar.fieldEdit."+e;function Xp(){const e=L.makeGetIsEmailOrAnyType(),t=L.makeGetIsReadOnly();return(s,i)=>{const n=L.makeGetCustomWidgetBuffer()(s,i),a=q.c(s,i),o=q.e(s,i),r=t(s,i),d=q.f(s,i);return Object.assign({customWidgetId:i.customWidgetId,isReadOnly:Object(M.w)(s)||r||d,fieldErrors:Object(p.pick)(a,[Ut.r,Ut.d,Ut.f]),fieldWarnings:Object(p.pick)(o,[Ut.r,Ut.d,Ut.f]),isEmailOrAnyType:e(s,i),isV1:!!n&&1===n.schemaVersion},q.k(s,i))}}const $p={editField:W.k,setFullScreenEditorOpen:F.f};class Yp extends i.PureComponent{constructor(...e){super(...e);this.state={field:this.props.field};this.editField=e=>{const{customWidgetId:t}=this.props,{field:s}=this.state,i=s.merge(e);this.setState({field:i});this.debouncedEditField(t,i)};this.debouncedEditField=Object(p.debounce)((function(e,t){this.props.editField(e,t)}),1e3);this.closeEditor=()=>{setTimeout(()=>this.props.setFullScreenEditorOpen(this.props.customWidgetId,!1),0)};this.onSourceChange=e=>{const{value:t}=e;null!=t&&this.editField({[Ut.f]:t})}}renderBreadcrumbs(){return Object(te.jsx)(Sp.a,{className:"m-top-0",flush:!0,children:Object(te.jsx)(w.a,{"data-test-id":"full-screen-field-editor-back-button",onClick:this.closeEditor,children:Object(te.jsx)(u.a,{message:Jp("backToEditor")})})})}renderFullScreenCodeEditor(){const{field:e}=this.props,t=e[Ut.f],s=e.occurrence&&Array.isArray(t)?t&&t[0]:t;return Object(te.jsxs)("div",{className:"custom-widget-field-editor-full-screen-editor",children:[Object(te.jsx)(Xe.a,{leftContent:this.renderBreadcrumbs()}),Object(te.jsx)(Oe.a,{sessionId:e.id,mode:e.type===Gi.HTML?"htmlmixed":"hubl-html",height:"auto",autofocus:!0,value:s||"",onChange:this.onSourceChange,enableHublValidation:!1},e.id)]})}render(){const{customWidgetId:e,field:t,fieldErrors:s,fieldWarnings:i,isReadOnly:n,isV1:a,isEmailOrAnyType:o}=this.props;if(!t){this.closeEditor();return null}return t.type===Gi.HTML||t.type===Gi.HUBL?this.renderFullScreenCodeEditor():Object(te.jsx)(Lp.a,{style:{height:"100%",position:"absolute"},children:Object(te.jsxs)(Ap.a,{children:[Object(te.jsx)(Pp.a,{children:this.renderBreadcrumbs()}),Object(te.jsx)(qp.a,{children:Object(te.jsx)(qc,{customWidgetId:e,editField:this.editField,field:t,fieldErrors:s,fieldWarnings:i,readOnly:n,isV1:a,isEmailOrAnyType:o})})]})})}}Yp.propTypes={customWidgetId:c.a.customWidgetId.isRequired,editField:l.a.func.isRequired,field:l.a.instanceOf(gt.a),fieldErrors:l.a.object.isRequired,fieldWarnings:l.a.object.isRequired,setFullScreenEditorOpen:l.a.func.isRequired,isEmailOrAnyType:l.a.bool.isRequired,isReadOnly:l.a.bool.isRequired,isV1:l.a.bool.isRequired};Yp.defaultProps={customWidgetIcon:null,field:null,isNew:!1};var Qp=Object(o.connect)(Xp,$p)(Yp),Zp=s(521),eu=s(407),tu=s(287),su=s.n(tu),iu=s(766);class nu{constructor(e){this.resetTimer=()=>{if(this.timer){clearTimeout(this.timer);this.timer=setTimeout(this.broadcastValues,nu.timeout)}};this.broadcastValues=()=>{this.callback&&this.callback(this.buffer);this.buffer=[];this.timer&&clearTimeout(this.timer);this.timer=null};this.next=e=>{this.buffer.push(e);this.timer?this.resetTimer():this.timer=setTimeout(this.broadcastValues,nu.timeout)};this.buffer=[];this.timer=null;this.callback=e}}nu.timeout=1e3;const au=(e,t)=>e.flash[t.key];var ou=s(241);const ru=su()(iu.a).withConfig({displayName:"withDescriptionInputs__InlineInput",componentId:"sc-166yrji-0"})(["max-width:calc(100% - (170px + ("," * 6)));> span{font-size:"," !important;}"],e=>e.fontSize,e=>e.fontSize),du=20,lu=/^ {4}"description": /gm,cu=/ {4}"description": "(.*)"/m,pu=e=>({line:e.lineOracle.line,value:cu.exec(e.string)[1],ch:e.string.length-2}),uu=e=>({codemirrorOptions:Object(je.c)(e),refresh:au(e,{key:ou.e})}),hu={};var gu=e=>{class t extends i.PureComponent{constructor(e){super(e);this.linesHash={};this.onBlur=(e,t)=>{const{target:{value:s}}=t;if(s===e.value)return;const i=this.linesHash[e.line];i&&this.cm.operation(()=>{i.clear();this.cm.doc.replaceRange(s,{line:e.line,ch:du},{line:e.line,ch:e.ch});const t={line:e.line,ch:this.cm.doc.getLine(e.line).length-2,value:s};this.addWidget(t)})};this.onKeyPress=e=>{e.key!==C.a.ENTER&&"Enter"!==e.key||e.target.blur()};this.onBufferBroadcast=e=>{e.length&&this.cm.operation(()=>{e.forEach(e=>{this.addWidget(e)})})};this.addWidget=e=>{const t=this.createNode(e);this.linesHash[e.line]=this.cm.markText({line:e.line,ch:du},{line:e.line,ch:e.ch},{replacedWith:t,clearWhenEmpty:!1,inclusiveLeft:!0,inclusiveRight:!0})};this.createNode=e=>{const t=document.createElement("span");sn.a.render(Object(te.jsx)(ru,{defaultValue:e.value,use:"on-dark",affordance:!0,fontSize:this.props.codemirrorOptions.fontSize,onBlur:this.props.partial(this.onBlur,e),onKeyPress:this.onKeyPress}),t);return t};this.createOverlay=()=>({token:e=>{if(lu.exec(e.string)){const t=e.lineOracle.line;if(!this.linesHash[t]){const s=pu(e);this.linesHash[t]=t;this.lineBuffer.next(s)}}e.skipToEnd();return null}});this.codemirrorDidMountOrUpdate=e=>{if(this.cm!==e){this.cm=e;if(this.cm&&!this.cm_overlay){this.cm_overlay=this.createOverlay();this.cm.addOverlay(this.cm_overlay)}}};this.setRef=e=>{if(!this.props.readOnly||this.props.revisionId)return;const t=e&&e.codemirror;this.codemirrorDidMountOrUpdate(t)};this.lineBuffer=new nu(this.onBufferBroadcast)}componentDidUpdate(e){if(e.refresh&&this.cm){this.linesHash={};this.cm_overlay?this.cm.removeOverlay(this.cm_overlay):this.cm_overlay=this.createOverlay();this.cm.addOverlay(this.cm_overlay)}}render(){return Object(te.jsx)(e,Object.assign({},this.props,{refCodemirror:this.setRef}))}}t.propTypes={value:l.a.string.isRequired,codemirrorOptions:l.a.object.isRequired,partial:l.a.func.isRequired,readOnly:l.a.bool,refresh:l.a.bool,revisionId:l.a.number};t.defaultProps={value:""};return Object(o.connect)(uu,hu)(t)},bu=s(738);const mu=e=>"DesignEditorsUI.customWidgetEditor.sidebar.main.translations."+e,ju=gu(Oe.a);function Ou(){const e=L.makeGetMessages(),t=L.makeGetMasterLanguage(),s=L.makeGetIsReadOnly();return(i,n)=>({customWidgetLabel:L.getCustomWidgetLabel(i,n),masterLanguage:t(i,n),messages:e(i,n),isReadOnly:Object(M.w)(i)||s(i,n)})}const fu={setLanguageEditor:F.i,updateLanguage:W.F,addLanguage:W.b,regenerateTranslations:W.x,registerStatusBar:Zp.a};class Cu extends i.Component{constructor(...e){super(...e);this.closeEditor=()=>{this.props.setLanguageEditor(this.props.customWidgetId,null)};this.onChange=Object(p.debounce)(({value:e})=>{let t;try{t=JSON.parse(e)}catch(e){return}this.props.updateLanguage(this.props.customWidgetId,this.props.selectedLanguageEditor,t)},1e3);this.regenerateTranslations=()=>{this.props.regenerateTranslations(this.props.customWidgetId,this.props.customWidgetLabel,this.props.selectedLanguageEditor)}}componentDidMount(){const{selectedLanguageEditor:e}=this.props;this.props.registerStatusBar({activeLanguage:e})}componentDidUpdate(e){this.props.messages[this.props.selectedLanguageEditor]&&this.props.masterLanguage||this.props.setLanguageEditor(this.props.customWidgetId,null);e.selectedLanguageEditor!==this.props.selectedLanguageEditor&&this.props.registerStatusBar({activeLanguage:this.props.selectedLanguageEditor})}componentWillUnmount(){this.props.registerStatusBar({activeLanguage:null})}get value(){const{selectedLanguageEditor:e,messages:t,masterLanguage:s,addLanguage:i,customWidgetId:n,customWidgetLabel:a}=this.props;let o=t[e];if(!o){e===s&&i(n,a,s,!0);return""}if(!o.name){const t={};e===s&&(t.description="");t.message=a;o=o.set("name",t)}return Object(eu.b)(o)}renderBreadcrumbs(){return Object(te.jsx)(Sp.a,{className:"m-top-0",flush:!0,children:Object(te.jsx)(w.a,{onClick:this.closeEditor,children:Object(te.jsx)(u.a,{message:mu("editor.backButton")})})})}renderLabel(){return Object(te.jsx)(xi.a,{children:Object(te.jsx)(A.a,{message:mu("editor.header"),options:{language:Object(te.jsx)(u.a,{message:Object(bu.a)(this.props.selectedLanguageEditor)})}})})}renderRegenerateButton(){return Object(te.jsx)(k.a,{use:"tertiary-light",size:"extra-small",onClick:this.regenerateTranslations,disabled:this.props.isReadOnly,children:Object(te.jsx)(u.a,{message:mu("editor.regenerateButton"),options:{language:ue.a.text(Object(bu.a)(this.props.selectedLanguageEditor))}})})}render(){const{customWidgetId:e,selectedLanguageEditor:t,masterLanguage:s,revisionId:i,partial:n,isReadOnly:a}=this.props,o=`${e}${t}`;return Object(te.jsxs)("div",{className:"custom-widget-field-editor-full-screen-editor",children:[Object(te.jsx)(Xe.a,{leftContent:this.renderBreadcrumbs(),middleContent:this.renderLabel(),rightContent:this.renderRegenerateButton(),renderSettings:!1}),Object(te.jsx)(ju,{sessionId:o,mode:"javascript",height:"100%",width:"100%",autofocus:!0,value:this.value,enableHublValidation:!1,readOnly:t===s||!!i||a,revisionId:i,onChange:this.onChange,partial:n,codemirrorType:"json"},o)]})}}Cu.propTypes={setLanguageEditor:l.a.func.isRequired,customWidgetId:c.a.customWidgetId.isRequired,revisionId:l.a.number,selectedLanguageEditor:l.a.string.isRequired,masterLanguage:l.a.string,messages:l.a.object.isRequired,updateLanguage:l.a.func.isRequired,addLanguage:l.a.func.isRequired,partial:l.a.func.isRequired,regenerateTranslations:l.a.func.isRequired,registerStatusBar:l.a.func,isReadOnly:l.a.bool,customWidgetLabel:l.a.string.isRequired};var yu=Object(P.compose)(Object(o.connect)(Ou,fu),Object(Rd.a)())(Cu);class xu extends i.PureComponent{constructor(...e){super(...e);this.keybindingConfig={[C.b.COMMAND]:{[C.a.S]:new x.a({handler:this.props.onSave}),[C.a.Z]:new x.a({handler:this.props.onUndoCustomWidgetEdit}),[C.a.Y]:new x.a({handler:this.props.onRedoCustomWidgetEdit})},[C.b.COMMAND_SHIFT]:{[C.a.Z]:new x.a({handler:this.props.onRedoCustomWidgetEdit}),[C.a.P]:new x.a({handler:this.props.onPublishCustomWidget})}};this.onCodePanesRender=Object(p.debounce)(()=>{this.props.editorLoaded(this.props.customWidgetId)},250);this.onSidebarResize=e=>{const t=Object(p.mapObject)(e,e=>({size:e}));this.props.updatePaneOptions(t)}}renderToolbar(){const{customWidgetId:e,revisionId:t}=this.props;return Object(te.jsx)(ht,{customWidgetId:e,revisionId:t})}renderEditor(){const{customWidgetId:e,paneOptions:t,revisionId:s,isEditingGlobalContent:i,isFullScreenEditorOpen:n,selectedLanguageEditor:a}=this.props,{size:o}=t[E.a]||new y.a({}),r=i||n?"":"code-panes-pane";let d=Object(te.jsx)(ze,{customWidgetId:e,revisionId:s,onCodePanesRender:this.onCodePanesRender});i?d=Object(te.jsx)(zp,{customWidgetId:e,revisionId:s}):n?d=Object(te.jsx)(Qp,{customWidgetId:e,revisionId:s}):a&&(d=Object(te.jsx)(yu,{customWidgetId:e,revisionId:s,selectedLanguageEditor:a}));const{size:l}=t[E.e]||new y.a({}),c=new y.a({value:T.f});return Object(te.jsxs)(I.a,{direction:"vertical",onPaneResize:this.onSidebarResize,children:[Object(te.jsx)(v.a,{className:r,defaultSize:o,paneId:E.a,scrollable:!1,children:d}),Object(te.jsx)(v.a,{unitsOnResize:R.PIXELS,defaultSize:l,minSize:c,paneId:E.e,scrollable:!1,children:Object(te.jsx)(vp,{customWidgetId:e,revisionId:s})})]})}render(){return Object(te.jsxs)(Kp.a,{className:"custom-widget-editor",keybindingConfig:this.keybindingConfig,children:[this.renderToolbar(),this.renderEditor()]})}}xu.propTypes={customWidgetId:c.a.customWidgetId.isRequired,isEditingGlobalContent:l.a.bool.isRequired,revisionId:l.a.number,onRedoCustomWidgetEdit:l.a.func.isRequired,onSave:l.a.func.isRequired,onUndoCustomWidgetEdit:l.a.func.isRequired,paneOptions:l.a.object.isRequired,updatePaneOptions:l.a.func.isRequired,isFullScreenEditorOpen:l.a.bool.isRequired,selectedLanguageEditor:l.a.string,onPublishCustomWidget:l.a.func.isRequired,editorLoaded:l.a.func.isRequired};var Tu=xu,Eu=s(65);s(26);const Ru=e=>e.previewOptions.byAsset,Iu=Object(Eu.a)([Ru,xr.a],(e,t)=>e[t]||e.default),vu=Object(Eu.a)([Iu],e=>e.isPreviewOpen);Object(Eu.a)([Iu],e=>e.previewConfiguration);var Wu=s(2717);const Fu=Object(p.once)(e=>{e()});class Su extends i.Component{constructor(...e){super(...e);this.guardReadOnly=()=>this.props.isReadOnly;this.bindAndGuardReadOnly=Wp.b.bind(null,this.guardReadOnly);this.onSave=this.bindAndGuardReadOnly(()=>{const{customWidgetId:e,saveCustomWidgetBuffer:t,requestStatus:s}=this.props;s.isPublishing||t(e)});this.onRedoCustomWidgetEdit=this.bindAndGuardReadOnly(()=>{const{customWidgetId:e,redoCustomWidgetEdit:t}=this.props;t(e)});this.onUndoCustomWidgetEdit=this.bindAndGuardReadOnly(()=>{const{customWidgetId:e,undoCustomWidgetEdit:t}=this.props;t(e)});this.publishCustomWidget=this.bindAndGuardReadOnly(()=>{const{customWidgetId:e,publishCustomWidgetBuffer:t}=this.props;t(e)});this.updatePaneOptions=e=>{const{customWidgetId:t,updatePaneOptions:s}=this.props;s(t,e)}}componentDidMount(){const{isReadOnly:e,customWidgetBuffer:t}=this.props;if(this.props.customWidgetId){this.validateOnInitialLoad();this.props.revisionId?this.props.fetchCustomWidgetRevision(this.props.customWidgetId,this.props.revisionId):this.props.fetchCustomWidgetBuffer(this.props.customWidgetId);Fu(this.props.fetchCustomWidgetEditorOptions);this.props.hydrateCustomWidgetEditorOptions(this.props.customWidgetId);t&&e&&this.trackDefaultModuleOpen()}}componentDidUpdate(e){if(!this.props.customWidgetId)return;this.props.revisionId&&e.revisionId!==this.props.revisionId?this.props.fetchCustomWidgetRevision(this.props.customWidgetId,this.props.revisionId):(e.customWidgetId!==this.props.customWidgetId||e.revisionId&&!this.props.revisionId)&&this.props.fetchCustomWidgetBuffer(this.props.customWidgetId);this.validateOnInitialLoad();const{customWidgetId:t,isReadOnly:s,customWidgetBuffer:i}=this.props;e.customWidgetId!==t&&this.props.hydrateCustomWidgetEditorOptions(t);!e.customWidgetBuffer&&i&&s&&this.trackDefaultModuleOpen()}shouldComponentUpdate(e,t){return!!e.customWidgetId&&a()(this,e,t)}trackDefaultModuleOpen(){const{customWidgetBuffer:e}=this.props;e.default&&Object(Wu.o)(e.path)}validateOnInitialLoad(){if(this.props.isReadOnly||this.props.revisionId)return;const{customWidgetId:e}=this.props;if(!e)return;const{buffersInitiallyValidated:t}=Su;if(!t[e]){this.props.validateCustomWidgetBuffer(e);t[e]=!0}}render(){const{customWidgetBuffer:e,customWidgetId:t,isPreviewOpen:s,paneOptions:i,revisionId:n,isEditingGlobalContent:a,isFullScreenEditorOpen:o,selectedLanguageEditor:d,folderPath:l,fileName:c,requestStatus:p,editorLoaded:O}=this.props;if(p.fetchError)return Object(te.jsx)(r.a,{name:"MODULE_EDITOR_ERROR",children:Object(te.jsx)(m.a,{grow:1,children:Object(te.jsx)(g.a,{title:Object(h.a)("designManager.errorPages.loadingErrors.moduleEditor.title"),type:"badRequest",children:Object(te.jsx)(u.a,{message:"designManager.errorPages.loadingErrors.moduleEditor.message"})})})});if(!e)return Object(te.jsx)(b.a,{grow:!0,minHeight:300});Object(j.a)();return Object(te.jsx)(r.a,{name:"MODULE_EDITOR",children:Object(te.jsx)(Tu,{customWidgetId:t,revisionId:n,isPreviewOpen:s,isEditingGlobalContent:a,isFullScreenEditorOpen:o,onPublish:this.onPublish,onRedoCustomWidgetEdit:this.onRedoCustomWidgetEdit,onSave:this.onSave,onUndoCustomWidgetEdit:this.onUndoCustomWidgetEdit,onPublishCustomWidget:this.publishCustomWidget,paneOptions:i,updatePaneOptions:this.updatePaneOptions,selectedLanguageEditor:d,fileName:c,folderPath:l,editorLoaded:O})})}}Su.propTypes={customWidgetBuffer:l.a.instanceOf(f.a),customWidgetId:c.a.customWidgetId,revisionId:l.a.number,fetchCustomWidgetBuffer:l.a.func.isRequired,fetchCustomWidgetRevision:l.a.func.isRequired,fetchCustomWidgetEditorOptions:l.a.func.isRequired,hydrateCustomWidgetEditorOptions:l.a.func.isRequired,isPreviewOpen:l.a.bool.isRequired,isReadOnly:l.a.bool.isRequired,isEditingGlobalContent:l.a.bool.isRequired,paneOptions:l.a.object.isRequired,redoCustomWidgetEdit:l.a.func.isRequired,requestStatus:l.a.object.isRequired,saveCustomWidgetBuffer:l.a.func.isRequired,undoCustomWidgetEdit:l.a.func.isRequired,updatePaneOptions:l.a.func.isRequired,validateCustomWidgetBuffer:l.a.func.isRequired,isFullScreenEditorOpen:l.a.bool.isRequired,selectedLanguageEditor:l.a.string,publishCustomWidgetBuffer:l.a.func.isRequired,fileName:O.FilePropTypes.fileName,folderPath:O.FilePropTypes.folderPath,editorLoaded:l.a.func.isRequired};Su.defaultProps={customWidgetBuffer:null};Su.buffersInitiallyValidated={};function Lu(){const e=L.makeGetRequestStatus(),t=L.makeGetCustomWidgetBuffer(),s=L.makeGetIsReadOnly();return(i,n)=>{let a=n.assetId||xr.h(i);isNaN(Number(a))&&!a.startsWith("/")&&(a="/"+a);const o=Object.assign({},n,{assetId:a,customWidgetId:a}),r=Object(H.o)(i,{fileId:a});return{customWidgetId:a,customWidgetBuffer:t(i,o),isPreviewOpen:vu(i),isReadOnly:Object(M.w)(i)||s(i,o),paneOptions:q.j(i,o),requestStatus:e(i,o),isEditingGlobalContent:q.f(i,o),isFullScreenEditorOpen:q.g(i,o),selectedLanguageEditor:q.m(i,o),folderPath:r?r.folderPath:"",fileName:r?r.name:""}}}const qu={fetchCustomWidgetRevision:W.q,fetchCustomWidgetEditorOptions:F.a,hydrateCustomWidgetEditorOptions:F.b,redoCustomWidgetEdit:W.w,saveCustomWidgetBuffer:W.B,updatePaneOptions:F.m,undoCustomWidgetEdit:W.D,validateCustomWidgetBuffer:W.K,publishCustomWidgetBuffer:W.v,editorLoaded:Tr.g};t.a=Object(P.compose)(Object(o.connect)(Lu,qu))(Su)},2652:function(e,t,s){"use strict";s.r(t);var i=s(40),n=s(273),a=s(41),o=s.n(a),r=s(59),d=s(1148),l=s.n(d),c=s(2594),p=s(279),u=s(99),h=s(604),g=s(2734),b=s(2735),m=s(239),j=s(249),O=s(416),f=s(437),C=s(691),y=s(436),x=s(2756),T=s(443),E=s(2733),R=s(1013),I=s(45);const v=e=>"DesignEditorsUI.shared.toolbars."+e;class W extends i.PureComponent{renderLeftContent(){const{undoGlobalWidgetEdit:e,redoGlobalWidgetEdit:t,pastEditHistoryCount:s,futureEditHistoryCount:i,isPublishDisabled:n}=this.props;return Object(I.jsx)(R.a,{undo:e,redo:t,pastEditCount:s,futureEditCount:i,disabled:n})}renderRightContent(){const{isPublishDisabled:e,publishGlobalWidget:t}=this.props;return Object(I.jsx)(T.a,{size:"extra-small",use:"primary",disabled:e,onClick:t,"data-test-id":"publish-changes-button",children:Object(I.jsx)(p.a,{message:v("buttons.publish")})})}render(){return Object(I.jsx)(E.a,{leftContent:this.renderLeftContent(),rightContent:this.renderRightContent()})}}W.propTypes={isPublishDisabled:o.a.bool.isRequired,publishGlobalWidget:o.a.func.isRequired,pastEditHistoryCount:n.a.uint32.isRequired,futureEditHistoryCount:n.a.uint32.isRequired,undoGlobalWidgetEdit:o.a.func.isRequired,redoGlobalWidgetEdit:o.a.func.isRequired};var F=W;function S(){const e=j.g(),t=j.f();return function(s,i){return{isPublishDisabled:!j.d(s,i),pastEditHistoryCount:e(s,i),futureEditHistoryCount:t(s,i)}}}const L={publishGlobalWidget:O.f,undoGlobalWidgetEdit:O.j,redoGlobalWidgetEdit:O.g};class q extends i.Component{constructor(...e){super(...e);this.undoGlobalWidgetEdit=()=>{this.props.pastEditHistoryCount&&this.props.undoGlobalWidgetEdit(this.props.globalWidgetId)};this.redoGlobalWidgetEdit=()=>{this.props.futureEditHistoryCount&&this.props.redoGlobalWidgetEdit(this.props.globalWidgetId)};this.publishGlobalWidget=()=>{this.props.publishGlobalWidget(this.props.globalWidgetId)}}render(){return Object(I.jsx)(F,{pastEditHistoryCount:this.props.pastEditHistoryCount,futureEditHistoryCount:this.props.futureEditHistoryCount,undoGlobalWidgetEdit:this.undoGlobalWidgetEdit,redoGlobalWidgetEdit:this.redoGlobalWidgetEdit,publishGlobalWidget:this.publishGlobalWidget,isPublishDisabled:this.props.isPublishDisabled})}}q.propTypes={globalWidgetId:o.a.number.isRequired,isPublishDisabled:o.a.bool.isRequired,publishGlobalWidget:o.a.func.isRequired,pastEditHistoryCount:n.a.uint32.isRequired,futureEditHistoryCount:n.a.uint32.isRequired,undoGlobalWidgetEdit:o.a.func.isRequired,redoGlobalWidgetEdit:o.a.func.isRequired};var D=Object(r.connect)(S,L)(q),P=s(1128);class A extends i.PureComponent{constructor(...e){super(...e);this.keybindingConfig={[f.b.COMMAND]:{[f.a.Z]:new C.a({handler:this.props.undoGlobalWidgetEdit}),[f.a.Y]:new C.a({handler:this.props.redoGlobalWidgetEdit})},[f.b.COMMAND_SHIFT]:{[f.a.Z]:new C.a({handler:this.props.redoGlobalWidgetEdit})}}}render(){const{globalWidgetId:e,revisionId:t,isReadOnly:s}=this.props;return Object(I.jsxs)(y.a,{className:"global-widget-editor",children:[Object(I.jsx)(D,{globalWidgetId:this.props.globalWidgetId}),Object(I.jsx)(P.a,{children:Object(I.jsx)(x.a,{globalWidgetId:e,isReadOnly:s,revisionId:t,showPublishButton:!1})})]})}}A.propTypes={globalWidgetId:o.a.number.isRequired,revisionId:o.a.number,isReadOnly:o.a.bool.isRequired,undoGlobalWidgetEdit:o.a.func.isRequired,redoGlobalWidgetEdit:o.a.func.isRequired};var N=A,k=s(1127),w=s(1487),G=s(58),M=s(2731);function _(){const e=j.g(),t=j.f();return function(s,i){return{fetchError:j.c(s,i),globalWidgetId:i.assetId||m.c(s),isReadOnly:!!i.revisionId,pastEditHistoryCount:e(s,i),futureEditHistoryCount:t(s,i)}}}const U={undoGlobalWidgetEdit:O.j,redoGlobalWidgetEdit:O.g,fetchCustomWidgets:M.b,fetchMapping:M.c};class B extends i.Component{constructor(...e){super(...e);this.undoGlobalWidgetEdit=()=>{this.props.pastEditHistoryCount&&this.props.undoGlobalWidgetEdit(this.props.globalWidgetId)};this.redoGlobalWidgetEdit=()=>{this.props.futureEditHistoryCount&&this.props.redoGlobalWidgetEdit(this.props.globalWidgetId)}}componentDidMount(){const{globalWidgetId:e,isLoaded:t}=this.props;this.props.fetchCustomWidgets();this.props.fetchMapping();e&&!t&&this.props.fetchGlobalWidget(e)}componentDidUpdate(e){const{globalWidgetId:t}=e,{globalWidgetId:s,isLoaded:i}=this.props;t!==s&&s&&!i&&this.props.fetchGlobalWidget(s)}shouldComponentUpdate(e,t){return!!e.globalWidgetId&&l()(this,e,t)}render(){const{fetchError:e,globalWidgetId:t,isLoaded:s,isReadOnly:i,revisionId:n}=this.props;return s?Object(I.jsx)(c.a,{name:"GLOBAL_MODULE_EDITOR",children:Object(I.jsx)(N,{globalWidgetId:t,revisionId:n,isReadOnly:i,undoGlobalWidgetEdit:this.undoGlobalWidgetEdit,redoGlobalWidgetEdit:this.redoGlobalWidgetEdit})}):e?Object(I.jsx)(c.a,{name:"GLOBAL_MODULE_EDITOR_ERROR",children:Object(I.jsx)(b.a,{grow:1,children:Object(I.jsx)(h.a,{title:Object(u.a)("designManager.errorPages.loadingErrors.globalWidgetEditor.title"),type:"badRequest",children:Object(I.jsx)(p.a,{message:"designManager.errorPages.loadingErrors.globalWidgetEditor.message"})})})}):Object(I.jsx)(g.a,{grow:!0})}}B.propTypes={revisionId:o.a.number,globalWidgetId:o.a.number,isLoaded:o.a.bool.isRequired,isReadOnly:o.a.bool.isRequired,fetchError:o.a.instanceOf(Error),fetchGlobalWidget:o.a.func.isRequired,fetchCustomWidgets:o.a.func.isRequired,fetchMapping:o.a.func.isRequired,pastEditHistoryCount:n.a.uint32.isRequired,futureEditHistoryCount:n.a.uint32.isRequired,undoGlobalWidgetEdit:o.a.func.isRequired,redoGlobalWidgetEdit:o.a.func.isRequired};t.default=Object(G.compose)(Object(w.a)("global-widget-editor--is_active"),Object(r.connect)(_,U),Object(k.a)())(B)}}]);
//# sourceMappingURL=//static.hsappstatic.net/DesignManagerIde/static-2.61259/custom-widget-editor.js.map